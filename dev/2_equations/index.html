<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>The equations of stellar structure and evolution · Stellar Structure and Evolution</title><meta name="title" content="The equations of stellar structure and evolution · Stellar Structure and Evolution"/><meta property="og:title" content="The equations of stellar structure and evolution · Stellar Structure and Evolution"/><meta property="twitter:title" content="The equations of stellar structure and evolution · Stellar Structure and Evolution"/><meta name="description" content="Documentation for Stellar Structure and Evolution."/><meta property="og:description" content="Documentation for Stellar Structure and Evolution."/><meta property="twitter:description" content="Documentation for Stellar Structure and Evolution."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Stellar Structure and Evolution logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Stellar Structure and Evolution</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><span class="tocitem">Introduction (23/09/24)</span><ul><li><a class="tocitem" href="../1_introduction/">Notes</a></li><li><a class="tocitem" href="../1_introduction_problems/">Exercises</a></li><li><a class="tocitem" href="../1_introduction_julia/">Julia setup</a></li><li><a class="tocitem" href="../1_introduction_computational/">Constructing an HR diagram</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>The equations of stellar structure and evolution</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>The equations of stellar structure and evolution</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/orlox/stars_2024_2025" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/orlox/stars_2024_2025/blob/main/docs/src/2_equations.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="The-equations-of-stellar-structure-and-evolution"><a class="docs-heading-anchor" href="#The-equations-of-stellar-structure-and-evolution">The equations of stellar structure and evolution</a><a id="The-equations-of-stellar-structure-and-evolution-1"></a><a class="docs-heading-anchor-permalink" href="#The-equations-of-stellar-structure-and-evolution" title="Permalink"></a></h1><p>Goals:</p><ul><li>Derive the equation of motion</li><li>Derive a form of the energy equation</li><li>Derive the continuity equation</li><li>Virial theorem</li><li>Lane-Embden equation</li></ul><h2 id="Equation-of-motion"><a class="docs-heading-anchor" href="#Equation-of-motion">Equation of motion</a><a id="Equation-of-motion-1"></a><a class="docs-heading-anchor-permalink" href="#Equation-of-motion" title="Permalink"></a></h2><p>We first consider the 3D problem before reducing it to radial symmetry. Start with a box with sides of size <span>$\mathrm{d}l$</span> and density <span>$\rho$</span>.</p><p><img src="../assets/2_equations/eom.svg" alt="asd"/></p><p>The mass of the box is simply</p><p class="math-container">\[\mathrm{d}m = \rho \mathrm{d} V = \rho(\mathrm{d}l)^3\]</p><p>If we consider the box is moving with the fluid, rather than being static in space, we can write its equation of motion as <span>$\mathrm{d}m\cdot\vec{a}=\vec{f}$</span>, where <span>$\vec{a}$</span> is the acceleration and <span>$\vec{f}$</span> are the forces acting on the box:</p><p class="math-container">\[\mathrm{d}m\cdot \vec{a}=\vec{f}=\vec{f}_g + \vec{f}_P\]</p><p>where we have separated the forces into the contribution from gravity and that from the fluid pressure. The gravitational force can be expressed as the gradient of the gravitational potential, which in turn must satisfy Poisson&#39;s equation,</p><p class="math-container">\[\vec{f}_g=-\mathrm{d}m\nabla\Phi,\quad \nabla^2\Phi = 4\pi G \rho.\]</p><p>To compute <span>$\vec{f}_P$</span>, we focus first on its component in one cartesian direction. If our box is aligned with the <span>$x$</span> axis, then the force of pressure will be given by the difference in pressure between two sides, multiplied by the area of the face. This is illustrated in the figure below, where <span>$P_{-x}$</span> and <span>$P_{+x}$</span> is the value of the pressure at each side.</p><p><img src="../assets/2_equations/pressure.svg" alt="asdf"/></p><p>The <span>$x$</span> component of the pressure force is then</p><p class="math-container">\[\vec{f}_P\cdot \hat{x}=(\mathrm{d}l)^2\left(P_{-x}-P_{+x}\right)\]</p><p class="math-container">\[= (\mathrm{d}l)^3 \left(\frac{\partial P}{\partial x}\right)_t,\]</p><p>where the partial derivative is taken at constant time. Repeating this in all directions we find</p><p class="math-container">\[\vec{f}_P = -\mathrm{d} V\left(\left(\frac{\partial P}{\partial x}\right)_t, \left(\frac{\partial P}{\partial y}\right)_t, \left(\frac{\partial P}{\partial z}\right)_t\right)=-\mathrm{d}V \nabla P,\]</p><p>which gives us the equation of motion</p><p class="math-container">\[\vec{a}=-\nabla\Phi -\frac{\nabla P}{\rho}.\]</p><p>If we consider spherical symmetry, we find that</p><p class="math-container">\[\boxed{a_r = -\frac{G m(r)}{r^2}-\frac{1}{\rho}\frac{\partial P}{\partial r},}\]</p><p>where <span>$m(r)$</span> is the mass contained inside the radius <span>$r$</span> and we have used that in spherical symmetry <span>$\nabla \Phi = Gm(r)/r^2$</span>.</p><h2 id="Energy-equation"><a class="docs-heading-anchor" href="#Energy-equation">Energy equation</a><a id="Energy-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-equation" title="Permalink"></a></h2><p>We consider the second law of thermodynamics,</p><p class="math-container">\[T\frac{\mathrm{d} s}{\mathrm{d} t}=\frac{\mathrm{d} q}{\mathrm{d} t},\]</p><p>where <span>$s$</span> is the specific entropy (meaning, per unit mass) and <span>$dq/dt$</span> is the head added per unit mass and per unit time. Here we are also distinguishing between a co-moving time derivative (<span>$\mathrm{d}/\mathrm{d}t$</span>) and a time derivative fixed in space (<span>$\partial /\partial t$</span>). In three dimensions these two operators are related via</p><p class="math-container">\[\frac{\mathrm{d}}{\mathrm{d} t} = \frac{\partial}{\partial t} + v\cdot\nabla.\]</p><p>If we have an energy flux <span>$\vec{F}$</span> going through the fluid, our mass element <span>$\mathrm{d}m$</span> can have energy deposited onto it if <span>$\vec{F}$</span> is not constant in space. To determine this, we apply a similar reasoning to what we did in the previous section, considering first the energy that flows through two sides of the box in the <span>$x$</span> direction. The energy being deposited in each side of the box corresponds to the flux times the area, as illustrated below where <span>$F_{x,-x}$</span> and <span>$F_{x,+x}$</span> represent the flux at each of the faces.</p><p><img src="../assets/2_equations/flux.svg" alt="asdf"/></p><p>The heat deposited by radiation (per unit time and mass) in the <span>$x$</span> direction is then</p><p class="math-container">\[\frac{\mathrm{d} q}{\mathrm{d} t}=\frac{(\mathrm{d}l)^2}{\mathrm{d}m}\left(F_{x,-x}-F_{x,+x}\right)\]</p><p class="math-container">\[=-\frac{(\mathrm{d}l)^3}{\mathrm{d}m}\left(\frac{\partial F_x}{\partial x}\right)_t=-\frac{1}{\rho}\left(\frac{\partial F_x}{\partial x}\right)_t\]</p><p>Combining contributions from all directions we have</p><p class="math-container">\[\frac{\mathrm{d} q}{\mathrm{d} t}=-\frac{1}{\rho}\left[\left(\frac{\partial F_x}{\partial x}\right)_t+\left(\frac{\partial F_y}{\partial y}\right)_t + \left(\frac{\partial F_z}{\partial z}\right)_t\right]=-\frac{\nabla\cdot \vec{F}}{\rho}\]</p><p class="math-container">\[\rightarrow T\frac{\mathrm{d} s}{\mathrm{d} t} = -\frac{\nabla\cdot \vec{F}}{\rho}.\]</p><p>And if we consider spherical symmetry the result is</p><p class="math-container">\[T\left(\frac{\partial s}{\partial t}\right)_m=-\frac{1}{\rho}\cdot\frac{1}{r^2}\left(\frac{\partial(r^2 F_r)}{\partial r}\right)_t,\]</p><p>where the comoving time derivative in 1D corresponds to taking the time derivative at a fixed mass coordinate. Generally one uses the luminosity <span>$L=4\pi r^2 F_r$</span> rather than the flux, which gives us</p><p class="math-container">\[T\left(\frac{\partial s}{\partial t}\right)_m=-\frac{1}{4\pi \rho r^2}\left(\frac{\partial L}{\partial r}\right)_t.\]</p><p>In practice, we don&#39;t only have heat deposited by variations in the flux, but also locally through nuclear reactions. If <span>$\varepsilon_\mathrm{nuc}$</span> is the energy deposited per unit mass and time, then we have</p><p class="math-container">\[\left(\frac{\partial q}{\partial t}\right)_m=-\frac{\nabla \cdot \vec{F}}{\rho}+\varepsilon_\mathrm{nuc}\]</p><p class="math-container">\[\rightarrow \boxed{T\left(\frac{\partial s}{\partial t}\right)_m=-\frac{1}{4\pi \rho r^2}\left(\frac{\partial L}{\partial r}\right)_t + \varepsilon_\mathrm{nuc}}\]</p><h2 id="Continuity-equation"><a class="docs-heading-anchor" href="#Continuity-equation">Continuity equation</a><a id="Continuity-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Continuity-equation" title="Permalink"></a></h2><p>The continuity equation describes how the density evolves as a function of time. To obtain this equation we can think again about our box with sides <span>$\mathrm{d}l$</span>, but this time we will consider the box to be static in space rather than comoving with the fluid. In this case we have that the volume <span>$\mathrm{d}V$</span> of the box remains constant, but not its mass <span>$\mathrm{d}m$</span>. In particular,</p><p class="math-container">\[\mathrm{dm}=(dl)^3\rho \rightarrow \frac{\partial \rho}{\partial t}=\frac{1}{\mathrm{dV}}\frac{\partial(\mathrm{d}m)}{\partial t}.\]</p><p>The image below shows how, during an amount of time <span>$\mathrm{d}t$</span>, material would flow from the two sides of the box in the x-direction.</p><p><img src="../assets/2_equations/continuity.svg" alt="asdf"/></p><p>Material coming from the <span>$-x$</span> direction would fill a region of volume <span>$(\mathrm{d}l)^2v_{x,-x}\mathrm{d}t$</span>, from which the total mass flowing is obtained by mutiplying by the density at the face. The corresponding change in mass at each face is then</p><p class="math-container">\[\mathrm{d}(\mathrm{d}m)_{-x}=(\mathrm{d}l)^2 v_{x,-x}\rho_{-x}\mathrm{d}t,\]</p><p class="math-container">\[\mathrm{d}(\mathrm{d}m)_{+x}=(\mathrm{d}l)^2 v_{x,+x}\rho_{+x}\mathrm{d}t.\]</p><p>We can then proceed in the same way as we did in the previous section to compute <span>$\partial (\mathrm{d} m)/\partial t$</span>, which will give us</p><p class="math-container">\[\boxed{\frac{\partial \rho}{\partial t}=-\nabla \cdot (\rho \vec{v})},\]</p><p>which is known as the continuity equation. If we consider spherical symmetry we find that</p><p class="math-container">\[\left(\frac{\partial \rho}{\partial t}\right)_r=-\frac{1}{r^2}\frac{\partial}{\partial r}\left(r^2 \rho v_r\right).\tag{1.1}\]</p><p>Note that the time derivative is taken at fixed radius rather than at fixed mass coordinate, as we were considering how properties change at a fixed location in space rather following a comoving mass element.</p><h2 id="Eularian-versus-Lagrangian-description"><a class="docs-heading-anchor" href="#Eularian-versus-Lagrangian-description">Eularian versus Lagrangian description</a><a id="Eularian-versus-Lagrangian-description-1"></a><a class="docs-heading-anchor-permalink" href="#Eularian-versus-Lagrangian-description" title="Permalink"></a></h2><p>In practice, we often use the mass coordinate <span>$m(r)$</span> as a variable instead of <span>$r$</span>,</p><p class="math-container">\[m(r,t)=\int_0^r 4\pi r&#39;^{2} \rho(r&#39;,t) \mathrm{d}r&#39;\tag{1.2}\]</p><p class="math-container">\[\rightarrow \left(\frac{\partial m}{\partial r}\right)_t = 4\pi r^2\rho\quad\mathrm{or}\quad\left(\frac{\partial r}{\partial m}\right)_t = \frac{1}{4\pi r^2\rho}\tag{1.3}.\]</p><p>The change of <span>$m(r,t)$</span> with respect to time is given by the mass flux over a shell at fixed radius <span>$r$</span>,</p><p class="math-container">\[\left(\frac{\partial m}{\partial t}\right)_r = -4\pi r^2 \rho v_r. \tag{1.4}\]</p><p>One can combine Equations <span>$(1.2)$</span>, <span>$(1.2)$</span> and <span>$(1.3)$</span> to obtain the equation of continuity under the assumption of radial symmetry (Equation <span>$(1.1)$</span>). Owing to this, Equation <span>$(1.3)$</span> is normally referred to as the continuity equation in stellar astrophysics. We will generally be working under the assumption of hydrostatic equilibrium, in which case there is no difference between time derivatives at constant radius or mass coordinate. Derivatives with respect to radius and mass coordinate also are always taken at fixed time. Because of this we will drop the specification of which quantity is taken to be fixed from the partial derivatives, as they can be identified from the context.</p><p>We then have two different forms for the equations of stellar structure and evolution, which depend on whether we use <span>$r$</span> or <span>$m$</span> as the independent spatial variable. If <span>$r$</span> is the independent variable then the equations are in &quot;Eularian&quot; form, while using <span>$m$</span> as independent variable is the &quot;Lagrangian&quot; form. The equation of continuity <span>$(1.3)$</span> can be used to switch between both formulations, and these are summarized in the table below (note that for the energy equation we are using a time derivative at fixed mass in both formulations).</p><table><tr><th style="text-align: right"></th><th style="text-align: right">Eularian</th><th style="text-align: right">Lagrangian</th></tr><tr><td style="text-align: right">Independent variable</td><td style="text-align: right"><span>$m=m(r)$</span></td><td style="text-align: right"><span>$r=r(m)$</span></td></tr><tr><td style="text-align: right">Continuity equation</td><td style="text-align: right"><span>$\displaystyle\frac{\partial m}{\partial r}=4\pi r^2\rho$</span></td><td style="text-align: right"><span>$\displaystyle{\frac{\partial r}{\partial m}}=\frac{1}{4\pi r^2 \rho}$</span></td></tr><tr><td style="text-align: right">Equation of motion</td><td style="text-align: right"><span>$\displaystyle a_r = -\frac{Gm}{r^2} - \frac{1}{\rho}\frac{\partial P}{\partial r}$</span></td><td style="text-align: right"><span>$\displaystyle a_r = -\frac{Gm}{r^2} - 4\pi r^2\frac{\partial P}{\partial m}$</span></td></tr><tr><td style="text-align: right">Energy equation</td><td style="text-align: right"><span>$\displaystyle T\frac{\partial s}{\partial t}=-\frac{1}{4\pi r^2 \rho}\frac{\partial L}{\partial r}+\varepsilon_\mathrm{nuc}$</span></td><td style="text-align: right"><span>$\displaystyle T\frac{\partial s}{\partial t}=-\frac{\partial L}{\partial m}+\varepsilon_\mathrm{nuc}$</span></td></tr></table><p>Now we can ask, can we actually solve these equations? On top of initial conditions, we need boundary conditions (BCs) for each equation containing a spatial derivative (as these will result in an integration constant). Two general BCs can be set at the center of the star,</p><p class="math-container">\[r(m=0)=0,\quad L(m=0)=0.\]</p><p>We need one additional boundary condition, which can be set at the surface. In regular applications, one uses a definition of a photosphere, where the density and pressure are finite and most photons freely travel to infinity. For analytical purposes it is better to approximate the surface as the place where pressure vanishes,</p><p class="math-container">\[P(m=M)=0,\]</p><p>where <span>$M$</span> is the total mass of the star. The two conditions at the core are very general, while we will refine the one at the surface later on in the course.</p><p>We can then count the number of unknowns against the number of differential equations. We have not considered composition yet, but for each element we consider, we will have one equation describing its time derivative. Using a Lagrangian formulation we have the following unknowns:</p><ul><li>The radius <span>$r(m,t)$</span></li><li>The density <span>$\rho(m,t)$</span></li><li>The pressure <span>$P(m,t)$</span></li><li>The specific entropy <span>$s(m,t)$</span></li><li>The temperature <span>$T(m,t)$</span></li><li>The luminosity <span>$L(m,t)$</span></li><li>And the rate of nuclear energy generation rate <span>$\varepsilon_\mathrm{nuc}(m,T)$</span></li></ul><p>This is a total of 7 unknown variables, with only 3 differential equations! This conundrum will be solved in the following way:</p><ul><li><span>$\rho$</span>, <span>$P$</span>, <span>$s$</span> and <span>$T$</span>: An equation of state (EOS) of the fluid will give us two of these properties by specifying any of the other two (as well as the composition). This reduces the number of unknown properties by 2.</li><li><span>$L$</span>: This will come from our study of energy transport, which will give us an equation for <span>$L$</span> in terms of all other local properties such as the temperature gradient.</li><li><span>$\varepsilon_\mathrm{nuc}$</span>: This is a microphysical property that depends on local conditions such as temperature, density, and composition. We will see how it is computed when we study nuclear reactions.</li></ul><h2 id="Virial-theorem"><a class="docs-heading-anchor" href="#Virial-theorem">Virial theorem</a><a id="Virial-theorem-1"></a><a class="docs-heading-anchor-permalink" href="#Virial-theorem" title="Permalink"></a></h2><p>Consider the Lagrangian form of the equation of motion, in the case where gravity and the pressure gradient are perfectly balanced such that there is no acceleration. Then one obtains the equation of hydrostatic equilibrium:</p><p class="math-container">\[\boxed{\frac{\partial P}{\partial m}=-\frac{Gm}{4\pi r^4}.}\]</p><p>A very useful expression, known as the virial theorem, can be derived by multiplying both sides by <span>$4\pi r^3$</span> and integrating over mass,</p><p class="math-container">\[\int_0^M 4\pi r^2 \frac{\partial P}{\partial m}\mathrm{d}m=\int_0^M -\frac{Gm}{r}\mathrm{d}m\]</p><p>The right hand term is the gravitational potential energy, <span>$E_g$</span>, which corresponds to assembling the star by succesively bringing mass elements <span>$\mathrm{d}m$</span> from infinity. The left hand side can be rewritten using integration by parts:</p><p class="math-container">\[\int_0^M 4\pi r^2 \frac{\partial P}{\partial m}\mathrm{d}m = \left.(4\pi r^2 P)\right|_{m=0}^{m=M}-\int 12\pi r^2 \frac{\partial r}{\partial m}P \mathrm{d}m.\]</p><p>The first term on the right hand side vanishes from the boundary conditions, and using the continuity equation we have</p><p class="math-container">\[\int 4\pi r^2 \frac{\partial P}{\partial m}\mathrm{d}m = -3\int_0^M\frac{P}{\rho}\mathrm{d}m,\]</p><p>which gives us the virial theorem</p><p class="math-container">\[\boxed{E_g = -3\int_0^M\frac{P}{\rho}\mathrm{d}m}\tag{1.5}\]</p><p>To see what this implies, let&#39;s consider the very simple case of a monoatomic gas:</p><p class="math-container">\[P=nk_\mathrm{B}T,\quad n=\frac{\rho}{m_g},\tag{1.6}\]</p><p>where <span>$k_\mathrm{B}$</span> is Boltzmann&#39;s constant and <span>$m_g$</span> is the mass of the individual gas particles. This is very simplified as it does not account for electrons in an ionized gas, but this will be generalized in later classes. For the monoatomic ideal gas the energy per particle is</p><p class="math-container">\[e=\frac{3}{2}k_\mathrm{B}T,\]</p><p>from which we can compute the specific (meaning, per unit mass) internal energy of the gas,</p><p class="math-container">\[u=\frac{e}{m_g}=\frac{3}{2}\frac{k_\mathrm{B}T}{m_g}.\tag{1.7}\]</p><p>Plugging <span>$(1.7)$</span> and <span>$(1.6)$</span> into <span>$(1.5)$</span> we find</p><p class="math-container">\[E_g = -2\int_0^M u \mathrm{d}m=-2E_i,\]</p><p>where <span>$E_i$</span> is the internal energy of the gas. The total energy of the gas can be determined by adding up the potential and gravitational energies, which combined with the previous equation results in</p><p class="math-container">\[E=E_g+E_i=-E_i.\]</p><p>From this we see that the total energy is negative (as expected for a bound star) and that as a star loses (for instance, due to radiation at their surface), its internal energy increases. This implies that a star will often increase its temperature as a consequence of mass loss! Often this is referred to as stars having a negative heat capacity.</p><h2 id="Lane-Emden-equation"><a class="docs-heading-anchor" href="#Lane-Emden-equation">Lane-Emden equation</a><a id="Lane-Emden-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Lane-Emden-equation" title="Permalink"></a></h2><p>Consider the continuity and hydrostatic equilibrium equations in their Eularian form,</p><p class="math-container">\[\frac{\partial m}{\partial r}=4\pi r^2 \rho,\quad \frac{\partial P}{\partial r}=-\frac{Gm\rho}{r^2}.\]</p><p>It could be possible to find solutions to these equations if there was a simple relationship of the form <span>$P=P(\rho)$</span> (meaning, temperature independent), such that we only have as unknowns <span>$\rho(r)$</span> and <span>$m(r)$</span>. As it turns out an important particular case is that of a so called polytropic equation of state,</p><p class="math-container">\[P=K\rho^\gamma,\]</p><p>where <span>$K$</span> and <span>$\gamma$</span> are constant. Depending on the relevant equation of state that describes a star at a given stage, we will see both cases where <span>$K$</span> is a function of fundamental constants that is independent of a specific star, as well as cases where <span>$K$</span> can vary during the evolution of a star. Rather than using the exponent <span>$\gamma$</span>, it is common to use the polytropic index <span>$n$</span>, with</p><p class="math-container">\[P=K\rho^{1+1/n}.\]</p><p>We can combine the equation of hydrostatic equilibrium with the equation of continuity to obtain a single second order differential equation as follows:</p><p class="math-container">\[\left.\frac{\partial P}{\partial r}=-\frac{Gm\rho}{r^2}\quad\right/ \frac{r^2}{\rho}\cdot\]</p><p class="math-container">\[\left.\frac{r^2}{\rho}\frac{\partial P}{\partial r}=-Gm\quad\right/ \frac{\partial}{\partial r}\cdot\]</p><p class="math-container">\[\frac{\partial}{\partial r}\left(\frac{r^2}{\rho}\frac{\partial P}{\partial r}\right)=-G\frac{\partial m}{\partial r}=-4\pi G \rho r^2.\tag{1.8}\]</p><p>If we have a polytropic relationship between density and pressure, then this is just a second order differential equation for <span>$\rho(r)$</span>, and we can obtain a solution for it if we have two boundary conditions. A useful dimensionless form of this equation can be obtained if we define a new variable <span>$z$</span> instead of <span>$r$</span> from</p><p class="math-container">\[r=r_n z,\qquad r_n \equiv \sqrt{\frac{(n+1)P_c}{4\pi G\rho_c^2}},\]</p><p>and we define a function <span>$w(z)$</span> such that</p><p class="math-container">\[\rho = \rho_c \left[w(z)\right]^n\rightarrow P=P_c\left[w(z)\right]^{n+1},\]</p><p>where <span>$\rho_c$</span> and <span>$P_c$</span> are the central density and pressure. Using <span>$z$</span> and <span>$w(z)$</span> to replace <span>$r$</span>, <span>$\rho$</span> and <span>$P$</span> in Equation (1.8), one obtains the Lane-Emden equation:</p><p class="math-container">\[\frac{1}{z^2}\frac{\mathrm{d}}{\mathrm{d} z}\left(z^2\frac{\mathrm{d}w}{\mathrm{d}z}\right)=-w^n.\]</p><p>We need two boundary conditions, one of them clearly being <span>$w(0)=1$</span> as we require the central density and pressure to be <span>$\rho_c$</span> and <span>$P_c$</span> respectively. The second boundary condition can be determined from a restriction on the central temperature gradient. Since near the core the mass is given by <span>$m\simeq 4\pi r^3 \rho_c/3$</span>, the equation of hydrostatic equilibrium implies that <span>$(\partial P/\partial r)|_{r=0}=0$</span> which in turn implies that <span>$w&#39;|_{\xi=0}=0$</span>. With these two boundary conditions the Lane-Emden equation has a unique solution for each <span>$n$</span>, and using our definition of the stellar surface as <span>$P(R)=0$</span>, the surface is determined by the first value <span>$\xi_1$</span> for which <span>$w(\xi_1)=0$</span>. As we consider different equations of state that can be approximated as polytropes, the Lane-Emden equation will be a useful source of insight to determine how different properties of the star (such as their mass and radius) relate to each other.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 23 September 2024 14:57">Monday 23 September 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
