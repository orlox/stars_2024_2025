var documenterSearchIndex = {"docs":
[{"location":"6_convection/#Convection","page":"Notes","title":"Convection","text":"","category":"section"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"Goals:","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"Schwarzschild criterion\nBrunt-Väisälä frequency\nMixing length theory","category":"page"},{"location":"6_convection/#Schwarzschild-criterion","page":"Notes","title":"Schwarzschild criterion","text":"","category":"section"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"So far we have considered two processes to transport energy, conduction and radiation. If we were to consider higher and higher luminosities, while fixing the temperature, density and radius, we would need increasingly steeper temperature gradients (see equation (48)). But, as we will see now, dynamical instabilities arise if the temperature gradient becomes too steep.","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"Let's consider a mass element that is radially displaced upwards a distance Delta r.","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"(Image: convective blob)","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"Here we differentiate between properties of the mass element with the subscript \"e\" and those of its surroundings with a subscript \"s\". Before the perturbation, we take the properties of the element and its surroundings to be equal,","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"rho_mathrme(r)=rho_mathrms(r)quad T_mathrme(r)=T_mathrms(r)quad P_mathrme(r)-P_mathrms(r)","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"We will also consider that the displacement happens slowly, such that sound waves quickly equalize the pressure of the mass element with its surroundings as it rises,","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"P_mathrme(r+Delta r) = P_mathrms(r+Delta r)","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"This requires that the velocity of the moving element is much slower than the local sound speed.","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"We can now consider the stability of the displaced element. Let's define the following quantities:","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"Drho(r)=rho_mathrme(r)-rho_mathrms(r) quad DT(r)=T_mathrme(r)-T_mathrms(r)","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"After being displaced a distance Delta r, the mass element will experience a radial buoyancy force","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"F_mathrmr=-g Drho(r+Delta r)mathrmdV(r)","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"where g=Gm(r)r^2 is the local gravity. Given this, if for an upwards displacement (positive Delta r) the density of the mass element becomes smaller than that of its surroundings, there will be a net outwards force and the system will be unstable. For a small Delta r we can write","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"F_mathrmr=-gleftleft(fracmathrmdrhomathrmdrright)_mathrme-left(fracmathrmdrhomathrmdrright)_mathrmsrightDelta r mathrmdV(r+Delta r)tag51","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"and requiring F_mathrmr0 for Delta r0 we obtain a stability criterion:","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"left(fracmathrmdrhomathrmdrright)_mathrme-left(fracmathrmdrhomathrmdrright)_mathrms0tag52","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"The same result is obtained if we take a perturbation with Delta r=0","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"In practice, we use a different version of the instability criterion that depends on the temperature gradient. Let's consider the relationship between changes in density, temperature and pressure (ignoring composition variation for simplicity):","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"fracmathrmdrhorho=alphafracmathrmdPP-deltafracmathrmdTT","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"where","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"alpha=left(fracpartial lnrhopartial ln Pright)_Tquad delta=-left(fracpartial ln rhopartial ln Tright)_P","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"Using this the left hand side of equation (52) can be rewritten as","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"left(fracmathrmdrhomathrmdrright)_mathrme-left(fracmathrmdrhomathrmdrright)_mathrms=cancelfracalpharhoPleft(fracmathrmdPmathrmdrright)_mathrme - fracdeltarhoTleft(fracmathrmdTmathrmdrright)_mathrme - cancelfracalpharhoPleft(fracmathrmdPmathrmdrright)_mathrms + fracdeltarhoTleft(fracmathrmdTmathrmdrright)_mathrmstag53","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"where the pressure derivatives cancel from our assumption of a slowly rising element.","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"Consider now the pressure scale height, defined as","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"H_Pequiv -Pleft(fracmathrmdPmathrmdrright)^-1","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"The pressure scale height serves as a measure of the length scale over which the stellar interior changes. In the case of hydrostatic equilibrium we have","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"H_P = fracPrho g","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"Multiplying (53) by H_P can be used to turn the radial derivatives into pressure derivatives,","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"H_Pleftleft(fracmathrmdrhomathrmdrright)_mathrme-left(fracmathrmdrhomathrmdrright)_mathrmsright=fracdelta rho PTleftleft(fracmathrmdTmathrmdPright)_mathrme-left(fracmathrmdTmathrmdPright)_mathrmsright","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"=deltarholeftleft(fracmathrmdln Tmathrmdln Pright)_mathrme - left(fracmathrmdln Tmathrmdln Pright)_mathrmsrighttag54","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"The temperature gradient with respect to pressure in the surroundings of the mass element is the definition of nabla,","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"nablaequivleft(fracmathrmdln Tmathrmdln Pright)_mathrms","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"In contrast to nabla_mathrmrad, this is the actual temperature gradient of the star, while nabla_mathrmrad represents the gradient required for all the luminosity to be transported by radiation (or also, conduction). If we consider the mass element is displaced adiabatically,","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"left(fracmathrmdln Tmathrmdln Pright)_mathrme=nabla_mathrmad","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"and equation (54) is","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"left(fracmathrmdrhomathrmdrright)_mathrme-left(fracmathrmdrhomathrmdrright)_mathrms = fracdeltarhoH_P(nabla_mathrmad-nabla)tag55","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"and the stability condition of equation (51) reduces to","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"boxednabla_mathrmadnabla","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"This is known as the Schwarzschild criterion.","category":"page"},{"location":"6_convection/#Brunt-Väisälä-frequency","page":"Notes","title":"Brunt-Väisälä frequency","text":"","category":"section"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"Before discussing what happens if the fluid is unstable to convection, let's see how a perturbation evolves with time. Combining (51) and (55) we get the equation of motion","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"mathrmdmfracmathrmd^2Delta rmathrmdt^2=-fracgdeltarhoH_P(nabla_mathrmad-nabla)Delta r mathrmdV(r+Delta r)tag56","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"For the volume mathrmdV we have","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"mathrmdV(r+Delta r)=fracmathrmdmrho(r+Delta r)=fracmathrmdmdisplaystylerho(r)+Delta rleft(fracmathrmdrhomathrmdrright)_mathrmesimeq fracmathrmdmrho(r)left1-fracDelta rrholeft(fracmathrmdrhomathrmdrright)_mathrmeright","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"so to first order in Delta r equation (56) is","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"fracmathrmd^2Delta rmathrmdt^2=-fracgdeltaH_P(nabla_mathrmad-nabla)Delta rtag57","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"The solution to this equation consists of oscillatory behavior or exponential growth, depending on the sign of nabla_mathrmad-nabla,","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"Delta r = (Delta r)_0 exp(iomega_mathrmBV(t-t_0))","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"where omega_mathrmBV is the Brunt-Väisälä frequency","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"omega_mathrmBV^2 = fracgdeltaH_Pleft(nabla_mathrmad-nablaright)","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"In regions of a star where nabla_mathrmadnabla (meaning, convectively stable) omega_mathrmBV defines a natural frequency of oscillations within the star.","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"Note that in our discussion on stability we have not considered the effect of possible composition gradients, which can develop naturally inside a star as a consequence of nuclear burning. How that affects the instability criterion (and thus, the Brunt-Väisälä frequency) is studied in the exercises of this session.","category":"page"},{"location":"6_convection/#Mixing-length-theory","page":"Notes","title":"Mixing length theory","text":"","category":"section"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"So, what happens if the fluid is unstable to convection? Then we will have energy transported through advection. If we consider a mass element travels a distance l before dissolving and equalizing its temperature with its environment, then it will release an amount of heat","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"Q = mathrmdm c_P DT(r+l)tag58","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"As convection requires nabla_mathrmadnabla, and pressure decreases outwards, we expect DT(r+l) to be positive for positive l and negative otherwise. This implies that convection indeed transports energy outwards.","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"But how much energy flux do we expect? In principle this is a very complex 3D hydrodynamics problem, which is unfeasible to compute together with the long evolutionary timescales of stars. Instead, the most common approach is a 1D approximation known as mixing length theory (MLT). Here we will show an example of MLT which does not account for radiative losses of energy from a mass element as it is displaced.","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"As small perturbations induce instability, let's assume that a convective region is entirely composed of blobs of materials that are unstable and move up or down. We consider a slab of material of area mathrmdA, and consider the mass elements crossing it in a time mathrmdt,","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"(Image: convective blob 2)","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"These elements have different velocities, sizes and temperature contrasts DT. We simplify things by taking all elements to have a characteristic absolute velocity v and absolute temperature contrast DT (positive for rising elements, negative otherwise). The amount of mass crossing mathrmdA upwards in time mathrmdt is","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"mathrmdM_+=frac12rhovmathrmdAmathrmdt","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"and similarly the mass crossing downwards is","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"mathrmdM_-=frac12rhovmathrmdAmathrmdt=mathrmdM_+","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"The total energy flux can be estimated by considering the heat excess given by equation (58). As v and DT are positive for elements moving radially upwards, they produce a net outwards radial energy flow. The same applies to downwards moving elements, which have a negative v and negative DT.","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"Dropping the absolute values to simplify notation and taking v and DT as positive, the flux coming from upwards and downwards moving mass elements totals","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"F=rho v c_P DTtag59","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"We will take as a characteristic length traveled by the mass element at the moment it crosses mathrmdA to be half of their total travel distance l_mathrmMLT. The distance l_mathrmMLT is a-priori unknown, and it is the reason for the name \"mixing-length-theory\". For a displacement l_mathrmMLT2 we have for DT","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"DT=fracl_mathrmMLT2leftleftleft(fracmathrmdTmathrmdrright)_mathrme-left(fracmathrmdTmathrmdrright)_mathrmsrightquadrightcdot H_P","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"H_P DT = -fracPl_mathrmMLT2leftleft(fracmathrmdTmathrmdPright)_mathrme-left(fracmathrmdTmathrmdPright)_mathrmsright","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"DT=-fracl_mathrmMLTT2H_Pleftleft(fracmathrmdln Tmathrmdln Pright)_mathrme-left(fracmathrmdln Tmathrmdln Pright)_mathrmsright","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"DT = -fracl_mathrmMLTT2H_P(nabla-nabla_mathrmad)tag510","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"which as we have mentioned is positive for a positive l_mathrmMLT in a convective region, as the Schwarzschild criterion requires nablanabla_mathrmad. The quantity (nabla-nabla_mathrmad) is known as the superadiabaticity.","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"We then need to compute the characteristic velocity v. Using equation (57) we can estimate the work done on the fluid element after it has traveled a distance l_mathrmMLT2,","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"W=int_0^l_mathrmMLT2mathrmdmfracgdeltaH_P(nabla-nabla_mathrmad)Delta rmathrmd(Delta r)","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"= mathrmdmfracgdeltaH_P(nabla-nabla_mathrmad)fracl_mathrmMLT^24","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"Not all of this work is translated into kinetic energy, as the gas also does work by expanding as it rises, pushing matter around. It is in details such as those that different forms of MLT arise. To recover a standard form of the convective flux, we will assume a quarter of W goes into kinetic energy,","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"frac12mathrmdm v^2 = fracW4","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"rightarrow v=left(fracgdeltaH_Pright)^12(nabla-nabla_mathrmad)^12fracl_mathrmMLT2sqrt2","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"From this expression for the convective velocity we get the convective flux using equations (59) and (510),","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"boxedF_mathrmconv=rho c_P T sqrtgdelta fracl_mathrmMLT^24sqrt2H_P^-32(nabla-nabla_mathrmad)^32","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"From this equation we see that the larger the superadiabaticity, the larger the convective flux. In many situations we find that the prefactor to (nabla-nabla_mathrmad)^32 in F_mathrmconv is so large that in practice the star only needs a small superadiabaticity (nabla-nabla_mathrmad)ll 1 to transport its energy outwards. In that case a coarse approximation of a structure equation for a convective region is to have","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"nabla = nabla_mathrmad","category":"page"},{"location":"6_convection/","page":"Notes","title":"Notes","text":"This is however not generally applicable, as radiative losses can make convection inefficient particularly in the outermost layers of a star.","category":"page"},{"location":"9_homology/#Main-sequence-homology","page":"Notes","title":"Main sequence homology","text":"","category":"section"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"Goals:","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"Homology\nMain-sequence homology (mass-radius relationship)","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"For reference, this section is based on chapter 7 of the lectures on stellar evolution by Onno Pols, available at https://www.astro.ru.nl/~onnop/education/stevutrechtnotes/.","category":"page"},{"location":"9_homology/#Homology","page":"Notes","title":"Homology","text":"","category":"section"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"So far we have derived a series of equations of stellar structure and evolution. Here we will consider stable stellar models, where we take time derivatives to be negligible to the other terms. We have","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"fracmathrmdrmathrmdm=frac14pi r^2rhoquadtextContinuity equation","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"fracmathrmdPmathrmdm=-fracGm4pi r^4quadtextHydrostatic equilibrium (HSE)","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"fracmathrmdLmathrmdm=varepsilon_mathrmnucquadtextEnergy equation","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"fracmathrmdTmathrmdm=-fracGm4pi r^4fracTPnablaquad\nnabla=begincases\nnabla_mathrmradnabla_mathrmradnabla_mathrmad \nnabla_mathrmadnabla_mathrmradnabla_mathrmad \nendcases","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"The last equation, which comes from the mode of energy transport, is often called the temperature equation. Beware that nabla=nabla_mathrmad is a significant simplification, as for convection to transport any energy at all we need nablanabla_mathrmad, as we discussed when we derived a form of mixing-length theory. Since we are considering static models, we drop the partial derivative signs.","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"The equations above pose a significant problem, as even if we make simplistic assumptions about opacities and nuclear reaction rates they are highly non-linear and are not amicable to find analytical solutions. So instead, we will take a different approach. Consider we have a star of mass M_1 for which we have a solution to the structure equations, meaning we know r_1(m), P_1(m), T_1(m) and L_1(m). We will then consider a star of mass M_2, together with a corresponding solution r_2(m), P_2(m), T_1(2) and L_2(m). To relate both models we will write the equations of stellar structure in terms of a relative mass coordinate","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"x=fracm_1M_1=fracm_2M_2","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"For each star, quantities at the same x then mean that we consider them at the same relative mass coordinate. Now, we will assume that both models are such that their radii follow","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"fracr_1(x)r_2(x)=fracR_1R_2tag71","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"Such two models are called homologous, which means layers of both models at the same mass coordinate are related by a fixed expansion or contraction factor.","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"Under the assumption of homology we can study how different solutions behave with changing mass and radius, without actually knowing any solution precisely. We do this by considering what (71) implies for the solution to the equations of stellar structure for the second star. We apply this logic to each of the equations of stellar structure in the following subsections.","category":"page"},{"location":"9_homology/#Continuity-equation","page":"Notes","title":"Continuity equation","text":"","category":"section"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"Let's start by considering the continuity equation for star 1:","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"fracmathrmdr_1mathrmdm_1=frac14pi r_1^2 rho_1","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"We can replace the derivative with one with respect to x,","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"fracmathrmdr_1mathrmdm_1=fracmathrmdr_1mathrmdxfracmathrmdxmathrmdm_1=frac1M_1fracmathrmd r_1mathrmdx","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"such that","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"fracmathrmdr_1mathrmdx=fracM_14pi r_1^2 rho_1tag72","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"Homology requires that r_1=r_2(R_1R_2), so replacing on the left hand side we get","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"left(fracR_1R_2right)fracmathrmdr_2mathrmdx=fracM_14pi r_1^2rho_1","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"but (72) must also hold by swapping indexes 1rightarrow 2, so","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"left(fracR_1R_2right)fracM_24pi r_2^2 rho_2=fracM_14pi r_1^2 rho_1","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"Finally, applying (71) again we find that","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"boxedfracrho_1(x)rho_2(x)=fracM_1M_2left(fracR_1R_2right)^-3tag73","category":"page"},{"location":"9_homology/#Equation-of-Hydrostatic-Equilibrium","page":"Notes","title":"Equation of Hydrostatic Equilibrium","text":"","category":"section"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"Now we will work with the equation of hydrostatic equilibrium (HSE). Similar to before, we find that","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"fracmathrmdPmathrmdx=-fracGm_1M_14pi r_1^4","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"=-fracGm_2M_24pi r_2^4left(fracm_1m_2right)left(fracM_1M_2right)left(fracr_2^4r_1^4right)","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"=fracmathrmdP_2mathrmdxleft(fracM_1M_2right)^2left(fracR_1R_2right)^-4","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"We can integrate this for an arbitrary x up to the surface (x=1), where ignoring surface pressure we obtain","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"boxedfracP_1(x)mathrmP_2(x)=left(fracM_1M_2right)^2left(fracR_1R_2right)^-4tag74","category":"page"},{"location":"9_homology/#Equation-of-state","page":"Notes","title":"Equation of state","text":"","category":"section"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"By using the equation of state we can also connect pressure, density temperature and composition. Lets consider an ideal gas equation of state, without radiation pressure and a fixed mean molecular weight mu,","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"P=fracrhomu m_mathrmuk_mathrmBT","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"We can consider this EOS for both stars with potentially different mu_1 and mu_2, in which case we get","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"fracP_1P_2=fracrho_1rho_2left(fracmu_1mu_2right)^-1fracT_1T_2","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"Using (73) and (74) we find","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"left(fracM_1M_2right)^2left(fracR_1R_2right)^-4=fracM_1M_2left(fracR_1R_2right)^-3left(fracmu_1mu_2right)^-1fracT_1T_2","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"rightarrow boxedfracT_1(x)T_2(x)=fracmu_1mu_2fracM_1M_2left(fracR_1R_2right)^-1tag75","category":"page"},{"location":"9_homology/#Radiative-energy-transport","page":"Notes","title":"Radiative energy transport","text":"","category":"section"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"Next, we will consider radiative energy transport. We have that","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"fracmathrmd(T_1^4)mathrmdx=-frac3kappa_1 l_1 M_116pi^2 a c r_1^4tag76","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"where we use l=L(M) to reserve L for the surface luminosity. We assume a general power-law form for the opacity,","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"kappa = kappa_0 rho^a T^b tag77","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"For bound-free and free-free opacity, the Kramer's law indicates a=1 and b=35 in particular. As one of the exercises of today's session it is shown that (75), (76) and (77) imply that","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"left(fracT_1(x)T_2(x)right)^4=fracl_1(x)l_2(x)fracM_1M_2frackappa_1kappa_2left(fracR_1R_2right)^-4","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"Further applying (75) provides the homology relationship for luminosity:","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"boxedfracl_1(x)l_2(x)=left(fracmu_1mu_2right)^4left(fracM_1M_2right)^3left(frackappa_1kappa_2right)^-1tag78","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"From this we see that the surface luminosity of homologous models scales steeply with mass,","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"Lpropto kappa^-1mu^4M^3","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"Note that this is independent of the energy source powering the star!","category":"page"},{"location":"9_homology/#Main-sequence-homology-2","page":"Notes","title":"Main sequence homology","text":"","category":"section"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"The relationships derived so far allow us to determine how the different properties of a homogeneous star scale with mass and radius. These relationships can be used to describe a star that is out of thermal equilibrium, where its energy source comes from sinking in its own potential well. Placing an extra homology constraint can the allow us to determine a mass-radius relationship. We can do this by applying the equation of thermal equilibrium,","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"fracmathrmdlmathrmdm=varepsilon_mathrmnuc","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"It is by including this that we have information on the nuclear burning process and can thus discuss the main sequence (meaning, the core-hydrogen burning phase). From the exercises of the previous class we saw that one can approximate a reaction rate using a power law in temperature, such that","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"varepsilon_mathrmnuc=varepsilon_0 rho T^nu","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"With this the equation of thermal equilibrium reads","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"fracmathrmdl_1mathrmdx=varepsilon_0 M_1 rho_1 T_1^nu","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"=fracmathrmdl_2mathrmdxfracM_1M_2fracrho_1rho_2left(fracT_1T_2right)^nu","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"All terms in parenthesis are not functions of x given (73) and (75) so we can integrate from the core to an arbitrary x to find (where we take l(0)=0),","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"fracl_1(x)l_2(x)=fracM_1M_2fracrho_1rho_2left(fracT_1T_2right)^nu","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"But we already have homology relationships for l(x) (eq. (78)), rho(x) (eq. (73)) and T(x) (eq. (75)). If we make use of these we get","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"left(fracmu_1mu_2right)^4left(fracM_1M_2right)^3left(frackappa_1kappa_2right)^-1=fracM_1M_2cdot fracM_1M_2left(fracR_1R_2right)^-3cdot left(fracmu_1mu_2right)^nuleft(fracM_1M_2right)^nuleft(fracR_1R_2right)^-nu","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"From which we get a direct relationship between the mass and the radius,","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"fracR_1R_2=left(fracmu_1mu_2right)^(nu-4)(nu-3)left(fracM_1M_2right)^(nu-1)(nu+3)left(frackappa_1kappa_2right)^1(nu+3)","category":"page"},{"location":"9_homology/","page":"Notes","title":"Notes","text":"For the conditions at which stars undergo PP and CNO burning in their cores one has that nusimeq 4 and nusimeq 18 respectively. So, ignoring the dependence in opacity, we see that the radius of the star at the zero-age main sequence (start of hydrogen burning with homogeneous composition) is expected to increase with mass. Although this might appear obvious, it is not. In particular this is the opposite to what we found for degenerate stars, which we can approximate through polytropic models that have a decreasing radius with mass.","category":"page"},{"location":"3_eos1_problems/#Exercises","page":"Exercises","title":"Exercises","text":"","category":"section"},{"location":"3_eos1_problems/#List-of-exercises","page":"Exercises","title":"List of exercises","text":"","category":"section"},{"location":"3_eos1_problems/#1:-Manipulation-of-thermodynamic-quantities","page":"Exercises","title":"1: Manipulation of thermodynamic quantities","text":"","category":"section"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"Using the definitions of alpha and delta,","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"alpha equiv left(fracpartial lnrhopartial ln Pright)_Tquad delta equiv -left(fracpartial lnrhopartial ln Tright)_P","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"and expressing a change in specific volume v in terms of P and T as independent variables,","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"dv=left(fracpartial vpartial Tright)_P dT + left(fracpartial vpartial Pright)_T dP","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"show that:","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"left(fracpartial Ppartial Tright)_v = frac-left(fracpartial vpartial Tright)_Pleft(fracpartial vpartial Pright)_T=fracPdeltaTalphaqquad mathrmand qquad Tleft(fracpartial vpartial Tright)_P = fracdeltarho","category":"page"},{"location":"3_eos1_problems/#2:-Energy-equation-using-\\rho-and-T-as-independent-variables","page":"Exercises","title":"2: Energy equation using rho and T as independent variables","text":"","category":"section"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"We have shown that using T and P as independent variables the energy equation can be expressed as:","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"fracdqdt=c_Pfracd Td t - fracdeltarhofracd Pd t","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"However, one could alternatively use T and rho as independent variables (which is done, for example, by the textttMESA code). Show that the energy equation using these two independent variables can be expressed as:","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"fracdqdt=c_Pleft(1-chi_Tnabla_mathrmad)fracdTdt-fracTrhochi_rho nabla_mathrmadfracdrhod tright","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"where","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"nabla_mathrmadequivleft(fracpartial ln Tpartial ln Pright)_s=fracPdeltaTrho c_Pquad chi_Tequiv left(fracpartial ln Ppartial ln Tright)_rho quad chi_rhoequiv left(fracpartial ln Ppartial ln rhoright)_T","category":"page"},{"location":"3_eos1_problems/#3:-Ideal-gas-EOS-from-Maxwell-Boltzmann-distribution","page":"Exercises","title":"3: Ideal gas EOS from Maxwell-Boltzmann distribution","text":"","category":"section"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"The number density per unit momentum n_p of classical non-relativistic particles of mass m in thermodynamic equilibrium is given by the Maxwell-Boltzmann distribution:","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"n_p(p)=fracn(2pi m k T)^32expleft(frac-p^22mkTright) 4pi p^2","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"where n is the number density of particles. Show that this satisfies that:","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"n=int_0^infty n_p dp","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"and that the specific energy density and the pressure are:","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"u=frac1rhoint_0^infty epsilon_p n_p dp=frac32frackTm qquad P = frac13int_0^infty v_p p n_p dp=fracrhomkT","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"To do this, consider that for a non-relativistic particle its energy is epsilon_p=p^22m and its velocity is v_p=pm. Use the standard integral","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"int_0^infty e^-ax^2dx=frac12sqrtfracpia","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"which by derivation of both sides by a (moving the derivation under the integral in the left hand side) gives the required integrals.","category":"page"},{"location":"3_eos1_problems/#4:-Constant-entropy-star","page":"Exercises","title":"4: Constant entropy star","text":"","category":"section"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"The structure of a hypothetical star with constant entropy would be given by","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"fracpartial ln Tpartial ln P=nabla_mathrmad=fracPdeltaTrho c_P","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"Show that for an ideal gas without radiation pressure nabla_mathrmad=25, and that this implies that the structure of the star can be described using an n=32 polytrope. Remember that the specific heat at constant pressure can be computed from","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"c_P = left(fracpartial upartial Tright)_P +P left(fracdvdTright)_P","category":"page"},{"location":"3_eos1_problems/#Solutions","page":"Exercises","title":"Solutions","text":"","category":"section"},{"location":"3_eos1_problems/#1:-Manipulation-of-thermodynamic-quantities-2","page":"Exercises","title":"1: Manipulation of thermodynamic quantities","text":"","category":"section"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"From the expression for dv we have that","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"fracdvdT=left(fracpartial vpartial Tright)_P +left(fracpartial vpartial Pright)_T fracdPdT","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"Considering a change in temperature at constant volume we obtain","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"0=left(fracpartial vpartial Tright)_P+left(fracpartial vpartial Pright)_T left(fracdPdTright)_v","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"from which it follows that","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"left(fracpartial Ppartial Tright)_v = frac-left(fracpartial vpartial Tright)_Pleft(fracpartial vpartial Pright)_T","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"The partial derivatives of specific volume can be turned into derivatives of density,","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"left(fracpartial vpartial Tright)_P = left(fracpartial (1rho)partial Tright)_P=-frac1rho^2left(fracpartial rhopartial Tright)_P= -frac1rho^2fracrhoTleft(fracpartial lnrhopartial ln Tright)_P=fracdeltarho T","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"and multiplying this by the density gives us the second required result. Similarly we find that","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"left(fracpartial vpartial Pright)_T=-fracalpharho P","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"from which we obtain the first result:","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"left(fracpartial Ppartial Tright)_v=fracPdeltaTalpha","category":"page"},{"location":"3_eos1_problems/#2:-Energy-equation-using-\\rho-and-T-as-independent-variables-2","page":"Exercises","title":"2: Energy equation using rho and T as independent variables","text":"","category":"section"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"We start by noting that","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"fracd Pd t = left(fracpartial Ppartial Tright)_rho fracd Tdt + left(fracpartial Ppartial rhoright)_T fracd rhodt","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"Turning the derivatives into derivatives over the logarithms, and replacing with chi_T and chi_rho, gives us","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"fracd Pd t = fracPchi_TTfracd Tdt + fracPchi_rhorhofracd rhodt","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"We then replace this in the energy equation with T and P as independent variables:","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"fracdqdt=leftc_P -fracPdeltachi_Trho Tright fracd Tdt - fracPdeltachi_rhorho^2fracd rhodt","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"Replacing Pdelta = nabla_mathrmadTrho c_P we find the final result,","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"fracdqdt=c_Pleft(1-chi_Tnabla_mathrmad)fracdTdt-fracTrhochi_rho nabla_mathrmadfracdrhod tright","category":"page"},{"location":"3_eos1_problems/#3:-Ideal-gas-EOS-from-Maxwell-Boltzmann-distribution-2","page":"Exercises","title":"3: Ideal gas EOS from Maxwell-Boltzmann distribution","text":"","category":"section"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"Deriving the standard integral by a results in","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"fracddaint_0^infty e^-ax^2 dx = -int_0^infty e^-ax^2 x^2 dx","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"equating this to the derivation by a on the known result of the standard integral gives us","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"int_0^infty e^-ax^2 x^2 dx = frac14sqrtfracpia^3","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"This can be used directly to perform the integral for n. Deriving the last integral once more by a gives us the necessary result to compute the integrals for the specific energy and the pressure:","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"int_0^infty e^-ax^2 x^4 dx = frac38sqrtfracpia^5","category":"page"},{"location":"3_eos1_problems/#4:-Constant-entropy-star-2","page":"Exercises","title":"4: Constant entropy star","text":"","category":"section"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"We start by computing the specific heat at constant pressure:","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"c_P = left(fracd udTright)_P +P left(fracd vdTright)_P","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"Using the energy density and the pressure for the ideal gas without radiation given in the previous exercise we find that","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"left(fracpartial upartial Tright)_P =frac32frackmquad P left(fracd vdTright)_P = -fracPrho^2left(fracd rhodTright)_P=frackm","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"which gives us the specific heat at constant pressure,","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"c_P = frac52frackm","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"Similarly we find that","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"delta = -fracTrho left(fracpartial rhopartial Tright)_P=1","category":"page"},{"location":"3_eos1_problems/","page":"Exercises","title":"Exercises","text":"Combining the two previous results we obtain nabla_mathrmad=25. Now consider the temperature follows a power law on pressure Tpropto P^beta. If we have a stellar model with an adiabatic structure then it follows that beta=25. Since the ideal gas law without radiation says that Ppropto rho T, we find that Ppropto rho^53. This power law corresponds exactly to a polytrope of index n=32.","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"EditURL = \"2_equations_computational.jl\"","category":"page"},{"location":"2_equations_computational/#Solving-the-Lane-Emden-equation","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"","category":"section"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"Let's compute some numerical solutions to the Lane-Embden equation. A good reference which was used in the development of this exercise is the book by [Hansen2004].","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"using Plots\nusing LaTeXStrings","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"By defining the variables y=dwdz, the Lane-Emden equation can be written as two first-order differential equations:","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"w = y","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"y = -w^n -frac2zy","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"To numerically solve a continuous differential equation with a computer we need to rely on a discretization. For example, if we evaluate z in discrete steps enumerated by i with a spacing Delta z, we have that:","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"z_i = iDelta z","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"In terms of this discretization, the pair of differential equations above can be approximated as:","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"fracw_i+1-w_iDelta z=y_i","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"fracw_i+1-w_iDelta z=-w_i^n - frac2z y_i","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"This is known as the Euler method, and it lets us compute the values at cell i+1 once we know the value at cell i. To integrate these equations we will instead use a more precise method known as a fourth-order Runge-Kutta solver. The values at cell i+1 are obtained in this method as","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"w_i+1 = w_i +frack_16+frack_23+frack_33+frack_46","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"y_i+1 = y_i +fracl_16+fracl_23+fracl_33+fracl_46","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"where","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"k_1 = Delta ztimes w(z_iw_iy_i)","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"l_1 = Delta ztimes y(z_iw_iy_i)","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"k_2 = Delta ztimes w(z_i+Delta z2w_i+k_12y_i+l_12)","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"l_2 = Delta ztimes y(z_i+Delta z2w_i+k_12y_i+l_12)","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"k_3 = Delta ztimes w(z_i+Delta z2w_i+k_22y_i+l_22)","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"l_3 = Delta ztimes y(z_i+Delta z2w_i+k_22y_i+l_22)","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"k_4 = Delta ztimes w(z_i+Delta zw_i+k_3y_i+l_3)","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"l_4 = Delta ztimes y(z_i+Delta zw_i+k_3y_i+l_3)","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"The objective is then to start from the center of the star and integrate outwards until we reach the first zero of y, which represents the stellar surface. One complication however is that the differential equation for y is undefined at the center (x=0). This can be circumvented by using a series approximation near the center, which is straightforward to derive using the boundary conditions:","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"w(z)=1-frac16z^2 +fracn120z^4\n-fracn(8n-5)15120z^6+mathcalO(z^8)","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"In the code cell below we define the differential equations as well as a method to do a single Runge-Kutta step, which returns a tuple with the new (yz) values in the following cell. We also define the function that approximates y and z for small xi.","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"dwdz(z,w,y,n) = y\ndydz(z,w,y,n) = -w^n-2*y/z\n\nfunction RK_step(z,w,y,n,Δz)\n    k₁ = Δz*dwdz(z,w,y,n)\n    l₁ = Δz*dydz(z,w,y,n)\n\n    k₂ = Δz*dwdz(z+Δz/2,w+k₁/2,y+l₁/2,n)\n    l₂ = Δz*dydz(z+Δz/2,w+k₁/2,y+l₁/2,n)\n\n    k₃ = Δz*dwdz(z+Δz/2,w+k₂/2,y+l₂/2,n)\n    l₃ = Δz*dydz(z+Δz/2,w+k₂/2,y+l₂/2,n)\n\n    k₄ = Δz*dwdz(z+Δz,w+k₃,y+l₃,n)\n    l₄ = Δz*dydz(z+Δz,w+k₃,y+l₃,n)\n\n    return (\n        w+k₁/6+k₂/3+k₃/3+k₄/6,\n        y+l₁/6+l₂/3+l₃/3+l₄/6,\n        )\nend\n\nw_smallz(z,n) = 1 - 1/6*z^2 + n/120*z^4 -n*(8*n-5)/1520*z^6\ny_smallz(z,n) = - 1/3*z + n/30*z^3 -3*n*(8*n-5)/760*z^5","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"Now we will integrate these equations. We start at a small of z and integrate the equations until z=20 (hoping we find a zero by then). Below we do this for n=1","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"#setup grid in z\nΔz = 1e-4\nn = 1\nnsteps = 200_000\nzvals = LinRange(Δz,Δz*nsteps,nsteps)\n\n#initialize first value of w and y using series approximation\nwvals = zeros(nsteps);yvals = zeros(nsteps)\nwvals[1] = w_smallz(Δz, n)\nyvals[1] = y_smallz(Δz, n)\n\n#Perform the Runge-Kutta integration\nfor i in 2:nsteps\n    next_values = RK_step(zvals[i-1], wvals[i-1], yvals[i-1], n, Δz)\n    wvals[i] = next_values[1]\n    yvals[i] = next_values[2]\nend\n\n\nplot(xlabel=L\"$z$\", ylabel=L\"$w$\");\n#plot!(xvals, 1 .- xvals.^2 ./ 6,label=\"Analytical\") #solution for n=0\nplot!(zvals, sin.(zvals)./zvals, linewidth=4,label=\"Analytical\"); #solution for n=1\n#plot!(xvals, 1 ./ sqrt.(1 .+ xvals.^2 ./3),label=\"Analytical\")    #solution for n=5\nplot!(zvals, wvals, linewidth=6, linestyle=:dash,label=\"Numerical\")","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"To compute the ratio of central density to average density, we define a function to performs this integration for arbitrary n and looks for the first point where w=0, which gives z_1 that corresponds to the surface.","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"function rhoc_div_rho_avg(n)\n    #setup grid in z\n    Δz = 1e-4\n    nsteps = 200_000\n    zvals = LinRange(Δz,Δz*nsteps,nsteps)\n\n    #initialize first value of w and y using series approximation\n    wvals = zeros(nsteps);yvals = zeros(nsteps)\n    wvals[1] = w_smallz(Δz, n)\n    yvals[1] = y_smallz(Δz, n)\n\n    #Perform the Runge-Kutta integration\n    for i in 2:nsteps\n        next_values = RK_step(zvals[i-1], wvals[i-1], yvals[i-1], n, Δz)\n        wvals[i] = next_values[1]\n        yvals[i] = next_values[2]\n        if wvals[i] < 0\n            return 1/3*(-zvals[i]/yvals[i])\n        end\n    end\n\n    print(\"Error, did not find zero for n=$n\")\nend\n\n\n\nnvals = [0,1,2,3,4]\nrhoc_div_rho_avg_vals = rhoc_div_rho_avg.(nvals)\n\nplot(xlabel=L\"$n$\", ylabel=L\"$\\rho_\\mathrm{c}/\\langle \\rho \\rangle$\", yscale=:log)\nplot!(nvals, rhoc_div_rho_avg_vals, linewidth=4,label=\"\")","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"We see that the higher the polytropic index is, the more concentrated the star is.","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"[Hansen2004]: Stellar interiors : physical principles, structure, and evolution, 2nd ed., by C.J. Hansen, S.D. Kawaler, and V. Trimble. New York: Springer-Verlag, 2004. https://ui.adsabs.harvard.edu/abs/2004sipp.book.....H/abstract","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"","category":"page"},{"location":"2_equations_computational/","page":"Solving the Lane-Emden equation","title":"Solving the Lane-Emden equation","text":"This page was generated using Literate.jl.","category":"page"},{"location":"3_eos1/#The-energy-equation-and-the-equation-of-state-(EOS)","page":"Notes","title":"The energy equation and the equation of state (EOS)","text":"","category":"section"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"Goals:","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"Relate the energy equation to global energetics\nDefine different EOS properties\nRewrite the energy equation in terms of P and T instead of s\nDescribe how macroscopic properties can be obtained from the distribution of momenta of individual particles","category":"page"},{"location":"3_eos1/#Energy-equation-and-global-energetics","page":"Notes","title":"Energy equation and global energetics","text":"","category":"section"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"Let's consider the energy equation in its Lagragian form:","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"Tfracpartial spartial t=fracpartial qpartial t=varepsilon_mathrmnuc-fracpartial Lpartial mtag21","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"We can rewrite this using the first law of thermodynamics, which states that","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"mathrmdU = mathrmdQ - PmathrmdV","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"This form of the first law describes a body of volume V with a surface pressure P and total energy U, to which an amount of heat mathrmdQ is deposited. We want to work with local properties of our gas, for which we make use of specific (meaning, per unit mass) quantities,","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"mathrmdu=mathrmdq -P mathrmdv quad vequiv frac1rho","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"where v is the volume per unit mass. More commonly v is reserved for the velocity, but in this chapter we reserve it exclusively for the specific volume. The energy equation (2.1) can then be rewritten as","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"fracpartial upartial t+Pfracpartial vpartial t=varepsilon_mathrmnuc-fracpartial Lpartial m","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"To describe global properties of the star we can integrate this equation over the total mass of the star,","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"int_0^Mleftfracpartial upartial t+Pfracpartial vpartial trightmathrmdm=int_0^Mleftvarepsilon_mathrmnuc-fracpartial Lpartial mrightmathrmdmtag22","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"Integrating varepsilon_mathrmnuc gives us the total nuclear energy generation rate in the star, to which we refer as L_mathrmnuc. We also have that","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"int_0^Mfracpartial upartial tmathrmdm=fracpartialpartial tint_0^M umathrmdm = dotE_i","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"where we recall that E_i is the total internal energy of the gas. Using this Equation (2.2) becomes","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"dotE_i+int_0^M Pfracpartial vpartial tmathrmdm=L_mathrmnuc-L_mathrmsurf+L(0)","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"where L_mathrmsurf=L(m=M) is the luminosity at the stellar surface. Using the central boundary condition on the luminosity we get that","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"dotE_i-int_0^M Pfracpartial vpartial tmathrmdm = L_mathrmnuc-L_mathrmsurf","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"The right hand side of this equation is equal to the energy injected onto the star minus the energy radiated away from its surface. We then expect the left hand side of the equation to correspond to the rate of change of the total energy E=E_i+E_g. For this to be true, then we require that","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"dotE_g = int_0^MPfracpartial vpartial tmathrmdm tag24","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"We take Equation (24) as a consequence of the energy equation, but instead, let's verify that it is correct in terms of the definition of E_g and the equation of hydrostatic equilibrium. First, it is straightforward to relate dotv to dotrho:","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"fracpartial vpartial t=fracpartialpartial tleft(frac1rhoright)=-fracdotrhorho^2","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"rightarrow int_0^M Pfracpartial vpartial tmathrmdm = -int_0^M fracPdotrhorho^2mathrmdmtag25","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"We can also obtain dotE_g from the virial theorem:","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"E_g=-3int_0^MfracPrhomathrmdm","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"rightarrowdotE_g=-3int_0^MfracdotPrhomathrmdm + 3int_0^MfracPdotrhorho^2mathrmdm tag26","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"The first integral on the right hand side can be obtained from the equation of hydrostatic equilibrium,","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"leftfracpartial Ppartial m=-fracGm4pi r^4quadrightfracpartialpartial tcdot","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"leftfracpartial dotPpartial m=4fracGm4pi r^4fracdotrrquadright4pi r^3cdot","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"left4pi r^3 fracpartial dotPpartial m=4fracGmrfracdotrrquadrightint_0^M()mathrmdm","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"int_0^M 4pi r^3 fracpartial dotPpartial mmathrmdm=4int_0^MfracGmrfracdotrrmathrmdmtag27","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"From the definition of E_g we have","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"E_g=-int_0^MfracGmrmathrmdm","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"rightarrow dotE_g=int_0^M fracGmrfracdotrrmathrmdm","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"Replacing this in Equation (27) and integrating the left hand side by parts gives","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"leftleft(4pi r^3 dotPright)right_0^M-3int_0^M 4pi r^2 fracpartial rpartial mdotPmathrmdm=4dotE_g","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"where the first term is zero due to the boundary conditions, and using the equation of continuity to replace partial rpartial m results in","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"-3int_0^MfracdotPrhomathrmdm=4dotE_g","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"Replacing this in Equation (26) one obtains","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"dotE_g=-int_0^M fracPdotrhor^2mathrmdm","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"which combined with Equation (25) shows that indeed Equation (24) is correct. This means that Equation (23) is equivalent to","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"L_mathrmnuc-L_mathrmsurf=dotE_i+dotE_g = dotE","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"which is what we expect in terms of the evolution of the total energy and its sinks and sources.","category":"page"},{"location":"3_eos1/#EOS-definitions","page":"Notes","title":"EOS definitions","text":"","category":"section"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"We want to express the energy equation (21) in terms of something other than entropy. By virtue of the first law of thermodynamics, we already showed that","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"fracpartial upartial t+Pfracpartial vpartial t=varepsilon_mathrmnuc-fracpartial Lpartial mtag28","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"In general, the local state of the fluid is determined by a pair of properties, such as pressure and temperature (and also composition, but for now we ignore changes in it). The version of the energy equation above uses internal energy and density (in terms of the specific volume), but we could use any other pair of independent thermodynamic properties of the fluid. To write this in a form commonly used in stellar evolution theory, we will switch it to use pressure and temperature.","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"Before we do so, we will first define some terms associated to an equation of state. If we consider an EOS of the form","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"rho=rho(PT)","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"then changes in density are related to changes in pressure and temperature as","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"mathrmdrho = left(fracpartial rhopartial Pright)_TmathrmdP + left(fracpartialrhopartial Tright)_PmathrmdT tag29","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"The partial derivatives are commonly expressed in terms of logarithmic derivatives,","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"left(fracpartial rhopartial Pright)_T=fracmathrmdrhomathrmdln rholeft(fracpartial ln rhopartial ln Pright)_Tfracmathrmdln PmathrmdP=fracrhoPleft(fracpartial ln rhopartial ln Pright)_T","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"If we define","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"alphaequiv left(fracpartial ln rhopartial ln Pright)_T quad delta=-left(fracpartiallnrhopartialln Tright)_P","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"then Equation (2.9) turns into","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"fracmathrmdrhorho=alphafracmathrmdPP-delta fracmathrmdTT","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"If we know the the form rho=rho(PT) of the EOS, alpha and delta can be derived from it. Two other quantities that will be useful are the heat capacities. The heat capacity at constant pressure is:","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"c_Pequiv left(fracpartial qpartial Tright)_P=left(fracpartial upartial Tright)_P+Pleft(fracpartial vpartial Tright)_P","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"and similarly, we have the specific heat at constant volume,","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"c_vequiv left(fracpartial qpartial Tright)_v=left(fracpartial upartial Tright)_v","category":"page"},{"location":"3_eos1/#Rewriting-the-energy-equation","page":"Notes","title":"Rewriting the energy equation","text":"","category":"section"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"We aim to write the energy equation (2.8) in terms of the pressure and temperature. For this we have that","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"mathrmdq=mathrmdu+Pmathrmdv=AmathrmdT+BmathrmdP","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"Our objective is to find A and B. For this we will need two seemingly (at first) unrelated results.","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"Consider the relationship between u, v and T,\nmathrmdu = left(fracpartial upartial vright)_T mathrmdv + left(fracpartial upartial Tright)_vmathrmdTtag210\nWe also have that\nmathrmds=fracmathrmdqT=frac1Tleft(mathrmdu + Pmathrmdvright)\nwere after applying Equation (210) gives us\nmathrmds=frac1Tleftleft(fracpartial upartial vright)_T + Prightmathrmdv + frac1Tleft(fracpartial upartial Tright)_v\nAs mathrmds is a total differential (in contrast to mathrmdq which is an imperfect differential) we have that\nfracpartial^2 spartial Tpartial v=fracpartial^2 spartial vpartial T\nrightarrow fracpartialpartial Tleftfrac1Tleft(fracpartial upartial vright)_T+fracPTright=frac1Tfracpartial^2 upartial vpartial T\nwhich after performing the derivative on the left hand side gives us the following relationship:\nboxedleft(fracpartial upartial vright)_T=Tleft(fracpartial Ppartial Tright)_v-Ptag211\nWe will now derive a relationship between the specific heats. We start from (210),\nfracmathrmdumathrmdT=left(fracpartial upartial vright)_Tfracmathrmd vmathrmd T+left(fracpartial upartial Tright)_v\nleft(fracpartial upartial Tright)_P=left(fracpartial upartial vright)_Tleft(fracpartial vpartial Tright)_P+left(fracpartial upartial Tright)_v\nWe use (211) on the right hand side,\nleft(fracpartial upartial Tright)_P=leftTleft(fracpartial Ppartial Tright)_v-Prightleft(fracpartial vpartial Tright)_P + left(fracpartial upartial Tright)_v\nand after rearranging terms we get\nleft(fracpartial upartial Tright)_P + Pleft(fracpartial upartial Tright)_P-left(fracpartial upartial Tright)_v = Tleft(fracpartial Ppartial Tright)_vleft(fracpartial vpartial Tright)_P\nc_P-c_v = Tleft(fracpartial Ppartial Tright)_vleft(fracpartial vpartial Tright)_Ptag212\nWe leave it as part of the exercises to show that\nleft(fracpartial Ppartial Tright)_v=-fracleft(fracpartial Ppartial Tright)_Pleft(fracpartial vpartial Pright)_T=fracPdeltaTalpha tag213\nand that\nTleft(fracpartial vpartial Tright)_P=fracdeltarho\nUsing these two expressions in Equation (214) results in\nboxedc_P-c_v = fracPdelta^2Trhoalphatag214","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"We now have what we need to rewrite our energy equation. Let's start from","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"mathrmdq = mathrmdu + P mathrmdv","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"Applying (210) we get","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"mathrmdq = left(fracpartial upartial Tright)_vmathrmdT + left(fracpartial upartial vright)_Tmathrmdv+Pmathrmdv","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"=left(fracpartial upartial Tright)_vmathrmdT+leftleft(fracpartial upartial vright)_T+Prightmathrmdv","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"We use (211) on the left hand side,","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"mathrmdq=left(fracpartial upartial Tright)_vmathrmdT+Tleft(fracpartial Ppartial Tright)_vmathrmdv","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"We note that c_v=(partial upartial T)_v and mathrmdv=-mathrmdrhorho^2, and use Equation (213) on the right hand side,","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"mathrmdq = c_vmathrmdT-fracPdeltarhoalphafracmathrmdrhorho","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"=c_vmathrmdT-fracPdeltarhoalphaleft(alphafracmathrmdPP-deltafracmathrmdTTright)","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"=left(c_v+fracPdelta^2rho T alpharight)mathrmdT-fracdeltarhomathrmdP","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"Using Equation (214) we finally get what we were looking for: mathrmdq = c_PmathrmdT-fracdeltarhomathrmdPtag215 Using this expression we obtain the energy equation in terms of partial Ppartial t and partial Tpartial t,","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"boxedc_Pfracpartial Tpartial t-fracdeltarhofracpartial Ppartial t=varepsilon_mathrmnuc-fracpartial Lpartial m","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"A very useful property of the gas is the adiabatic temperature gradient,","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"nabla_mathrmad=left(fracpartial ln Tpartial ln Pright)_mathrmad","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"where \"ad\" indicates a change at constant entropy (mathrmds=0). Using Equation (215) together with Tmathrmds=mathrmdq, we get","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"leftleft(fracpartial Tpartial Pright)_mathrmad=-fracdeltac_PrhoquadrightfracPTcdot","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"boxednabla_mathrmad=fracPdeltaTrho c_P","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"We will find later on that in some cases we can approximate a star as a ball of constant entropy, which implies","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"nablaequivfracpartial ln Tpartial ln P=nabla_mathrmad","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"where nabla represents the actual temperature gradient with respect to pressure through the star.","category":"page"},{"location":"3_eos1/#Deriving-a-pressure-from-a-distribution","page":"Notes","title":"Deriving a pressure from a distribution","text":"","category":"section"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"So, once we manage to write down our EOS as rho=rho(PT), and we also determine its internal energy u=u(PT), we can determine c_P, alpha and delta. This gives us what we need for the energy equation.","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"But how can we derive rho(PT) and u(PT)? Next class we'll work on that, considering that a gas has multiple particles with a distribution of their velocities (and momenta). We can express the number of particles in a volume mathrmdV that have a momentum between p and p+mathrmdp as","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"N(pp+mathrmdp)=n_pmathrmdpmathrmdV=nf(p)mathrmdpmathrmdV","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"where n is the number of particles per unit volume and f(p) is a probability density for a particle to have a given momentum.If we can find f(p) then we can determine macroscopic properties such as pressure and internal energy density. For example, next week we'll show that","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"P=frac13int_0^infty v_p p n_pmathrmdp","category":"page"},{"location":"3_eos1/","page":"Notes","title":"Notes","text":"where v_p is the velocity of a particle with momentum p.","category":"page"},{"location":"8_SE_codes/#Stellar-evolution-models","page":"Stellar evolution models","title":"Stellar evolution models","text":"","category":"section"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"This introduction to the first MESA lab will cover what a stellar model is, how to build one and how modern stellar evolution codes create and evolve those in time. ","category":"page"},{"location":"8_SE_codes/#Differential-equations-of-stellar-evolution","page":"Stellar evolution models","title":"Differential equations of stellar evolution","text":"","category":"section"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"Let's collect and summarize the system of differential equations derived in the previous lectures for a spherically symmetric star, in Lagrangian form.","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"CONTINUITY EQUATION\ndfracpartial rpartial m=dfrac14pi r^2 rhohspace845cm\nEQUATION OF MOTION\na_r=-dfracGmr^2-4pi r^2dfracpartial Ppartial mhspace715cm\nENERGY EQUATION\ndfracpartial Lpartial m=epsilon_mathrmnuc-c_Pdfracpartial Tpartial t+dfracdeltarhodfracpartial Ppartial thspace81cm\nENERGY TRANSPORT EQUATION\ndfracpartial Tpartial m=-dfracGm4pi r^4dfracTPnablahspace656cm\nwith hspace025cmnabla=nabla_mathrmradhspace025cmmathrmifhspace025cmnabla_mathrmradleqnabla_mathrmad nabla=nabla_mathrmadhspace025cmmathrmifhspace025cmnabla_mathrmradnabla_mathrmad\nABUNDANCE EQUATION\ndfracpartial X_ipartial t=dfracA_im_urholeft(-sum_j(1+delta_ij)r_ij+sum_klr_kliright)+mathrmmixing termshspace113cm\nwith hspace025cmsum_i^I X_i=1hspace05cmI= isotopes.","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"This is a system of non-linear partial differential equations, with the mass coordinate m and the time t as independent variables.","category":"page"},{"location":"8_SE_codes/#How-many-equations-and-unknowns?","page":"Stellar evolution models","title":"How many equations and unknowns?","text":"","category":"section"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"The abundance equation, (5), is a set of I equations, where I expresses the number of species in the chemical mixture composing the star. One of the equations can be replaced by the condition on the sum of the isotopes' mass fractions, X_i, to be normalized to unit, sum_i^I X_i=1. Therefore, we have a total of I+4 equations. ","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"Counting the unknowns goes more or less like you did in Equations. We can see the following symbols appearing in the system of equations:","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"The radius r(mt) \nThe density rho(mt)\nThe pressure P(mt)\nThe specific entropy s(mt)\nThe temperature T(mt)\nThe luminosity L(mt)\nThe total rate of nuclear energy generation epsilon_mathrmnuc(mt)\nThe reaction rate of the i species with the j species, r_ij(mt)\nThe I mass fractions X_i(mt).","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"The mass fractions X_i account for I unknowns altogether. Out of the other 8 items of the above list, some quantities can be expressed as a function of the others. For example, remember that the total nuclear energy generatio rate epsilon_mathrmnuc, at each mass element m, is defined as ","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"epsilon_mathrmnucequivsum_ijepsilon_ij=sum_ijdfracQ_ijr_ijrho","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"with Q_ij being the Q-value of the reaction between species i with j, and r_ij the rate of the reaction itself. As for the other items, there are functions that describe the characteristics of the stellar material, for example an EOS of the following form is assumed forall m:","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"mathrmEOShspace1cmrho=rho(PTX_i)","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"We also saw in class that the radiative temperature gradient nabla_mathrmrad is known as a function of LPTX_im: nabla_mathrmrad=nabla_mathrmrad(mPTX_iL)","category":"page"},{"location":"8_SE_codes/#Mycrophysics-ingredients","page":"Stellar evolution models","title":"Mycrophysics ingredients","text":"","category":"section"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"These are again characteristics of the stellar material, which are describing the physics we put in our model to reach the desired degree of complexity: the Rosseland mean opacity kappa, the nuclear reaction rates r_ij for the chosen network of isotopes, the specific entropy s and nabla_mathrmad. As studied in the lectures, we assume that these are known as a function of (PTX_i):","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"kappa=kappa(PTX_i)","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"r_jk=r_jk(PTX_i)hspace05cmRightarrowhspace05cmepsilon_mathrmnuc=epsilon_mathrmnuc(PTX_i)","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"nabla_mathrmad=nabla_mathrmad(PTX_i)","category":"page"},{"location":"8_SE_codes/#Thermodynamic-quantities","page":"Stellar evolution models","title":"Thermodynamic quantities","text":"","category":"section"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"The thermodynamic quantities delta and c_mathrmP are also assumed to be known functions of (PTX_i), once the EOS is known:","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"delta=delta(PTX_i)hspace05cmc_P=c_P(PTX_i)","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"If you now look at the symbols that are left, you can count the following: r(mt), P(tm), T(mt), L(mt), to be added to the I mass fractions X_i(mt). We have therefore I+4 unknowns for I+4 equations.","category":"page"},{"location":"8_SE_codes/#What-is-a-stellar-model?","page":"Stellar evolution models","title":"What is a stellar model?","text":"","category":"section"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"The I+4 non-linear partial differential equations must be solved simultaneously as a function of the two independent variables (mt), namely a solution to the above set of equations will span the interval 0leq mleq M, with M depending on mass loss, and tgeq t_0, with t_0 being an initial time. Notice that we will only find physically relevant solutions once we specify","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"the appropriate boundary conditions for m=0 and m=M, forall t;\nthe initial values r(mt_0), dotr(mt_0), s(mt_0), X_i(mt_0), forall m;\na given equation of state and input (micro)physics.","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"DEF: A solution r(mt), P(tm), T(mt), L(mt), X_i(mt) for which all the above is satisfied is called a stellar model.","category":"page"},{"location":"8_SE_codes/#Initial-conditions-tt_0","page":"Stellar evolution models","title":"Initial conditions t=t_0","text":"","category":"section"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"By looking at the quantities that show time derivatives in the system of equations, we see that the radius r(mt) appears as first and second derivative with respect to time; specific entropy s(mt) (if you recast the time derivatives of P and T into -Tpartial spartial t) and mass fractions X_i(mt) appear as first derivatives with respect to time. Therefore, we need to know the initial values of r(mt_0), dotr(mt_0), s(mt_0), X_i(mt_0), forall m.","category":"page"},{"location":"8_SE_codes/#Boundary-conditions-m0,-mM","page":"Stellar evolution models","title":"Boundary conditions m=0, m=M","text":"","category":"section"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"We need to impose appropriate boundary conditions, which is non trivial: they have to be divided into conditions for the stellar centre, m=0, and for the stellar surface, m=M. The boundary conditions in the stellar core are quite simple while those for the stellar surface have to be related to observational quantities.","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"CORE   We can immediately determine two boundary conditions for the stellar center, i.e. r=0 since the density needs to be finite; l=0 since the energy sources as well need to stay finite. There are no conditions that we can impose to figure out the values for the central pressure P_C and the central temperature T_C.","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"SURFACE  ","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"As a first naive approach we could take the conditions P_mathrmsurf=0 and T_mathrmsurf=0 for m=M. This indeed expresses that P and T take very small values at the stellar surface in comparison with the values in the stellar interior, but in the end the temperature and the pressure at the stellar surface are not zero. A more realistic approach is to consider the photosphere as the surface of the star. The temperature in the photosphere is, to a good approximation, given by the effective temperature of the star. Therefore one could take as boundary conditions at the surface T_mathrmsurf=T_mathrmeff and P_mathrmsurf=P_mathrmph, where we are calling P_mathrmph the pressure at the photosphere.","category":"page"},{"location":"8_SE_codes/#Numerical-solution-of-the-equations","page":"Stellar evolution models","title":"Numerical solution of the equations","text":"","category":"section"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"We can now sketch the general idea behind the numerical algorithm used by stellar evolution codes to actually solve the system of equations of stellar evolution. ","category":"page"},{"location":"8_SE_codes/#Discretization","page":"Stellar evolution models","title":"Discretization","text":"","category":"section"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"The first step is to discretize the equations 1-5 by replacing the partial derivatives with finite differences, introducing a spatial finite precision, Delta mequiv m_i+1-m_i-1. We are dividing our star in K cells, with index i=1K each at mass coordinate m_i. Notice that, with our definition of Delta m, the center of each cell will have mass coordinate m_i, and the lower (upper) borders are at m_i-1 (m_i+1). Let us apply the discretization to the energy transport equation, Equ. 3:","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"dfracpartial Lpartial m=epsilon_mathrmnuc-c_Pdfracpartial Tpartial t+dfracdeltarhodfracpartial Ppartial thspace05cmrightarrow","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"dfracL_i+1-L_i-1m_i+1-m_i-1=leftepsilon_mathrmnucright_i-leftc_Pright_ileft(dfracT_i(t_0+Delta t)-T_i(t_0)Delta tright)+leftdfracdeltarhoright_ileft(dfracP_i(t_0+Delta t)-P_i(t_0)Delta tright)","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"where we introduced also a finite temporal resolution Delta t. The RHS of the equation has to be evaluated at the center of the cell, therefore the notation leftepsilon_mathrmnucright_i stands for evaluation at mass coordinate m_i. Let us now bring everything to the LHS of the equality sign and rewrite the equation Eq. 3 in a compact form:","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"f^3_i=0hspace05cmmathrmwith","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"f^3_iequivdfracL_i+1-L_i-1m_i+1-m_i-1+leftepsilon_mathrmnucright_i+leftc_Pright_ileft(dfracT_i(t_0+Delta t)-T_i(t_0)Delta tright)-leftdfracdeltarhoright_ileft(dfracP_i(t_0+Delta t)-P_i(t_0)Delta tright)","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"This is the discretized form of the energy transport equation holding for the cell of index i. We labeled the equation with an upper index 3 to symbolize that we are referring to Eq. 3 out of all the total I+4 equations of the system. ","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"NB It is key to notice that the above, cell-specific equation only depends on quantities related to the cell itself at mass coordinate m_i, and on those related to the cell immediately below (above), at mass coordinate m_i-1 (m_i+1). This is made explicit by writing the dependencies of f^3_i,","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"f^3_i=f^3_i(r_i-1rr_i+1X^l_i-1X^lX^l_i+1)","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"where we have indexed the isotope mass fractions X^l with an index l=1N.","category":"page"},{"location":"8_SE_codes/#Convergence","page":"Stellar evolution models","title":"Convergence","text":"","category":"section"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"These difference equations represent an approximation of the full differential equations, the accuracy of which can be improved by reducing Delta t and Delta m. A good approach is to choose m_i for each equation such, that all variables change by less than a predefined upper limit between points i+1 and i-1. Spatial convergence of the stellar model is achieved when the change in variables is reduced such that the numerical solution no longer depends on the Delta m. Similarly, temporal convergence is achieved when the change in the variables is reduced till independence on Delta t.","category":"page"},{"location":"8_SE_codes/#The-full-discretized-system","page":"Stellar evolution models","title":"The full discretized system","text":"","category":"section"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"If we now introduce the index j=1I+4 to label the different equations of stellar evolution, we can write the entire system 1-5 for the cell i in the compact form below:","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"f^j_i=0hspace1cmmathrmwithhspace05cmj=1I+4hspace05cmforall i=mathrmfixed","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"By labeling the independent unknowns of the system as x^1=rx^2=Px^3=Tx^4=Lx^l=1I=X^l=1I, we can also make explicit the dependencies of f_i^j in the following way:","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"f^j_i=f^j_i(x_i-1^1x_i^1x_i+1^1x_i-1^I+4x_i^I+4x_i+1^I+4)","category":"page"},{"location":"8_SE_codes/#Vector-notation","page":"Stellar evolution models","title":"Vector notation","text":"","category":"section"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"Let us now put everything together in a vector notation. Till now, we wrote all the equations keeping the cell i fixed. We can consider the entirety of cells, i=1K, and define the vector of unknowns vecx, which contains all the values assumed by the unknowns rPTLX^l at any cell i, namely:","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"vecx=(x_1^1x_1^2x_1^I+4x_K^1x_K^2x_K^I+4)hspace1cmmathrmwithhspace05cmi=1K","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"Analogously, we can define the vector of equations vecf, that act on each unknown element of vecx, at any cell i:","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"vecf=(f_1^1f_1^2f_1^I+4f_K^1f_K^2f_K^I+4)","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"The total number of components of the vector vecf is then (I+4)times K, and the system of I+4 equations per each cell i can be written this way","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"vecf(vecx)=vec0","category":"page"},{"location":"8_SE_codes/#Linearization","page":"Stellar evolution models","title":"Linearization","text":"","category":"section"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"The following step is the linearization of the system, to be able to solve it with a Newton-Raphson-like algorithm. We usually start from a guess of the solution, namely a vector vecx^*, that is not a perfect solution of the full system vecf(vecx)=vec0. In general, evaluating vecf(vecx^*), we will find that it is not equal to zero but to a correction vector vecb instead:","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"vecf(vecx^*)=vecb","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"We want to know how we can correct the initial guess vecx^* for it to be the exact solution vecx, i.e. we want to find a delta vecxequiv vecx-vecx^* such that vecf(vecx^*+delta vecx)=vec0. Let us expand this equality to the linear order:","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"vec0=vecf(vecx^*+delta vecx)simeq vecf(vecx^*)+Jvecfcdotdeltavecxhspace05cmLeftrightarrowhspace05cmJvecfcdotdeltavecx=-vecb","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"We called the Jacobian of vecf as J and substituted vecf(vecx^*)=vecb. ","category":"page"},{"location":"8_SE_codes/#L-D-U-Jacobian","page":"Stellar evolution models","title":"L-D-U Jacobian","text":"","category":"section"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"This Jacobian will have a very typical structure, that is called L-D-U because of the non-zero diagonal (D) blocks being surrounded by a lower (L) and upper (U) non-zero blocks, as a consequence of the discretized equations for the cell i, f^j_i, being dependent only on the upper (lower) cells i+1 (i-1). You can easily convince yourself about this by inspecting the following:","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"Jvecf= beginbmatrixD_1  U_1  0    0  L_1  D_2  U_2      0  L_2  D_3    0          U_K  0    0  L_K-1  D_K endbmatrix","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"D_2equiv beginbmatrixdfracpartial f_2^1partial x_2^1  dfracpartial f_2^1partial x_2^2    dfracpartial f_2^1partial x_2^I+4          dfracpartial f_2^I+4partial x_2^1  dfracpartial f_2^I+4partial x_2^2    dfracpartial f_2^I+4partial x_2^I+4 endbmatrix","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"U_2equivbeginbmatrixdfracpartial f_2^1partial x_3^1  dfracpartial f_2^1partial x_3^2    dfracpartial f_2^1partial x_3^I+4          dfracpartial f_2^I+4partial x_3^1  dfracpartial f_2^I+4partial x_3^2    dfracpartial f_2^I+4partial x_3^I+4 endbmatrix","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"L_2equiv beginbmatrixdfracpartial f_3^1partial x_2^1  dfracpartial f_3^1partial x_2^2    dfracpartial f_3^1partial x_2^I+4          dfracpartial f_3^I+4partial x_2^1  dfracpartial f_3^I+4partial x_2^2    dfracpartial f_3^I+4partial x_2^I+4 endbmatrix","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"Notice that every block D (or L, U) has dimensions (I+4)times(I+4). Also, we showed explicitly the blocks acting on cell i=2 for illustrative purposes; remember however that cells i=1 and i=K need to account for boundary conditions too.","category":"page"},{"location":"8_SE_codes/#Iterations","page":"Stellar evolution models","title":"Iterations","text":"","category":"section"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"When the determinant of this Jacobian is different than zero, the system can be solved for delta vecx. On their turn, the correction vector delta vecx will lead us to a second, better approximation of the solution, i.e. a vector vecx^**. However, since we only worked in the linear approximation and, moreover, numerical inaccuracies are always involved, we would still find that vecf(vecx^**)neq 0. Therefore we take a second iteration step and we determine new corrections deltavecx^**equiv vecx-vecx^** with the same method outlined above. The iterations keep going untill we reach the desired precision.","category":"page"},{"location":"8_SE_codes/","page":"Stellar evolution models","title":"Stellar evolution models","text":"NB There's no guarantee for the iteration procedure for improving the approximations  to always converge! In fact if the chosen approximation is too far from the solution, then the required corrections are so large that one cannot neglect the second-order terms, and the linearization is not appropriate anymore.","category":"page"},{"location":"11_questions/#Questions","page":"Questions","title":"Questions","text":"","category":"section"},{"location":"11_questions/#Preliminary-instructions","page":"Questions","title":"Preliminary instructions","text":"","category":"section"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"Usage of MESA has been covered on the first lab, so in this instance we will start right away with the computation of simulations. Detailed instructions on how to setup your simulations and what each simulation covers are described further down below. Download the input files from here inputfilesLAB2. You can then create a folder for your work from a terminal and uncompress the input files there:","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"# Create a new directory to run the lab\nmkdir MESA_LAB2\n# Move to the directory of your choice\ncd MESA_LAB2\n# Copy downloaded input files (you need to correct the path here)\ncp PATH_TO_INPUT_FILES/lab2_input.tar.xz .\n# Decompress the downloaded file\ntar -xf lab2_input.tar.xz","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"After uncompressing the input file, you will have four folders corresponding to each part of the lab. Within each of this folder there is a template for that part. We strongly recommend not modifying this template folder. Instead, copy the template for each simulation you run, for example you could copy and run the first template by doing (do not do this yet though, read through the instructions for the first part down below first):","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"cd part1_convergence\ncp -r part1_template first_run\ncd first_run\n# compile MESA\n./clean && ./mk\n# run MESA\n./rn","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"Where the exact name you give to the copied folder is your choice. To edit your inlists, from a work directory you can run (replacing gedit with a different editor if you prefer):","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"gedit inlist_project","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"For all parts of this lab, whenever you need to use the same template to run more than one simulation, you can adjust the options filename_for_profile_when_terminate, log_directory and Grid1_file_dir with unique names to identify your simulation.","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"🚨 ATTENTION 🚨   In the following, I am going to assume that you are in team number N, and your mass for the specific exercise considered is M=X_mathrmIM_odot in exercise mathrmI, M=X_mathrmIIM_odot in exercise mathrmIII, M=X_mathrmIIIM_odot in exercise mathrmIII and M=X_mathrmIVM_odot in exercise mathrmIV.","category":"page"},{"location":"11_questions/#I.-Convergence-testing-(4-points)","page":"Questions","title":"I. Convergence testing (4 points)","text":"","category":"section"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"Whenever we perform numerical simulations of continuous phenomena, we need to discretize both time and space. Although in the limit of infinite spatial and temporal resolution (and computers with infinite precision) we would expect our discrete model to match the continuous one, in practice we need to verify if the resolution used is appropriate for our work. This goes beyond stellar evolution simulations, and is a best practice for all types of numerical calculations that rely on discretization.","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"In the first part of this lab we will compute the main sequence evolution of a M=X_mathrmIM_odot star of metallicity Z=0.02 from ZAMS to TAMS, and evaluate the resulting mass of the helium core (contained in the output 'hecoremass' of your history file, but also listed as He_core in the terminal output). We want to verify if our choice of resolution gives us a converged result by increasing it and checking by how much our results changed.","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"A few notes on the inlist that is used in the template, to model stars from ZAMS, the following option is set in the star_job section of inlist_project:","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"&star_job\n   [...]\n   create_pre_main_sequence_model = .false.\n   [...]\n/","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"With this option MESA will make use of pre-computed ZAMS models to initiate the simulation, saving you a bit of time by avoiding the calculation of the pre main-sequence. Mesa has a large amount of options to compute spatial and temporal resolution, but also provides two convenient options to perform a global scaling of them. These are contained in the controls section of your inlist_project:","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"&controls\n   [...]\n    mesh_delta_coeff= 2d0\n    time_delta_coeff= 2d0\n   [...]\n/","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"The first of these options regulates the size of the grid, while the second regulates the size of the timesteps. The default value of these is one, and by setting both of these to two we will use bigger cells and take longer timesteps (thus, relaxing the resolution). Run this simulation a total of 4 times, with the values:","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"mesh_delta_coeff=2d0, time_delta_coeff=2d0\nmesh_delta_coeff=1d0, time_delta_coeff=1d0\nmesh_delta_coeff=0.5d0, time_delta_coeff=0.5d0\nmesh_delta_coeff=0.25d0, time_delta_coeff=0.25d0","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"This will represent a factor 8 in time and spatial resolution between the most and the least resolved simulation. With these simulations, answer the following questions for your report:","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"Does the resolution of your simulations behave as expected? Indicate the number of steps each simulation took, and see the number of zones by checking the num_zones column in your history file (you can take the value of the very last timestep).\nIf for a particular science case I would need to know the value of the helium core mass to a precision better than 1%, what choice of resolution option would you suggest? Of course we expect the highest resolution to be the most precise, but we want to balance simulation cost and precision. You can illustrate this by plotting the value of he_core_mass against the logarithm of the number of steps.","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"⏰ Time for the simulations: ~ 10mins in total ⏰","category":"page"},{"location":"11_questions/#II.-Pop-III-versus-Pop-I-stars-(4-points)","page":"Questions","title":"II. Pop III versus Pop I stars (4 points)","text":"","category":"section"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"The first stars formed right after the big bang are expected to be devoid of heavy elements, including carbon, nitrogen and oxygen. As we saw, these elements play an important role in nuclear burning for massive stars. The objective of this exercise is to study how such a star undergoes core hydrogen burning. This first generation of stars is referred to as Pop III stars, while the current generation to which the Sun belongs is Pop I (Pop II representing an intermediate generation). For the purpose of this lab we will model both a Z=0 and a Z=0.02 star with a mass of M=X_mathrmIIM_odot. In this particular case we want to include the pre main-sequence stage in order to see precisely how the star initiates core hydrogen burning, so we have in the star_job section of inlist_project:","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"&star_job\n   [...]\n   create_pre_main_sequence_model = .true.\n   [...]\n/","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"For the sake of speed, we will also use the most relaxed resolution choice from the previous problem. ","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"&controls\n   [...]\n    mesh_delta_coeff= 2d0\n    time_delta_coeff= 2d0\n   [...]\n/","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"This is done solely for the sake of quickly computing simulations, after seeing the results from the previous part you should be aware of the risks of unresolved models. Right now we ignore a potential lack of converged simulations, as our target is to illustrate different physical processes rather than provide very precise simulations.","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"The provided template comes ready to compute the evolution of a Z=002 star. To run the zero metallicity star, look up the options Zbase and initial_z and set them to zero. With these simulations answer the following questions:","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"What hydrogen burning process is dominant in the Z=0 star? Make a plot for each star showing the contribution of the pp, cno and triple alpha burning as a function of time and discuss. Hint: Massive stars are expected to produce most of their energy through the CNO cycle, so how can a massive star without CNO at the beginning of its evolution undergo the CNO cycle?\nCheck the radii of both stars at the TAMS. Is there a significant difference between them? What do you think is the main source of this difference?","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"⏰ Time for the simulations: ~ 2mins in total ⏰","category":"page"},{"location":"11_questions/#III.-White-dwarf-formation-(4-points)","page":"Questions","title":"III. White dwarf formation (4 points)","text":"","category":"section"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"For this problem we will model the evolution of an intermediate mass star (M=X_mathrmIIIM_odot in particular) until the formation of a compact remnant. You only need to run the provided template once as is! This simulation will take a while to complete so you can start running right away and then proceed to read the rest of this description. The star will go through multiple evolutionary phases which you can discuss with your classmates by checking the on-screen plots as the simulation runs. In particular for this run in order to save a bit of time by starting from ZAMS we also have","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"&star_job\n   [...]\n   create_pre_main_sequence_model = .false.\n   [...]\n/","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"A very important physical ingredient we include here are stellar winds, which are activated with the following options in the controls section of inlist_project:","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"&controls\n   [...]\n   cool_wind_full_on_T = 9.99d9 ! setting this to a high value ensures we always the cool wind prescriptions\n   hot_wind_full_on_T = 1d10\n   cool_wind_RGB_scheme = 'Reimers'\n   cool_wind_AGB_scheme = 'Blocker'\n   RGB_to_AGB_wind_switch = 1d-4\n   Reimers_scaling_factor = 1d0\n   Blocker_scaling_factor = 3d0 ! very strong AGB wind to go through TP-AGB quickly\n   [...]\n/","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"where we make use of the mass loss rate of [Reimers1975] for the RGB phase and that of [Bloecker1995] for the AGB phase (with an artificial boost of a factor of 3, meant to accelerate the calculation).","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"The terminating condition of this simulation is set as a minimum limit on luminosity, which will be reached as the star forms a white dwarf and cools:","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"&controls\n   [...]\n   log_L_lower_limit = -1\n   [...]\n/","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"This option is given in units of the solar luminosity, which implies the simulation will finish once the star has a luminosity below 01L_odot.","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"You might also notice a large set of options that look like this:","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":" ! relax tolerances for equations\n    use_gold_tolerances = .false.\n    use_gold2_tolerances = .false.\n    iter_for_resid_tol2 = 10\n    iter_for_resid_tol3 = 10\n    tol_residual_norm3 = 1d-4\n    tol_max_residual3 = 1d-2\n    solver_iters_timestep_limit = 15\n    convergence_ignore_equL_residuals = .true.\n    limit_for_rel_error_in_energy_conservation = 1d99\n    hard_limit_for_rel_error_in_energy_conservation = 1d99\n    corr_coeff_limit = 1d-1\n    max_abs_rel_run_E_err = -1d0\n    ignore_too_large_correction = .true.\n    scale_max_correction = 0.1d0\n    ignore_min_corr_coeff_for_scale_max_correction = .true.\n    ignore_species_in_max_correction = .true.\n    use_superad_reduction = .true. ! this is to help evolution from post-AGB to white dwarf","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"these are purely numerical adjustments for the calculations in order to optimize the runtime of the simulation for the purpose of a lab. In reality you want to avoid relaxing the tolerance to which solutions are computed!","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"Using your simulation, answer the following questions:","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"Through what evolutionary phases does this star go? What type of white dwarf is formed at the end? Accompany your discussion with an HR diagram, highlighting precisely some key evolutionary points and referring to them in your discussion. Take particular care in describing how helium is ignited.\nAlthough no nuclear burning takes place in the outermost regions of the star, you will find the surface abundances of some heavy elements change significantly before any significant mass loss happens. What is the cause of this change?","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"⏰ Time for the simulation: ~ 20mins in total ⏰","category":"page"},{"location":"11_questions/#IV.-Iron-core-collapse-(4-points)","page":"Questions","title":"IV. Iron-core collapse (4 points)","text":"","category":"section"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"For the last part of this lab, we will perform a simulation of an M=X_mathrmIVM_odot star that undergoes iron-core collapse. Just as with the previous part, this simulation is already setup for you to run it, so you can start it up and then proceed to read the rest of this description.","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"Barring small variations of numerical aspects to make the run faster for the lab, there are three important details in inlist_project that relate to the physics of the problem. The first one is the following in the star_job section of inlist_project:","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"&star_job\n   [...]\n   change_v_flag = .true.\n   new_v_flag = .true.\n   [...]\n/","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"Setting both of these to true will add the velocity as another solver variable inside MESA. By default MESA solves the hydrostatic version of the equations, so any velocity it registers just corresponds to changes in radii along stages of almost perfect hydrostatic balance. However, if we want to capture iron-core collapse, we need to include hydrodynamics in our simulation, which is precisely what the above option does.","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"The next important ingredient is our termination condition for the simulation. In this case we set a threshold on the velocity at which any point within the iron-core is infalling,","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"&controls\n   [...]\n   fe_core_infall_limit = 5d7 ! infall velocity at cm/s\n   [...]\n/","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"which corresponds to a velocity of 500mathrmkms^-1. Finally, we include a different choice of mass loss rates that is more appropriate for massive star evolution:","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"&controls\n   [...]\n   cool_wind_full_on_T = 0.8d4\n   hot_wind_full_on_T = 1.2d4\n   cool_wind_RGB_scheme = 'Dutch'\n   cool_wind_AGB_scheme = 'Dutch'\n   hot_wind_scheme = 'Dutch'\n   Dutch_wind_lowT_scheme = 'de Jager'\n   Dutch_scaling_factor = 1.0  \n   [...]\n/","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"The Dutch prescription from MESA combines multiple prescriptions for mass loss from mostly Dutch authors, including those of [deJager1988], [NugisLamers2000] and [Vink2001]. A very important thing to keep in mind regarding mass loss rates in stellar evolution calculations is that they are based off prescriptions provided by other authors who have either determined them empirically or through dynamical modelling of stellar atmospheres, which is beyond the capabilities of MESA.","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"With your simulation completed, answer the following questions for your report:","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"How does the onset of helium burning differ from the 2 Msun star modelled in the previous part?\nDetermine the time between the end of each burning phase (H, He, C, Ne, O, Si, core collapse). Compare it to the main-sequence lifetime.\nAt the end of your simulation, check the iron core-mass (fecoremass in your history file). Is there a relevance to that value?\nFrom the profile at the end of your simulation plot the helium abundance across the entire star. Can you explain what is happening at the core?","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"⏰ Time for the simulations: ~ 25mins in total ⏰","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"[Reimers1975]: Memoires of the Societe Royale des Sciences de Liege, Volume 8, pp. 369-382 (1975). https://ui.adsabs.harvard.edu/abs/1975MSRSL...8..369R/abstract","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"[Bloecker1995]: Astronomy and Astrophysics, Volume 297, pp. 727 (1995). https://ui.adsabs.harvard.edu/abs/1995A%26A...297..727B/abstract","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"[deJager1988]: Astronomy and Astrophysics, Suppl. Ser., Vol. 72, p. 259-289 (1988). https://ui.adsabs.harvard.edu/abs/1988A%26AS...72..259D/abstract","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"[NugisLamers2000]: Astronomy and Astrophysics, Vol. 360, p.227-244 (2000). https://ui.adsabs.harvard.edu/abs/2000A&A...360..227N","category":"page"},{"location":"11_questions/","page":"Questions","title":"Questions","text":"[Vink2001]: Astronomy and Astrophysics, v.369, p.574-588 (2001). https://ui.adsabs.harvard.edu/abs/2001A%26A...369..574V/abstract","category":"page"},{"location":"5_radiative/#Radiative-energy-transport","page":"Notes","title":"Radiative energy transport","text":"","category":"section"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"Goals:","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"What is opacity?\nPlanck's law and energy density\nBasics of diffusion\nRadiative temperature gradient","category":"page"},{"location":"5_radiative/#What-is-opacity?","page":"Notes","title":"What is opacity?","text":"","category":"section"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"One form in which energy is transported in stellar interiors is through radiation. However, most of the star is opaque, and photons can only travel short distances before being scattered or absorbed. The \"opaqueness\" of stellar matter can be described by the opacity kappa, which has units of","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"kappa=mathrmcm^2g^-1","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"where brackets denote the units of what is inside.","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"So what is opacity? Let's start by thinking of a medium with particles of mass m, which interact with passing radiation. We will consider each particle acts as a disk of area sigma (its cross section), and that all radiation is absorbed when it hits a particle. We can now consider a thin slab of material as follows:","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"(Image: asdf)","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"The total number of particles in the slab is","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"dN = fracrhommathrmdxmathrmdymathrmdz","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"which means that the probability of a photon going through the slab and crashing with a particle is","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"P_mathrmcoll=fracsigma mathrmdNmathrmdxmathrmdy=fracsigma rhommathrmdz","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"From here we have the term","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"leftfracsigmamright=mathrmcm^2g^-1","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"which has the units of opacity. Indeed, opacity can be described as a cross section per unit mass, and for this specific example we take","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"kappaequiv fracsigmamrightarrow P_mathrmcoll=kapparhomathrmdz","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"Now let's see how flux changes as it goes through the slab:","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"(Image: asdf)","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"Absent any emission from the slab itself, the difference between the fluxes at the faces is just","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"F(z)-F(z+mathrmdz)=F(z)P_mathrmcoll=F(z)kapparhomathrmdz","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"and approximating the different in flux with a partial derivative gives us a differential equation for the flux,","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"fracmathrmdFmathrmdz = kapparho F(z)","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"For a constant kapparho, the solution to this differential equation corresponds to exponential decay,","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"F(z)=F(z_0)e^-kapparho(z-z_0)","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"where z_0 is a reference point. From here we have two important concepts:","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"The factor kapparho in the exponential has units\nkapparho=mathrmcm^-1\nso we can define a mean free path for photons as\ndisplaystyle l_mathrmf=frac1kapparho\nThis corresponds to the typical distance travelled by a photon before colliding.\nIf we also consider radiation travelling a distance d through a medium, we can define a dimensionless optical depth tau as\ntau = fracdl_mathrmf=kapparho d\nThe optical depth then represents the number of mean free paths covered by d. In practice kapparho varies through a medium, so instead one uses\ndtau = kapparho mathrmdz\nFor a star, the optical depth normally refers to the value integrated from an infinite distance all the way to its surface,\ntau(r) = int_r^infty kapparho mathrmdr\nand as we will see later, a usual definition of a stars surface, its photosphere, is taken to be at tau=23.","category":"page"},{"location":"5_radiative/#Planck's-law","page":"Notes","title":"Planck's law","text":"","category":"section"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"Let's consider radiation is in local thermodynamical equilibrium with the gas at a temperature T. Then its energy flux per unit frequency and solid angle is:","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"B_nu (nuT)=frac2hnu^3c^2frac1displaystyle expleft(frachnuk_mathrmBTright)-1","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"What does this imply for the distribution of momenta? Remember that we defined the distribution f(p) in terms of the number of particles per unit volume and unit momentum.","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"We take an area element mathrmdA, and photons crossing it with a momentum covering a solid angle mathrmdOmega around the perpendicular direction,","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"(Image: asdf)","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"In a time mathrmdt, the number of photons crossing mathrmdA with directions contained in mathrmdOmega is","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"mathrmdN=f(p)cmathrmdtmathrmdAfracmathrmdOmega4pimathrmdptag41","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"where we used the velocity of the photons being the speed of light c and took an isotropic f(p).","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"Each individual photon carries an energy hnu, so the energy corresponding to mathrmdN is","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"mathrmdE=hnu mathrmdNtag42","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"Similarly, the momentum of each photon is","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"p=frachnucrightarrow mathrmdp=frachcmathrmdnutag43","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"Combining equations (41), (42) and (43) we find that","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"fracmathrmdEhnu=f(p)cmathrmdtmathrmdAfracmathrmdOmega4pifrachmathrmdnuc","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"rightarrow fracmathrmdEmathrmdtmathrmdAmathrmdOmegamathrmdnu=B_nu = frach^2 nu4pif(p)","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"We can also define the distribution per unit frequency,","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"f(p)mathrmdp=f(nu)mathrmdnu rightarrow boxedf(nu)=frac4pihcnuB_nutag44","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"We can use the same expressions as last class to describe the contribution of radiation to energy density. Expressing the energy density per unit frequency and unit volume we have","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"U_nu = f(nu)hnu = frac4picB_nu","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"Similarly, we can describe the flux crossing in one direction of a surface,","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"F=int_0^2piint_0^pi2int_0^infty costhetasintheta B_nu mathrmdnu mathrmdtheta mathrmdphi","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"which has an analytical solution,","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"F=sigma T^4quad sigma=frac2pi^5 k_B^415h^3c^2","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"The constant sigma is known as the Stefan-Boltzmann constant. Pressure can be found to be equal to","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"P_mathrmrad=fraca3T^4quad a=frac4sigmac","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"where a is known as the radiation constant.","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"Finally, the total energy density (per unit volume) is","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"U=aT^4 tag45","category":"page"},{"location":"5_radiative/#Basics-of-diffusion","page":"Notes","title":"Basics of diffusion","text":"","category":"section"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"If we consider a medium with a density of a particular quantity U (per unit volume), moving with a velocity v and a mean free path l_mathrmf, then the flux of that property is","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"vecF=-Dnabla Uquad D=fracvl_mathrmf3tag46","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"where we have defined the diffusion coefficient D which has units","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"D=mathrmcm^2s^-1","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"In practice we have multiple velocities and mean free paths, so one would generally use an average langle vl_mathrmf rangle.","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"The flux described by equation (46) needs not just be energy, it can also describe a flux of particles of different types. Now, we will not formally derive (4.6), but we will provide a 1-D analogue. Consider motion only happens in the +x or -x direction. We then take an are mathrmdA separating two regions of length equal to l_mathrmf,","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"(Image: asdf)","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"We approximate the particle density at each side as n_-x and n_+x with","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"fracmathrmdnmathrmdx = fracn_+x-n_-xl_mathrmf","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"Each box contains a certain amount of particles,","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"mathrmdN_-x=n_-xmathrmdAl_mathrmfmathrmdN_+x=n_+xmathrmdAl_mathrmf","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"If we take all particles to move with a velocity v in either the +x or -x direction (with equal probability), then in a time l_mathrmfv half of the particles from each box will cross the interface, resulting in a flux","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"F_x=frac(mathrmdN_-x-mathrmdN_+x)2mathrmdAfracvl_mathrmf","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"F_x = -fracvl_mathrmf2fracmathrmdnmathrmdx","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"Comparing to equation (46), the diffusion coefficient has an incorrect prefactor, as we have ignored the actual isotropic direction of the velocities, as well as that particles coming from larger distances originated from regions of different densities.","category":"page"},{"location":"5_radiative/#Radiative-temperature-gradient","page":"Notes","title":"Radiative temperature gradient","text":"","category":"section"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"Now let us consider the flux coming from photon diffusion. For now we ignore frequency dependency and take all photons to have the same l_mathrmf,","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"l_mathrmf=frac1kapparho","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"Assuming radial symmetry, equations (45) and (46) give","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"F_r = left-fracc3kapparhofracpartial Upartial r = -frac4acT^33kapparhofracpartial Tpartial rquadright4pi r^2cdot tag47","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"L = -frac16 pi r^2 acT^33kapparhofracpartial Tpartial r","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"rightarrow boxedfracpartial Tpartial r=-frac3kappa rho L16pi r^2 a c T^3tag48","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"Whenever energy transport happens through radiation, this equation describes the temperature gradient required. In cases where other mechanisms transport energy, equation (4.8) describes the radiative luminosity L_mathrmrad rather than the total one.","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"One generally transforms equation (4.8) into a pressure derivative by using the equation of hydrostatic equilibrium,","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"fracpartial Ppartial r = -rhofracGmr^2","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"from which we get","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"leftfracpartial Tpartial P=fracpartial Tpartial rleft(-fracr^2rho G mright) = frac3kappa L16pi ac G T^3 mquadright fracPTcdot","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"boxednabla_mathrmradequivfracpartial ln Tpartial ln P=frac316pi a c Gfrackappa L Pm T^4tag49","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"The quantity nabla_mathrmrad will be particularly important in our discussion of convection in the next class.","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"In reality we need to consider that opacity is a function of frequency. In that case we use instead (44) and (46) to describe the flux per unit frequency,","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"vecF=-D_nu nabla U_nuquad D_nu = fracc3kappa_nu rho","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"The resulting radial flux per unit frequency can be integrated over frequency to obtain","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"nabla_mathrmrad=frac316pi a c Gfrackappa_mathrmR L Pm T^4","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"where kappa_mathrmR is the Rosseland mean opacity","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"frac1kappa_mathrmRequiv fracpiacT^3int_0^inftyfrac1kappa_nufracpartial B_nupartial Tmathrmdnu","category":"page"},{"location":"5_radiative/#Conduction","page":"Notes","title":"Conduction","text":"","category":"section"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"We can also consider conduction in Equation (47). The flux can be taken to be proportional to the temperature gradient, with two contributions given by conduction coefficients for radiative energy transport and one for actual particle conduction:","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"vecF=(k_mathrmrad+k_mathrmcd)nabla T","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"where","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"k_mathrmrad=frac4ac3fracT^3kappa_mathrmradrho","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"The conduction coefficient kappa_mathrmcd is determined by the energy density of the particles, their velocity, and their internal energy density,","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"k_mathrmcd=fraclv3fracpartial Upartial T","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"It is common to define a conductive opacity kappa_mathrmcd as","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"k_mathrmcd=frac4ac3fracT^3kappa_mathrmcdrho","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"From which we can use the same expression for the temperature gradient (49) but with the opacity replaced with","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"frac1kappa=frac1kappa_mathrmR+frac1kappa_mathrmcd","category":"page"},{"location":"5_radiative/","page":"Notes","title":"Notes","text":"In this sense the lowest opacity, indicating more transparency, dominates.","category":"page"},{"location":"1_introduction_julia/#Julia-setup","page":"Julia setup","title":"Julia setup","text":"","category":"section"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"This class will include computational examples that are programmed in the julia programming language. Julia is a JIT (just-in-time) language which allows to write very fast code (very close to the performance of compiled languages like C and Fortran), while still having the simplicity of an interpreted language like python. Each of the examples included in this website can be downloaded as jupyter notebooks. The instructions below explain how to run these notebooks both in Linux and Windows systems.","category":"page"},{"location":"1_introduction_julia/#Linux","page":"Julia setup","title":"Linux","text":"","category":"section"},{"location":"1_introduction_julia/#Download-Julia","page":"Julia setup","title":"Download Julia","text":"","category":"section"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"Get the version of julia that matches your system from the downloads page. Below instructions assume that:","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"The version you downloaded is julia-1.9.3-linux-x86_64.tar.gz\nIt was downloaded to your home folder, which should be something like /home/USERNAME.","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"You will need to adapt the commands below if that is not the case.","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"In a terminal, uncompress the file that has been downloaded by running the following commands:","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"# Move to the home directory\ncd ~\n# Uncompress the .tar.gz\ntar zxvf julia-1.9.3-linux-x86_64.tar.gz","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"This will create a folder called julia-1.9.3 in /home/USERNAME. You can find your executable in /home/USERNAME/julia-1.9.3/bin/julia.","category":"page"},{"location":"1_introduction_julia/#Setup-Julia","page":"Julia setup","title":"Setup Julia","text":"","category":"section"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"Julia can be started by running the executable, however using the full path to it is cumbersome. We can instead create an alias that will let us run the executable faster. This can be done by editing (or creating if it does not exist) the .bashrc file, which containts a set of commands that are run at the start of each terminal session. To edit the .bashrc file, I am going to use the nano text editor, but you can use your favorite text editor.","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"# Open the .bashrc file\nnano ~/.bashrc","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"Copy and paste the following line at the bottom of the file:","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"alias julia=/home/USERNAME/julia-1.9.3/bin/julia","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"To save changes and exit from nano, you'll have to press ctrl+X , then Y to accept to save the modified buffer and then enter. Now, everytime you'll open a shell, you'll be able to call Julia by simply typing in a terminal","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"#Open Julia\njulia","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"Try it and see the greeting message 😁","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"(Image: )","category":"page"},{"location":"1_introduction_julia/#Setup-the-Julia-notebook","page":"Julia setup","title":"Setup the Julia notebook","text":"","category":"section"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"We want to get the Julia notebook now, to be able to execute an .ipynb file. It is also recommended to create a unique environment for each julia project you work with, this lets you install specific dependencies for different projects, avoid conflicts, and make your calculations reproducible (this is similar to conda environments in case you're familiar with those). Within Julia, type the following in your terminal:","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"# Open up the package manager\n]\n# create a local environment\nactivate .\n# Install the Julia notebook package\nadd IJulia","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"The installation of the notebook should take a few minutes. At the end, press ctrl+C to go out of the package manager. Within Julia, type","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"# Declare that you'll use the Julia notebook package\nusing IJulia\n# Call the Julia notebook package\nnotebook()","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"If you're asked to install Jupyter via Conda, accept by pressing Y+enter. This should get you Jupyter notebook, the web-based computing platform that will run your Julia notebooks in your favorite browser. This installation should also take a few minutes.","category":"page"},{"location":"1_introduction_julia/#Open-up-your-notebook","page":"Julia setup","title":"Open up your notebook","text":"","category":"section"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"Once Jupyter is launched, you should see a window popping up in your favorite browser. That window is going to show you an interactive platform that lists all your files in your HOME_DIR. Something like this:","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"(Image: )","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"At this point, you just need to find the .ipynb file you downloaded into your favorite directory in the first step. Open it, and the game is done ✅","category":"page"},{"location":"1_introduction_julia/#Windows","page":"Julia setup","title":"Windows","text":"","category":"section"},{"location":"1_introduction_julia/#Download-Julia-2","page":"Julia setup","title":"Download Julia","text":"","category":"section"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"Get the version of julia that matches your system from the downloads page. Below instructions assume that the version you downloaded is julia-1.9.3-win64.exe. You will need to adapt the commands below if that is not the case.","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"Run the installer you just downloaded, by double clicking on the executable and giving permissions to install Julia in the suggested installation directory. Be sure to check the box asking you to \"Add Julia to path\", because it will automatically add Julia to Environment Variables of your system! See screenshot below:","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"(Image: )","category":"page"},{"location":"1_introduction_julia/#Open-up-Julia","page":"Julia setup","title":"Open up Julia","text":"","category":"section"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"To open Julia we need to open a terminal, a command-line interface to communicate directly with your computer. To do so in your Windows machine, you'll need to press the shortcut Windows+R to launch the \"Run\" box; afterwards, type “cmd” and then click “OK” to open the Command Prompt (see screenshot below).  Invoke Julia by simply typing julia and see the greeting message 😁 ","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"# Open Julia\njulia","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"(Image: )","category":"page"},{"location":"1_introduction_julia/#Setup-the-Julia-notebook-2","page":"Julia setup","title":"Setup the Julia notebook","text":"","category":"section"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"Once Julia is open and welcomes you, the steps to get the Julia notebook are more or less the same as you would do in Linux. Just as with linux, it is recommended to use individual environments for each project you have. Within Julia, type the following in your terminal:","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"# Open up the package manager\n]\n# create a local environment\nactivate .\n# Install the Julia notebook package\nadd IJulia","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"The installation of the notebook should take a few minutes. At the end, press ctrl+C to go out of the package manager. Within Julia, type","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"# Declare that you'll use the Julia notebook package\nusing IJulia\n# Call the Julia notebook package\nnotebook()","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"If you are asked to install Jupyter via Conda, accept by pressing Y+enter. This should get you Jupyter notebook, the web-based computing platform that will run your Julia notebooks in your favorite browser. This installation should also take a few minutes.","category":"page"},{"location":"1_introduction_julia/#Open-up-your-notebook-2","page":"Julia setup","title":"Open up your notebook","text":"","category":"section"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"Once Jupyter is launched, you should see a window popping up in your favorite browser. That window is going to show you a file explorer. Something like this:","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"(Image: )","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"At this point, you just need to find the .ipynb file you downloaded into your favorite directory in the first step. Open it, and the game is done ✅","category":"page"},{"location":"1_introduction_julia/#Julia-Basics","page":"Julia setup","title":"Julia Basics","text":"","category":"section"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"All computational examples will be shown using the julia programming language, but the code provided can be easily translated to other languages such as python. The main benefit of julia is that it is a language that is simple to write but can still have a performance comparable to traditional compiled languages. A good overview of the language can be found in the official manual, but below we show some of the basic functionality that you will need to use.","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"First of all, we illustrate the basic usage of julia. A normal thing you will do at the beginning of any notebook or program is to include packages. Our life is made significantly easier by people who provide these packages! To do this, one makes use of the using keyword. Below we include the packages we will be using in this example.","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"using DataFrames     # Used to deal with tabular data\nusing Plots          # Provides a multitude of plotting routines\nusing CSV            # Efficient reading of files in \"comma separated values\" format\nusing LaTeXStrings   # Makes it easy to write LaTeX strings","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"Whenever you work on a fresh environment you will find the above code fails, as the packages are not installed. As described in the error message you can correct this by running (in a different cell) import Pkg; Pkg.add(\"DataFrames\"), and similarly for the other packages. Once this is done for a package, it will remain installed in your environment, and you don't need to use Pkg.add again (it is safe to erase the cells with that command).","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"The syntax of julia should be familiar to those with a python background. Assigning numerical variables and performing arithmetic operations on them is straightforward.","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"a = 2.0\nb = pi # the definition of pi is included by default\n\nc = a+b # addition\nd = b^a # exponentiation\ne = sin(b) # basic mathematical functions are also defined in the language, no need to include a package\n\nprint(\"c=$(c), b=$(d), c=$(e)\") # $() notation is used to read the value in parenthesis into the string","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"β=1;  # Using ';' at the end of a line will hide its output","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"You also have access to basic keywords for control flow, including if blocks and for loops. Here some small notational variations arise with respect to python. Blocks of code are not defined by indentation but by the use of the end keyword.","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"a = 1\nb = 3\n\nif a < 2 && b < 2   # && stands for 'and'\n    print(\"if was successful\")\nelseif a < 2 || b < 2   # || stands for 'or'\n    print(\"elseif was successful\")\nelse\n    printf(\"Neither if or elseif were successful\")\nend\nprint(\"\\n\") # print a line break\n\n# Add up all digits between 1 and 10 using a for loop\nsumnumbers = 0\nfor i in 1:10\n   global sumnumbers = sumnumbers+i # global keyword is to refer to scope outside of for loop\nend\nprint(\"Adding all numbers between 1 and 10 gives us $(sumnumbers)\")","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"We can also define functions using the function keyword.","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"function add1(x)\n    return x+1\nend\n\nadd1(1)","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"We often deal not just with scalars but also vectors or matrices. We can define a vector covering a range of values using the LinRange function.","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"xvals = LinRange(-5.0,5.0,11) # Create a vector with elements from -5.0 to 5.0 with 11 elements.","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"Contrary to python, arrays in julia start at position 1, so if you attempt to access xvals[0] you will get an error.","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"Beware that many operations on vectors will not work as you might naively expect. If you try computing xvals^2, an error will be thrown as the ^ operation is not defined between a vector and an integer. You could think that the above operation is ambiguous, do we mean that we want to take the square of each element of the vector or instead that we want to take the dot product of xvals with itself? To explicitly state that an operation is meant to be done element by element, one can use a . before the operation. Further information on this notation can be found here.","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"xvals.^2","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"This can be done with any function. For instance the code below will apply our add1 function to each element of the array.","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"add1.(xvals)","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"Finally, the Plots package allows us to easily make different kinds of plots. The example below shows a (sparsely) sampled plot of sine and cosine. The plot can be created by calling the plot(...) function, while things are added to it by calling the plot!() function. Using ! as part of a function name is part of the style guide of julia to identify functions which modify their arguments. For example, the sort(x) function will return a copy of the vector x which is sorted, while sort!(x) will modify the vector x into a sorted version of itself (known as in place sorting).","category":"page"},{"location":"1_introduction_julia/","page":"Julia setup","title":"Julia setup","text":"yvals = sin.(xvals)\nyvals2 = cos.(xvals)\n# The LaTeX strings package allows us to write LaTeX without needing to escape backslashes\n# (i.e., we can write L\"\\sin(x)\" instead of \"$\\\\sin(x)$\").\nplot(xlabel=L\"$x$\", ylabel=L\"$y$\") \nplot!(xvals, yvals, label=L\"$\\sin(x)$\")\nplot!(xvals, yvals2, label=L\"$\\cos(x)$\",linestyle=:dash)","category":"page"},{"location":"5_radiative_problems/#Exercises","page":"Exercises","title":"Exercises","text":"","category":"section"},{"location":"5_radiative_problems/#List-of-exercises","page":"Exercises","title":"List of exercises","text":"","category":"section"},{"location":"5_radiative_problems/#1:-The-Eddington-limit","page":"Exercises","title":"1: The Eddington limit","text":"","category":"section"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"The pressure in a gas with radiation can be divided in its contributions from each component,","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"P=P_mathrmgas + P_mathrmradquad P_mathrmrad=fracaT^43","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"The equation of hydrostatic equilibrium can then be expressed as","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"fracpartial P_mathrmgaspartial r + fracpartial P_mathrmradpartial r = -fracGmrhor^2","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"Using this, find the value of the luminosity for which the radiation pressure would overcome the gravitational force. For this purpose use the expression for the temperature gradient under the assumption that all energy is transported by radiation,","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"fracd Tdr=frac-316 pi a cfrackappa rho lr^2 T^3","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"This luminosity is known as the Eddington luminosity L_mathrmedd, and you should find that","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"L_mathrmedd = frac4pi G m ckappa","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"What is the Eddington luminosity of the Sun in units of the solar luminosity L_odotsim 4times 10^33mathrmergs^-1? For the other constants use Gsim 7times 10^-8mathrmcm^3g^-1s^-2, csim 3times 10^10mathrmcms^-1,, M_odotsim 2times 10^33 mathrmg and approximate the opacity with the electron scattering opacity kappa_mathrmessim 02(1+X)mathrmcm^2g^-1.","category":"page"},{"location":"5_radiative_problems/#2:-Black-hole-accretion","page":"Exercises","title":"2: Black hole accretion","text":"","category":"section"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"Let us do something more exotic. Consider a black hole which accretes an amount Delta m of mass. Under the right conditions, a lot of energy can be produced in this way, releasing a significant fraction of the rest mass energy eta Delta m c^2, where etasim 01 depends on the black hole spin. If a black hole accretes mass at a rate dotM_mathrmacc then it has a corresponding luminosity L_mathrmacc=dotM_mathrmacceta c^2. Find an expression for the critical value of dotM_mathrmacc at which the luminosity released from accretion matches the Eddington luminosity. This is known as the Eddington limit for the accretion rate dotM_mathrmEdd, and beyond this limit accretion into the black hole is suppresed. How long would it take for a 10 M_odot black hole to grow into a supermassive 10^9M_odot black hole while accreting at this rate?","category":"page"},{"location":"5_radiative_problems/#3:-Conductive-opacity","page":"Exercises","title":"3: Conductive opacity","text":"","category":"section"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"Estimate the conduction coefficient k_mathrmcd=(l v3) dUdT for electrons in an ideal hydrogen gas. To do this, consider the internal energy per unit volume of the electrons","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"U sim fracrhom_ukT","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"and their characteristic velocity v_esim sqrtkTm_e. Estimate the mean free path l by computing an effective cross section sigma for scattering of the electrons by free protons. This can be done by defining a characteristic impact parameter b that satisfies","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"m_e v_e^2 = frack_mathrmC e^2b","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"where k_mathrmC is the Coulomb constant and e is the electron charge. The cross section can then be estimated as sigma sim pi b^2 and the mean free path as lsim m_u(sigma rho)^-1.","category":"page"},{"location":"5_radiative_problems/#4:-Conductive-versus-radiative-transport-at-the-core-of-the-Sun","page":"Exercises","title":"4: Conductive versus radiative transport at the core of the Sun","text":"","category":"section"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"Let us estimate the relative contributions of radiative and conductive energy transport at the core of the Sun, by comparing their corresponding opacities. The conductive opacity can be determined from the conduction coefficient using","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"kappa_mathrmcd = frac4 a c T^33 k_mathrmcdrho","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"and from the previous exercise you should have found","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"k_mathrmcd sim frack_B^72T^52pi m_e^12k_C^2 e^4","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"and the central density and temperature of the Sun are","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"rho_mathrmcodotsim 10^2mathrmgcm^-3quad T_mathrmcodotsim 10^7mathrmK","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"Compare kappa_mathrmcd to the electron scattering opacity for radiation kappa_mathrmes=02(1+X)mathrmcm^2g^-1","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"Some constant that you will need to use are:","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"the electron mass m_esim 10^-27mathrmg\nthe Boltzmann constant k_mathrmBsim 10^-16mathrmcm^2gs^-2K^-1\nthe speed of light csim 3times 10^10mathrmcms^-1\nthe radiation constant asim10^-14mathrmergcm^-3K^-4\nThe Coulomb constant times the square of the electric charge, k_Ce^2sim 2times 10^-19mathrmcm^3 g s^-2","category":"page"},{"location":"5_radiative_problems/#Solutions","page":"Exercises","title":"Solutions","text":"","category":"section"},{"location":"5_radiative_problems/#1:-The-Eddington-limit-2","page":"Exercises","title":"1: The Eddington limit","text":"","category":"section"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"We want to find the value of l that satisfies","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"fracpartial P_mathrmradpartial r=frac4aT^33fracpartial Tpartial r=-fracGm rhor^2","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"Replacing partial Tpartial r with the expression for the radiative temperature gradient, and calling l=L_mathrmedd, we obtain","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"-frackappa rho L_mathrmEdd4pi c r^2=fracGmrhor^2","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"From this we can compute L_mathrmEdd, giving us for the Sun a value of sim 4times 10^4 L_odot. Luckily our Sun is not close to being torn by its own radiation!","category":"page"},{"location":"5_radiative_problems/#2:-Black-hole-accretion-2","page":"Exercises","title":"2: Black hole accretion","text":"","category":"section"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"From the previous exercise we have that","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"L_mathrmedd sim 4times 10^4 L_odotleft(fracMM_odotright)","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"The eddington accretion rate is then found to be","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"dotM_mathrmEdd=fracL_mathrmEddeta c^2sim 2times 10^-8left(fracMM_odotright) mathrmM_odot yr^-1","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"If a black hole accretes at this limiting rate, its mass as a function of time is given by the differential equation","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"dot M =dotM_mathrmEdd= Ctimes Mquad Csim 2times 10^-8 mathrmyr^-1","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"Growth is then exponential, with","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"M(t) = M_0 e^Ct","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"If we require a black hole to grow from 10M_odot to 10^9 M_odot, we need a time T given by e^CT=10^8, resulting in Tsim 1mathrmGyr. One then needs to accrete constantly at this limiting rate to reach the masses of some supermassive black holes observed when the universe was just one gigayear old. ","category":"page"},{"location":"5_radiative_problems/#3:-Conductive-opacity-2","page":"Exercises","title":"3: Conductive opacity","text":"","category":"section"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"We have that","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"k_mathrmcd sim l v fracdUdT","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"Replacing with","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"fracdUdTsim frack_B rhom_uquad vsimsqrtfrackTm_equad sigma sim left(frack_C e^2m_e v^2right)^2","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"we find that","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"k_mathrmcd sim frack_B^72T^52pi m_e^12k_C^2 e^4","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"The steep dependence with temperature comes from the increased velocity, which not only leads to a faster spread of the diffusing particles but also to a lower effective cross section.","category":"page"},{"location":"5_radiative_problems/#Conductive-versus-radiative-transport-at-the-core-of-the-Sun","page":"Exercises","title":"Conductive versus radiative transport at the core of the Sun","text":"","category":"section"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"The result for kappa_mathrmcd at the Solar core comes simply from evaluating the given expression,","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"kappa_mathrmcdsim 7000mathrmcm^-2g","category":"page"},{"location":"5_radiative_problems/","page":"Exercises","title":"Exercises","text":"This is of the order 10^3 larger than the radiative opacity. As the contributions to the luminosity are inversely proportional to opacity, we find that conductive energy transport just accounts for a very small fraction ( 01) of the total flux near the core of the Sun.","category":"page"},{"location":"8_questions/#Questions","page":"Questions","title":"Questions","text":"","category":"section"},{"location":"8_questions/#Preliminary-instructions","page":"Questions","title":"Preliminary instructions","text":"","category":"section"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"Download the input files from here inputfilesLAB1. After decompressing your download, put the content in the MESA_LAB1 directory:","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"# Move to the directory of your choice\ncd MESA_LAB1\n# Decompress the downloaded file\ntar -xf lab1_input.tar.xz\n# Copy all the input files and put them in place of the ones already present in the MESA_LAB1 folder\ncp -R ./lab1_input/* .","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"Consult the table of masses and find your team number. In the pair of assigned masses, pick your mass M and put it as initial condition for your simulation. To do so, open your inlist_project file and edit it as follows, assuming that your mass for the simulation 1 is M=XM_odot:","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"\n&star_job\n    [...]\n    ! save a model at the end of the run\n        save_model_when_terminate = .false.\n        save_model_filename = 'XMsun_at_TAMS.mod'\n\n        write_profile_when_terminate = .true.\n        filename_for_profile_when_terminate = 'XMsun_at_TAMS_profile.data'\n    [...]\n/ ! end of star_job namelist\n\n[...]\n\n&controls\n    ! starting specifications\n        initial_mass = X ! in Msun units\n    [...]\n    ! output controls\n        log_directory = 'LOGS_XMsun'\n        photo_directory = 'photos_XMsun'\n    [...]\n/ ! end of controls namelist\n\n[...]\n\n&pgstar\n    ! file output\n    Grid1_file_flag = .true.\n    Grid1_file_dir = 'grid_png_XMsun'\n    Grid1_file_prefix = 'grid_XMsun_'\n    [...]\n/ ! end of pgstar namelist\n","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"You are good to go: run the simulation 1 using the instructions and look at the dynamic plots attentively; the run should be smooth and fast. If you did everything correctly, you should be able to see something like the window below popping out in your screen:","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"(Image: alt text for screen readers)","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"Once the simulation 1 is done, edit your inlist_project as above, but this time assuming that your mass for the simulation 2 is M=XM_odot: substitute every X value with your X value. This is necessary to avoid overwriting your previous output.","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"🚨 ATTENTION 🚨   Before leaving the session, save your MESA_LAB1 folder somewhere: your local machines / USB memory / personal folder in the system. In the following, I am going to assume that you are at home writing your report: specifically, you are student A assigned with mass M=XM_odot for your simulation 1, and you will use Mneq M just to answer the question on  Massive vs Low Mass evolution and for a small part of the question on Variations of the EoS: Radiation Pressure and Degeneracy. ","category":"page"},{"location":"8_questions/#I.-The-Pre-Main-Sequence-and-Main-Sequence-(2-pts)","page":"Questions","title":"I. The Pre Main Sequence and Main Sequence (2 pts)","text":"","category":"section"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"You evolved a model star with initial mass M along the Pre Main Sequence (PMS) phases and its Main Sequence (MS):","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"PMS:      Phase of the evolution in which the star is just formed but still too cold to ignite hydrogen burning in the core; the star contracts due to gravity, and thanks to the virial theorem in action its internal energy increases, until the conditions in its core are suitable for the first nuclear reactions to start. When hydrogen burning starts, we finally talk about Main Sequence.\nMS:      Phase of the evolution in which the star is burning hydrogen in its core; stars will spend roughly 90 of their lives in this stage. We can also give two other useful names: \nZAMS:         Zero Age Main Sequence, point in stellar evolution when the star joins the Main Sequence;\nTAMS:          Terminal Age Main Sequence, point in stellar evolution when the star has burnt all hydrogen in its core.","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"ORDERS OF MAGNITUDE  \nCompute the dynamical (tau_mathrmdyn), Kelvin-Helmholtz (tau_mathrmKH) and nuclear (tau_mathrmnuc) timescales expected for your star with mass M=XM_odot at ZAMS. To do so, remember the exercise from lecture 2 in which you found\ntau_mathrmdynapproxsqrtdfracR^3GMapprox 002left(dfracRR_odotright)^32left(dfracM_odotMright)^12mathrmdays\ntau_mathrmKHapproxdfracGM^22RLapprox 15times 10^7left(dfracMM_odotright)^2dfracR_odotRdfracL_odotLmathrmyr\ntau_mathrmnucapprox 10^10dfracMM_odotdfracL_odotLmathrmyr\nYou will have to give a look at the ./LOGS_XMsun/history.data file. You should be able to read the information you need from those columns. NB: the star_age column that you'll use as a check is in unit of years!\nHint I: What we call ZAMS is actually an arbitrary definition on which literature doesn't agree. A good way to find the start of the ZAMS is to look into the nuclear reaction rates luminosity L_mathrmnuc (see column log_Lnuc, in L_odot units) and see if it is a significant fraction (sim 90) of the total surface luminosity, luminosity, in L_odot units.\nAfter reaching the ZAMS, your star should start burning hydrogen in its core. Try and plot the total surface luminosity as compared to the total hydrogen burning luminosity (which is the only contribution to your L_mathrmnuc during the MS).\nHint II: You should find the interesting information in the columns luminosity, log_R (which is log_10R(R_odot)) and log_LH of your history.data file. \nTIMESCALE OF MS PHASE  \nHow much time tau_mathrmMS does your star spend in the MS phase in the simulation? To which order of magnitude estimate above would you associate this timescale? What does this mean in terms of the star's equilibrium?\nTIMESCALE OF PMS PHASE  \nHow much time tau_mathrmPMS does your star spend in the PMS phase in the simulation? To which order of magnitude estimate above would you associate this timescale? What does this mean in terms of the star's equilibrium?","category":"page"},{"location":"8_questions/#II.-The-Virial-Theorem-(5-pts)","page":"Questions","title":"II. The Virial Theorem (5 pts)","text":"","category":"section"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"You will now verify that the virial theorem is in action during your star's evolution. To do so, we will start by computing the total energy reservoir E_mathrmtot of your star. Remember that the total energy is given, at each timestep, by","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"E_mathrmtot=E_mathrmgr+E_mathrmint+E_mathrmkin","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"where E_mathrmgr stands for gravitational potential energy, E_mathrmint for internal energy and E_mathrmkin is the energy associated to bulk motions pf gas inside the star, which is different from E_mathrmint, being due to the thermal motions of the gas particles.","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"GRAVITATIONAL POTENTIAL ENERGY  \nCompute the gravitational potential energy E_mathrmgrav of your star at ZAMS. You will have to give a look at the ./LOGS_XMsun/profileN.data, where N corresponds to the number of profile which is closer to being the profile of your star at ZAMS. Do it directly from the formal definition:\nE_mathrmgravequiv -int_0^MdfracGmr(m)dm\nHint: From the previous step, you should have been able to determine which model along the evolutionary track corresponds to the ZAMS one. The mapping from this number to the right profile is straightforward, once you give a look at a file called ./LOGS_XMsun/profiles.index. You should use the information printed on the columns rmid (radial coordinate of the cell in R_odot), mmid (mass coordinate of the cell in M_odot) and dm (cell mass in grams).\nINTERNAL ENERGY\nCompute the internal energy E_mathrmint of your star at ZAMS. Do it directly from the formal definition:\nE_mathrmintequivint_0^Mu(m)dm\nwhere u=u(m) is the specific (per unit mass) internal energy of each cell at mass coordinate m. You should be able to find the information in the column energy (internal energy (ergs/g)).\nTOTAL ENERGY\nCompute the internal energy E_mathrmkin of your star at ZAMS. Remember that your star is supposed to be in hydrostatic equilibrium: this should already give you a hint on E_mathrmkin. If you don't know how to calculate it, give a look at a column called cell_specific_KE, which stands for specific kinetic energy of a single cell (ergs/g) and convince yourself about what you see.   You now have all the ingredients to compute E_mathrmtot=E_mathrmgr+E_mathrmint+E_mathrmkin. Is your system bound at ZAMS?\nVIRIAL THEOREM\nLet us now verify that (and how) the virial theorem, always valid in theory under the assumption of spherical symmetry and hydrostatic equilibrium, is actually at work in our simulation. Remember that this theorem connects two important energy reservoirs of the star, i.e. E_mathrmgrav and E_mathrmint, and it allows us to interpret the star's phases of evolution.  Remember that the most general form of the virial theorem is the following:  \nmathrmVIRIAL THEOREMhspace2cmint_0^MdfracPrhodm=-dfrac13E_mathrmgr\nwith P=P(m) and rho=rho(m) being the pressure and density profiles along the star's structure. You already computed E_mathrmgr in the previous steps; compute now the left-hand-side (LHS) of the equation at ZAMS, and verify the theorem! Do you expect it to hold at all timesteps too or just at ZAMS?\nHint: You should be able to find the information you need in the columns logRho and logP of your profileN.data file. Also: all the logarithms you'll encounter are in base 10. \nTHE EQUATION OF STATE  \nDuring your class you derived the following form of the virial theorem in the particular case of perfect, non-relativistic and monoatomic gas:\nu=dfrac32dfracK_mathrmBTmu m_mathrmu=dfrac32dfracPrhohspace025cmRightarrowhspace05cmE_mathrmint=-dfrac12E_mathrmgr\nwhere the internal energy per unit mass u comes from the perfect gas assumption: the kinetic energy per particle sums up to the total internal energy of an ideal monoatomic gas, and from statistical mechanics this is equal to 32 K_mathrmBT. If we now relax the assumption of non-relativistic and monoatomic gas (but keeping it perfect, i.e. non-ideal effects are not in action), we can write the specific internal energy u in a more general form, and thus derive the correspondent form of the virial theorem:\nu=phidfracPrhohspace025cmRightarrowhspace05cmE_mathrmint=-dfrac13phi E_mathrmgr\nunder the assumption of phi=mathrmconst along the star structure. Write the expression of the total energy E_mathrmtot of your star and find out the phi-dependent condition under which your system remains bound.     You also have all the ingredients to find out the value of this phi for your simulation at ZAMS: how close is it to be phi=32? What do you think can be the reason behind the departure, if there's any?\nCHECK ALONG THE EVOLUTION\nUp to now, you worked with a particular profile, i.e. the solution of the stellar structure equations at a fixed timestep. What you can also do is to verify the form of the virial theorem along the entire evolutionary track. Assume that phi=32 (you already discussed the goodness of the assumption at ZAMS), and do the check by plotting E_mathrmint and -12 E_mathrmgr at each timestep. At which point(s) of the evolution do you see the worst (or best) agreement? Motivate.   Plot, together with the above two quantities, also E_mathrmtot; can you tell, by virtue of the virial theorem in hold, what is happening during the evolution of your star?\nHint: You should be able to find the information you need in the columns total_gravitational_energy, total_internal_energy and tot_E of your history.data file. I suggest to use, as x-axis, a quantity that can monotonically trace the evolution of your star, for example its age. And try to highlight the ZAMS as well.","category":"page"},{"location":"8_questions/#III.-Convection-and-Energy-Transport-(4-pts)","page":"Questions","title":"III. Convection and Energy Transport (4 pts)","text":"","category":"section"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"During the early PMS phase, the star's structure is almost completely convective: opacity of outer layers is so high, due to the very low temperatures, that radiative energy transport is made inefficient and the convective envelope is sinking so deep in the star that almost the entire structure experiences convection. ","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"Convince yourself that all of the above holds for your model during the first stages of   the PMS. In your lectures you studied a formal criterion, the Schwarzschild criterion, for stability against convection:\nmathrmSCHWARZSCHILD CRITERIONhspace2cmnabla_mathrmradequivdfrac316pi a c GdfracPT^4dfrackappa lmnabla_mathrmad\nwhere a=7566times 10^-15mathrmergmathrmcm^-3mathrmK^-4 is the radiation constant, P=P(m), T=T(m), kappa=kappa (m) and l=l(m) are the pressure, temperature, opacity and luminosity profiles along the stellar structure; nabla_mathrmad and nabla_mathrmrad are the adiabatic and radiative temperature gradients. Verify that there's a stage of the evolution in which convection happens globally in your star. You might want to produce a plot like one of those present in your saved pngs to support your argument.\nRemember the exercise in which we showed that nabla_mathrmad= 04 for an ideal gas without radiation. How close is the nabla_mathrmad of your simulation to be nabla_mathrmadsimeq 04 in this stage? Motivate why nabla_mathrmad drops below 04 around the outer layers of your star and why, close to your core, that value is almost correct.\nHow is the actual temperature gradient as compared to the adiabatic one? Remember that in class we mentioned that, very often, one can make the approximation nablaapproxnabla_mathrmad in convective regions. Compute the degree of superadiabaticity nabla-nabla_mathrmad and discuss the goodness of the approximation in your simulation. \nHow long does your star stay completely convective? I.e., how relevant is this stage of evolution with respect to the total age of your star?","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"Hint I: You can select the completely convective model during the PMS by looking at the grid_XMsun.png files, in particular at the Kippenhahn diagram, i.e. the one showing mass coordinates mM_odot of interesting zones as a function of the model number. When the light blue region spans the entire mass range, you have convection over all you structure. The mapping from model number to the right profileN.data should be straightforward from the profiles.index file.","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"Hint II: You should be able to find the useful information in the columns grada (adiabatic temperature gradient), gradr (radiative temperature gradient), and actual_gradT (actual temperature gradient).","category":"page"},{"location":"8_questions/#IV.-Variations-of-the-EoS:-Radiation-Pressure-and-Degeneracy-(3-pts)","page":"Questions","title":"IV. Variations of the EoS: Radiation Pressure and Degeneracy (3 pts)","text":"","category":"section"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"We will start by studying the contribution, to the EoS, of the gas of photons, i.e. the radiation pressure contribution P_mathrmrad. Until now, you discussed the goodness of the ideal gas assumption for your model, and extensively showed its action along the evolution of your system. But does it mean that the photons' contribution is not even there, or not important?","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"Remember that in general the pressure inside a star is the sum of the gas pressure and radiation pressure. For an ideal gas with a radiation contribution, we can write","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"P=P_mathrmgas+P_mathrmrad=P_mathrmions+P_mathrme+P_mathrmrad=dfracmathcalRmurho T+dfrac13a T^4","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"mathrmwithhspace05cmmathcalR=831447times 10^7mathrmergmathrmg^-1mathrmK^-1","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"a=756578times 10^-15mathrmergmathrmcm^-3mathrmK^-4","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"where P_mathrme is the contribution of free electrons, P_mathrmions the one from ions, mathcalR is universal gas constant and a is the radiation constant. Be aware this form of P_mathrmgas=mathcalRmu rho T is implying that we are considering the gas of electrons to be non-degenerate (see below).","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"THE FRACTION OF RADIATION\nLet's examine the profile concerning the TAMS stage of your simulation. Finding this profile is particularly easy, since it's the last one printed from your simulation run, and you will find it as it is called XMsun_at_TAMS_profile.data, in your top level of the MESA_LAB1 directory. \nPlot the total pressure P, the radiation pressure P_mathrmrad and the gas pressure P_mathrmgas contributions all together for the profile at TAMS. Quantify the impact of the radiation pressure contribution by defining a fraction beta as follows\nP_mathrmgas=beta Phspace05cmmathrmandhspace05cmP_mathrmrad=(1-beta)P\nNotice that this beta will vary along your star's structure; comment on the order of magnitude of your beta and on the regions in which it is higher / lower.\nHint: Look at the columns pressure, prad and pgas.","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"Let us now see whether neglecting the contribution of degeneracy pressure from electrons, thus treating them as classical particles following P_e=mathcalRmu rho T, is a good assumption or not. From statistical mechanics, we know that Pauli exclusion principle forces degenerate electrons to pile up in levels with higher and higher momentum, till the maximum occupied level with the Fermi momentum p_mathrmF. On the other hand, if the electron gas is classical, the particles are following a Maxwell-Boltzmann like distribution, with a maximum momentum given by p_mathrmmax, see lecture on Degenerate EOS. More specifically,","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"p_mathrmF=hleft(dfrac38pin_eright)^13hspace05cmp_mathrmmax=sqrt2m_eK_mathrmBT","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"with n_e being the number density of free electrons in the stellar gas, h=6626times 10^-27mathrmergmathrms is the Planck constant and m_e=9109times 10^-28mathrmg. To the purpose of quantifying the degeneracy degree in our simulation, we can refer to the following ratio  ","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"mathrmPROXY FOR DEGENERACY DEGREE    dfracp_mathrmFp_mathrmmax","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"SOME DEGENERACY DEGREE? See if the above ratio is gtrless 1 for the profile at TAMS, and assess the goodness of the classical gas assumption. In which region do you see the highest degree of degeneracy, if you have some?\nHint: There is no profile column providing the value for n_e, you would have to calculate it yourself in a reasonable way. Remember that by definition n_e=rhomu_em_u, and your gas is mainly made by H and He.\nCOMPARISON BETWEEN MODELS\nNow you'll finally use the output of your simulation 2, namely the second mass M=XMmathrmodot. Answer to the requests 1. and 2. of this question IV. also for this second mass, and discuss which model is more degenerate, and which one is more radiation pressure dominated.","category":"page"},{"location":"8_questions/#V.-Massive-vs-Low-Mass-evolution-(2-pts)","page":"Questions","title":"V. Massive vs Low Mass evolution (2 pts)","text":"","category":"section"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"You will again use the output of your simulation 2: here the goal is to make you aware of some differences in the evolution of a low mass (Mgtrsim 1mathrmodot) star versus a relatively higher mass (Mgtrsim 5mathrmodot) one. You will study the differences in great detail in the following classes, but there are some key points that can be observed also along the MS.","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"CONVECTIVE OR RADIATIVE CORE?    \nConsider you models M and M.\nDo they experience convection in their core, during the nuclear burning of H? What does it imply, in terms of elements abundances profiles in the core?\nIf the star has a convective core, does its size increase or decrease during the nuclear burning of H? \nHint: you can follow the information stored in mass_conv_core in your history.data file. Or, you can also answer qualitatively by looking at the Kippenhahn diagram, and the abundances profiles plot in your grid_XMsun.png and grid_X'Msun.png. In this context, you can (not mandatory) include screenshots of your pgstar window to prove your point.\nCONVECTIVE OR RADIATIVE ENVELOPE?\nConsider you models M and M. \nDo they experience convection in their envelope, during the nuclear burning of H? Quantify the different convective envelope masses you are seeing. \nRemembering the Schwarzschild criterion for stability against convection, can you motivate why you're (not) seeing a convective envelope, if that is the case?\nHint: you can give a rough estimate of the envelope masses by looking at at the Kippenhahn diagram in your grid_XMsun.png and grid_X'Msun.png. For the motivation on convection to occur in the envelope, I suggest to give a look at one of the other diagrams present in your pgstar window, i.e. the one showing the opacity curve 😁\nTHE SURFACE PROPERTIES\nGive a look at the HR diagram, i.e. the (log T_mathrmeff(mathrmK) log L(L_odot)) plane. Plot your two tracks together in such plane, highlighting the ZAMS. \nCompare the orders of magnitude for the surface luminosity log L(L_odot) for your two stars and try to explain the difference you're seeing, in terms of the mass-luminosity relation that you saw in your lectures. Is your more massive star of the pair more luminous at ZAMS? By how much?\nCompare the orders of magnitude for the effective temperature log T_mathrmeff(mathrmK) for your two stars. Which star of your pair sets into ZAMS at a higher T_mathrmeff And at TAMS?","category":"page"},{"location":"8_questions/#VI.-Bonus:-Radiative-Opacities-(-pts)","page":"Questions","title":"VI. Bonus: Radiative Opacities (➕ pts)","text":"","category":"section"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"This bonus question is meant for you to gain a better understanding of the ingredients playing a role in computing the radiative opacity kappa of the stellar matter.  ","category":"page"},{"location":"8_questions/","page":"Questions","title":"Questions","text":"THE TOTAL OPACITY AT ZAMS\nPlot the ZAMS profile of the total radiative opacity kappa (see column opacity). This is the result of very complicated ingredients from atomic physics and chemistry blended together, but there should be some easily recognizable features.\nRemember that the electron scattering opacity kappa_mathrmes, in the Thomson classical limit, can be expressed by\nkappa_mathrmes=020(1+X)mathrmcm^2mathrmg^-1\nwhere Xsimeq 07 is the hydrogen mass fraction. Where in your star can you see this feature to be the dominant one?\nFree-free absorption opacity kappa_mathrmff accounts for the inverse process   of the Bremsstrahlung, in which a free electron passes by a charged nucleus and emits radiation due to the experienced acceleration. An approximate calculation was carried on by Kramers, who gave a power-law relation of this sort     kappa_mathrmffsimeq kappa_0 rho T^-72mathrmcm^2mathrmg^-1\nin which kappa_0 is a constant that depends on the chemical composition. Where in your star can you see a power-law-ish trend being dominant?\nIf I remind you that Hydrogen recombines at  10^4mathrmK, mostly independently on the density rho, can you tell where (and if!) this feature is playing a role?","category":"page"},{"location":"7_nucleo1_problems/#Exercises","page":"Exercises","title":"Exercises","text":"","category":"section"},{"location":"7_nucleo1_problems/#List-of-exercises","page":"Exercises","title":"List of exercises","text":"","category":"section"},{"location":"7_nucleo1_problems/#1:-The-nuclear-timescale","page":"Exercises","title":"1: The nuclear timescale","text":"","category":"section"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"The objective of this exercise is to determine the nuclear burning timescale tau_mathrmnuc for stars of different masses. For simplicity, let us take the entire star to be composed of hydrogen, and assume a fraction alpha of it is burnt into helium. For a luminosity L, which we take to be constant through the main sequence, and an energy epsilon released per gram of hydrogen fused, the nuclear timescale is","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"tau_mathrmnuc=fracalpha MepsilonL","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"First compute the energy release epsilon for hydrogen fusion taking into account the atomic masses of hydrogen and helium.\nelement Z A mm_u\nH 1 1 1.007825\nHe 2 4 4.002603\nRemember that the atomic mass unit m_u (defined as 112 times the mass of the ^12mathrmC atom) is equal to 1660540times 10^-24mathrmg. Also, the speed of light is equal to csimeq 3times 10^10. With this information compute the value of epsilon while ignoring energy losses due to neutrinos. Remember that atomic masses refer to neutral atoms, so they include electron masses.\nIn the next class we will show that stars follow a steep mass luminosity relationship: \nLpropto M^3\nthe exponent is modified from 3 in connection with the exact form of the surface opacity and nuclear burning process powering the star. It is also modified at very high masses as they approach the Eddington limit. But an exponent of 3 is a good approximation through a broad range of masses. Using this power law dependence, determine tau_mathrmnuc for stars of masses 1M_odot, 10M_odot and 100M_odot. For reference, the solar luminosity is L_odotsim 39times 10^33mathrmergmathrms^-1 and the solar mass is M_odotsim 20times 10^33mathrmg. Take alpha=01.\nFrom detailed calculations, it's shown that for very high mass stars gtrsim 100M_odot the ZAMS mass-luminosity relation becomes almost linear. What does this imply for the scaling of tau_mathrmnuc with mass?","category":"page"},{"location":"7_nucleo1_problems/#2:-Energetics-of-the-pp-chains","page":"Exercises","title":"2: Energetics of the pp-chains","text":"","category":"section"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"Let's study the Q-value of the three pp-chains. Remember that the definition of the Q-value for a nuclear reaction is","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"Qequiv (m_X+m_a-m_Y-m_b)c^2hspace075cmmathrmwithhspace025cmX+arightarrow Y+b","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"where we are schematizing a reaction of the nucleus X, of mass m_Y, with a particle a, of mass m_a which produces a nucleus Y and a particle b, with masses m_Y and m_b respectively. Recalling the scheme of the three pp-chains","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"(Image: alt text for screen readers)","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"you can see that three of the reactions in the chains are accompanied by neutrino emission. The average neutrino energy leftE_nuright is different in each chain (see section 18.1 of Stellar Structure and evolution by Kippenhahn, Weigert & Weiss):","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"^1mathrmH+^1mathrmHrightarrow ^2mathrmH+e^++nuhspace1cm","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"gives leftE_nuright=0267mathrmMeV","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"^7mathrmBe+e^-rightarrow ^7mathrmLi+nuhspace1cm","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"gives leftE_nuright=0738mathrmMeV","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"^8mathrmBrightarrow ^8mathrmBe+e^++nuhspace1cm","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"gives leftE_nuright=6735mathrmMeV","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"Considering these energy losses calculate the total effective Q-value for the production of one ^4mathrmHe nucleus in each chain.","category":"page"},{"location":"7_nucleo1_problems/#3:-Temperature-dependence-of-reaction-rates","page":"Exercises","title":"3: Temperature dependence of reaction rates","text":"","category":"section"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"We saw in class that the thermally averaged reaction cross-section leftsigma vright can be written as","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"leftsigma vright=(8pi m)^12(k_mathrmBT)^-32S(E_0)int_0^inftyunderbraceexpleft(-dfracEk_mathrmBT-dfracbE^12right)_equiv f(E)dE","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"where S(E_0) is the astrophysical S-factor (almost constant outside resonances) and we defined the function f(E), referred to as the Gamow peak, being a very sharply peaked function around an energy value E_0. Also remember that bapprox Z_iZ_jA^12 with Aequiv A_iA_j(A_j+A_i), setting the shape of the Gamow factor in terms of the Coulomb barrier and the types of nuclei.","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"Show that the Gamow peak energy E_0 is\nE_0=left(dfrac12bk_mathrmBTright)^23approx (Z_i^2Z_j^2AT^2)^13\nShow that f(E_0) gives\nf(E_0)=expleft(-dfrac3E_0k_mathrmBTright)equiv e^-tau\nwhere we defined tau for future convenience.\nNow consider a Gaussian centered in E_0 with width Delta E:\nf(E)approx f_mathrmGAUSS(E)=f(E_0)expleft-left(dfracE-E_0Delta Eright)^2right\nSince the function f(E) is sharply peaked around a E_0, we can take this Gaussian as a good approximation of the Gamow peak. Consider the f(E) expansion to second order around E_0:\nf(E)=f(E_0)+f(E_0)(E-E_0)+dfrac12f(E_0)(E-E_0)^2+\nShow that the width Delta E of the Gaussian f_mathrmGAUSS(E) satisfies\nDelta E=left(dfrac43E_0 k_mathrmBTright)^12\nBy using the built Gaussian function f_mathrmGAUSS(E), show that you can approximate the thermally averaged cross section leftsigma vright in the following manner:\nleftsigma vrightapproxdfrac89left(dfrac23mright)^12dfracS(E_0)btau^2e^-tauhspace05cmRightarrowhspace05cmleftsigma vrightpropto dfrac1T^23expleft(-dfracCT^13right)\nwith C being a number dependent on the Coulomb barrier Z_iZ_j. To do so, remember this tabulated Gaussian integral:\nint_-infty^+inftye^-alpha x^2dx=sqrtdfracpialpha\nFinally, show that, if you consider a small range of temperatures around some value T_0, you can write\nleftsigma vright=leftsigma vright_T=T_0left(dfracTT_0right)^nuhspace075cmmathrmwithhspace05cmnuequivdfracpartial log leftsigma vrightpartiallog T=dfractau-23","category":"page"},{"location":"7_nucleo1_problems/#Solutions","page":"Exercises","title":"Solutions","text":"","category":"section"},{"location":"7_nucleo1_problems/#1:-The-nuclear-timescale-2","page":"Exercises","title":"1: The nuclear timescale","text":"","category":"section"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"We start by computing the total energy released from fusing four hydrogen atoms into a helium atom,\nQ=(4m_mathrmH-m_mathrmHe)c^2\nwhere m_mathrmH and m_mathrmHe are the masses of the hydrogen and helium atoms (their atomic masses multiplied by the atomic mass unit). This results in\nQ= 43times 10^-5mathrmerg=268mathrmMeV\nPart of this energy is lost to neutrino emission, but we are ignoring that for the moment. We want the energy released per unit mass, which is\nepsilon = fracQ4 m_mathrmH=64times 10^18mathrmergmathrmg^-1\nUsing the solar luminosity and mass as a scaling factors, the given mass luminosity relationship implies\ndisplaystyle L = L_odot left(fracMM_odotright)^3\nwhich in turn gives for the nuclear timescale\ntau_mathrmnuc=fracalpha MepsilonL_odotleft(fracMM_odotright)^-3\n= fracalpha M_odot epsilonL_odotleft(fracMM_odotright)^-2\nWe can evaluate the factor outside parenthesis (using alpha=01) to obtain\ntau_mathrmnucsimeq 10mathrmGyrleft(fracMM_odotright)^-2\nWith this we quickly estimate that the (hydrogen) nuclear burning lifetimes of stars of masses 1M_odot, 10M_odot and 100M_odot would be 10mathrmGyr, 100mathrmMyr and 1mathrmMyr. The lifetime of stars changes dramatically with mass! Although the power-law index in the mass luminosity relationship changes significantly with mass, all these estimates are correct within an order of magnitude.\nIf we take into account the caveat that L_mathrmZAMSpropto M_mathrmZAMS for very high masses gtrsim 100M_odot, then we obtain that the nuclear timescale becomes basically independent on the mass of the stars. This flattening of the mass luminosity relationship starts well below 100M_odot, so the previous part of the exercise actually underestimates the lifetime of very massive stars. Through detailed calculations, one finds that this mass-independent lifetime is about 2mathrmMyrs, which represents the shortest (hydrogen-burning) life any unperturbed star can have.","category":"page"},{"location":"7_nucleo1_problems/#2:-Energetics-of-the-pp-chains-2","page":"Exercises","title":"2: Energetics of the pp-chains","text":"","category":"section"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"One could complete this exercise by computing the energy release of each individual reaction in the corresponding chain, and then add them up while substracting neutrino losses. However, it is enough to compute the total energy released by fusing four hydrogen atoms into one helium atom first. This was done in the first exercise, resulting in Q=268mathrmMev. The effective energy released for each of the chains can then be computed by substracting the neutrino energy losses relevant to each chain:","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"Q_mathrmPP-I=Q-0267mathrmMev=265mathrmMev","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"Q_mathrmPP-II=Q-0267mathrmMev-0738mathrmMev=258mathrmMev","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"Q_mathrmPP-III=Q-0267mathrmMev-6735mathrmMev=198mathrmMev","category":"page"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"The exact energy released by fusing hydrogen is then dependant on the ratio that each of these chains contribute.","category":"page"},{"location":"7_nucleo1_problems/#3:-Temperature-dependence-of-reaction-rates-2","page":"Exercises","title":"3: Temperature dependence of reaction rates","text":"","category":"section"},{"location":"7_nucleo1_problems/","page":"Exercises","title":"Exercises","text":"The Gamow peak energy E_0 can be found by taking the first derivative of f(E) and setting it equal to zero:\ndisplaystyledfracdfdE=dfracddEleftexpleft(-dfracEk_mathrmBT-dfracbE^12right)right=expleft(-dfracEk_mathrmBT-dfracbE^12right)left(-dfrac1k_mathrmBT+dfracb2E^32right)\ndisplaystyleleftdfracdfdEright_E=E_0overset=0hspace05cmLeftrightarrowhspace05cmE_0=left(dfrac12bk_mathrmBTright)^23\nThe dependence on the Coulomb barrier comes directly from the definition of b.\nThe expression comes directly from evaluation:\ndisplaystyle f(E_0)=leftexpleft(-dfracEk_mathrmBT-dfracbE^12right)right_E=E_0=expleft-dfracE_0k_mathrmBT-2^13left(dfracb^2k_mathrmBTright)^13right=\ndisplaystyle=expleft-dfracE_0k_mathrmBT-dfrac2E_0k_mathrmBTright=expleft(-dfrac3E_0k_mathrmBTright)equiv e^-tau\nThe width Delta E of the Gaussian can be found by computing the second derivatives of f_mathrmGAUSS(E) and f(E) and comparing them. Remember also that f_mathrmGAUSS(E_0)=0=f(E_0).\ndisplaystyledfracd^2fdE^2=dfracddEleftexpleft(-dfracEk_mathrmBT-dfracbE^12right)left(-dfrac1k_mathrmBT+dfracb2E^32right)right=\ndisplaystyle=f(E)left(-dfrac34bE^-52right)+f(E)left(-dfrac1k_mathrmBT+dfracb2E^32right)\ndisplaystyleRightarrowhspace05cmleftdfracd^2fdE^2right_E=E_0=f(E_0)left(-dfrac34bE_0^-52right)+0=-dfrac32e^-taudfrac1k_mathrmBTE_0=-tau e^-tauleft(dfrac12E_0^2right)\ndisplaystyledfracd^2f_mathrmGAUSSdE^2=f(E)left-dfrac2Delta E^2(E-E_0)right+f(E)e^left(E-E_0)Delta Eright^2left-dfrac2Delta E^2right\ndisplaystyleRightarrowhspace05cmleftdfracd^2f_mathrmGAUSSdE^2right_E=E_0=f(E_0)left-dfrac2Delta E^2right=-dfrac2Delta E^2e^-tau\nThe outcome of the comparison follows:\ndisplaystyledfracd^2fdE^2overset=dfracd^2f_mathrmGAUSSdE^2\ndisplaystyleLeftrightarrowhspace05cm-tau e^-tauleft(dfrac12E_0^2right)overset=-dfrac2Delta E^2e^-tauhspace05cmLeftrightarrowhspace05cmDelta E=left(dfrac43E_0 k_mathrmBTright)^12\nBy approximating f(E)approx f_mathrmGAUSS(E), you can write\ndisplaystyleint_0^inftyf(E)dEapproxint_0^inftyf_mathrmGAUSS(E)dE=e^- tauint_0^inftyexpleft-left(dfracE-E_0Delta Eright)rightdE=e^-tausqrtpiDelta E\nSo now it's just a matter of algebraic manipulations:\ndisplaystyleleftsigma vrightapproxleft(dfrac8pi mright)^12(k_mathrmBT)^-32S(E_0)e^-tausqrtpileft(dfrac43E_0k_mathrmBTright)^12=\ndisplaystyle=dfrac89left(dfrac23mright)^12dfracS(E_0)btau^2e^-tau\nThe temperature dependence in this expression can be recognized by recalling that E_0propto T^23, so that tauequiv 3E_0k_mathrmBTpropto T^23 T^-1=T^-13. Thus, tau^2propto T^-23, and immediately:\ndisplaystyleleftsigma vrightpropto dfrac1T^23expleft(-dfracCT^13right)\nThe definition of the exponent nu simply comes from:\ndisplaystylelog leftsigma vright=mathrmconst-dfrac23log T-tau\ndisplaystyleRightarrowhspace05cmdfracdlog leftsigma vrightdlog T=-dfrac23-taudfracdlogtaudlog T=-dfrac23+dfractau3equiv nu\nwhere in the last equality we used tausim T^-13.","category":"page"},{"location":"4_eos2_problems/#Exercises","page":"Exercises","title":"Exercises","text":"","category":"section"},{"location":"4_eos2_problems/#List-of-exercises","page":"Exercises","title":"List of exercises","text":"","category":"section"},{"location":"4_eos2_problems/#1:-Degenerate-electrons-versus-ions","page":"Exercises","title":"1: Degenerate electrons versus ions","text":"","category":"section"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"A Maxwell-Boltzmann distribution for a gas at temperature T and particles of mass m peaks at a momentum p_mathrmmaxMB=(2 m kT)^12. On the other hand, a fully degenerate gas occupies all states up to the Fermi momentum p_mathrmF:","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"n_p(p) = begincases\nfrac8pi p^2h^3  pleq p_mathrmF \n0  p p_mathrmF\nendcases","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"Taking into account that the number density for a given distribution is","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"n = int_0^infty n_p(p) dp","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"compute the Fermi momentum as a function of density rho for both the electrons and ions of a gas of ionized helium. If we define critical densities rho_mathrmcrite and rho_mathrmcritions as those for which p_mathrmmaxMBp_mathrmF=1, what is the value of rho_mathrmcriterho_mathrmcritions for this helium gas? What does this imply for the contribution to pressure of ions and electrons?","category":"page"},{"location":"4_eos2_problems/#2:-Energetics-of-a-degenerate-star","page":"Exercises","title":"2: Energetics of a degenerate star","text":"","category":"section"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"Consider the gravitational energy of a fully degenerate star to be","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"E_g sim -fracGM^2R","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"where we miss a constant of order unity. We have N=M(mu_e m_u) total electrons and the Fermi momentum is related to N via","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"fracN4pi R^33=frac8pi3h^3p_mathrmF^3","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"Assuming only electrons contribute significantly to the internal energy E_i, we can make a rough estimate on E_i by taking all electrons to have the same momentum p_mathrmF (this is formally an upper limit but the end result of this exercise is not affected):","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"E_i sim E(p_mathrmf)N","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"where E(p_mathrmF) is equal to p_mathrmF^2(2m_e) in the non-relativistic case and p_mathrmFc in the extremely relativistic case. Considering the total energy E_mathrmtot=E_g+E_i, a stable configuration can be found by locating the minimum of E_mathrmtot with respect to R. Use this to determine the power law beta in the mass-radius relationship Rpropto M^beta. ","category":"page"},{"location":"4_eos2_problems/#3:-Limiting-cases-of-the-degenerate-electron-gas","page":"Exercises","title":"3: Limiting cases of the degenerate electron gas","text":"","category":"section"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"Show that in the non-relativistic (NR) and extremely-relativistic (ER) limits the equations of state of a fully degenerate electron gas are given respectively by","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"P_emathrmNR = frac120left(frac3piright)^23frach^2m_e m_u^53left(fracrhomu_eright)^53quad \nP_emathrmER = left(frac3piright)^13frachc8 m_u^43left(fracrhomu_eright)^43","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"For this purpose use the pressure integral","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"P_e = frac13int_0^infty v(p) p n_p(p)dp","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"together with","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"n_e =fracrhomu_e m_u","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"You will need to use v(p)=pm_e and v(p)=c for the non-relativistic and extremely relativistic limits respectively.","category":"page"},{"location":"4_eos2_problems/#4:-Neutron-star-versus-white-dwarf-radii","page":"Exercises","title":"4: Neutron star versus white dwarf radii","text":"","category":"section"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"Neutron stars are primarily composed by neutrons and supported by their degenerate pressure. Although the equation of state of nuclear matter has important effects that make it differ from a simple gas of degenerate neutrons, we can do some qualitative comparison between the radius of a neutron star and a white dwarf. Considering a fully degenerate non-relativistic equation of state for both, which differs only on the mass of the degenerate particle (with a ratio between neutron and electron mass of m_nm_esim 2000), what is the ratio between the radii of both objects at a fixed mass? For this remember that for Ppropto rho^53 the solution to the equations of stellar structure can be determined from the Lane-Emden equation for an n=15 polytrope, with","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"R=r_n z_nquad r_n^2equiv frac(n+1)P_c4pi G rho_c^2quad M = 4pi r_n^3 rho_c (-z_n^2 w_n(z_n))","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"Consider that the white dwarf is composed of ionized helium (mu_esimeq 2). For the neutron star case you can approximate it with the expression for degenerate electron pressure while replacing m_e with m_n and mu_e with 1 (if you do not see why, try and work it out).","category":"page"},{"location":"4_eos2_problems/#Solutions","page":"Exercises","title":"Solutions","text":"","category":"section"},{"location":"4_eos2_problems/#1:-Degenerate-electrons-versus-ions-2","page":"Exercises","title":"1: Degenerate electrons versus ions","text":"","category":"section"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"The Fermi momentum is connected to the number density of a specific particle via","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"n=int_0^p_mathrmF n_p(p)dp=frac8pi3h^3 p_mathrmF^3rightarrow p_mathrmF=left(frac3h^3 n8piright)","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"For an ionized helium gas we can express the electron and ion densities as","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"n_e = fracrhomu_e m_mathrmuquad n_mathrmion = fracrhomu_mathrmion m_mathrmu","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"where mu_e corresponds to the number of atomic mass units per electron in the gas and mu_mathrmion is the average mass of the ions in units of the atomic mass (mu_mathrmesimeq 2 and mu_mathrmion simeq 4 for an ionized helium gas). We now can compute the critical densities at which we expect quantum effects to be important:","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"1=(2m_e k T)^12left(frac3 h^3 rho_mathrmcrite8pi mu_e m_mathrmuright)^-13","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"rho_mathrmcrit e=frac8pi mu_e m_mathrmu3h^3(2m_e kT)^32","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"The result for the ions is the same but with mu_mathrmion and m_mathrmHe,","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"rho_mathrmcrit ions=frac8pi mu_mathrmion m_mathrmu3h^3(2m_mathrmHe kT)^32","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"Taking the ratio between the two densities we have that","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"fracrho_mathrmcrit erho_mathrmcrit ions=fracmu_emu_mathrmionleft(fracm_mathrmem_mathrmHeright)^32simeq 8times 10^-7","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"such that densities need to be much higher for degeneracy of ions to take place in addition to degeneracy of electrons.","category":"page"},{"location":"4_eos2_problems/#2:-Energetics-of-a-degenerate-star-2","page":"Exercises","title":"2: Energetics of a degenerate star","text":"","category":"section"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"The final exponent in the power law will only depend on the powers of radius and mass that go into the E_g and E_i terms, so we do not need to care too much about constants. Let us do each case separetely.","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"Non-relativistic case: We have that\ndisplaystyle E_i propto p_mathrmF^2 Npropto fracN^53R^2propto fracM^53R^2\nThe total energy is then\ndisplaystyle E_mathrmtot = c_1 fracM^2R+c_2fracM^53R^2\nwhere c_1 and c_2 are independent of R and M. Minimizing with respect to R we find\ndisplaystyle Rpropto M^-13\nAs expected, this is consistent with the formal result obtained using polytropes in the exercises of two classes ago. \nExtremely-relativistic case: Following the same process as before but with E=p_mathrmFc we have\ndisplaystyle E_i propto p_mathrmF Npropto fracN^43Rpropto fracM^43R\nThe total energy is then\ndisplaystyle E_mathrmtot = c_1 fracM^2R+c_2fracM^43R\nand then we already find a \"problem\". Both terms share the same dependency in R, meaning that a minimum cannot exist for arbitrary mass. This is essentially the Chandrasekhar mass.","category":"page"},{"location":"4_eos2_problems/#3:-Limiting-cases-of-the-degenerate-electron-gas-2","page":"Exercises","title":"3: Limiting cases of the degenerate electron gas","text":"","category":"section"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"Non-relativistic case: Here we have v(p)simeq pm_e and the pressure integral is given by\ndisplaystyle P_emathrmNR = frac13int_0^p_mathrmFleft(fracpm_eright)times p times left(frac8pi p^2h^3right)dpquad p_mathrmF=left(frac3h^3 n_e8piright)^13\nPerforming the integral we find\ndisplaystyle P_emathrmNR=frac13left(frac8pih^3 m_eright)fracp_F^55\nwhich after substituting n_e=p(mu_e m_mathrmu) gives the expected result.\nExtremely-relativistic case: Procedure is the same but with v(p)=c:\ndisplaystyle P_emathrmNR = frac13int_0^p_mathrmFctimes p times left(frac8pi p^2h^3right)dp\nPerforming the integral we find\ndisplaystyle P_emathrmNR=frac13left(frac8pi ch^3right)fracp_F^44\nwhich after substituting n_e=p(mu_e m_mathrmu) gives the expected result.","category":"page"},{"location":"4_eos2_problems/#4:-Neutron-star-versus-white-dwarf-radii-2","page":"Exercises","title":"4: Neutron star versus white dwarf radii","text":"","category":"section"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"Using the relationship between pressure and density, r_n can be expressed for the white dwarf case as","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"r_nWD^2=Cm_e^-1mu_e^-53rho_c^-13","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"where C contains factors that are common for the neutron star and white dwarf case. The central density can be replaced using the expression for the mass,","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"r_nWD^2=Bm_e^-1mu_e^-53left(fracMr_nWD^3right)^-13","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"r_nWD =B m_e^-1mu_e^-53 M^-13","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"were B is another constant with terms common to both cases. Similarly for the neutron star case we obtain","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"r_nNS =B m_n^-1 M^-13","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"As the radius of the polytrope is R=r_n z_n, and z_n is the same for both cases, we find that the ratio of radii at fixed mass is:","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"fracR_NSR_WD=fracm_em_nmu_e^53sim 0002","category":"page"},{"location":"4_eos2_problems/","page":"Exercises","title":"Exercises","text":"Neutron stars are then expected to be far smaller than white dwarfs. For reference, white dwarfs are expected to have radii on the order of sim 5000mathrmkm, meaning we would expect neutron stars of about 10 kilometers. This is only about three times the Schwarzschild radius for one solar mass!","category":"page"},{"location":"11_instructions/#Instructions","page":"Instructions","title":"Instructions","text":"","category":"section"},{"location":"11_instructions/","page":"Instructions","title":"Instructions","text":"In this second MESA lab we will cover a variety of examples that illustrate important physical aspects of stellar evolution. Most of these examples are tailor made to run successfully until a meaningful termination condition within a reasonable amount of time. Bear in mind that publication quality runs can take much longer to compute, in particular we make use of models with low spatial and temporal resolution.","category":"page"},{"location":"11_instructions/#The-report","page":"Instructions","title":"The report","text":"","category":"section"},{"location":"11_instructions/#Formalities","page":"Instructions","title":"Formalities","text":"","category":"section"},{"location":"11_instructions/","page":"Instructions","title":"Instructions","text":"PAGE LIMIT Maximum of 6 pages (including figures) with classical font and fontsize (geq 12pt please). Include your name and student number on the first page of the PDF. PLEASE RESPECT the limit, whichever tool you are using (LaTeX, Word, LibreOffice...). And if you wish to include your code (not necessary), please include it in a separate file in the submission. The report may only be a descriptive pdf, images included.\nSUBMISSION FORMAT Submit a tar / zip named as name_lastname_LAB2.zip. PLEASE DON'T INCLUDE YOUR DATA. I only need your pdf file and, if you think it's needed (e.g. because you have doubts or you included a custom piece of code), the inlist_project files. ","category":"page"},{"location":"11_instructions/#Grades-and-deadlines","page":"Instructions","title":"Grades and deadlines","text":"","category":"section"},{"location":"11_instructions/","page":"Instructions","title":"Instructions","text":"You will be given 5 weeks to complete the report and send it to us.","category":"page"},{"location":"11_instructions/","page":"Instructions","title":"Instructions","text":"GRADES Each part of the lab counts for 4 points. The maximum is 16 points / 16. Let us say that you totalize N points / 16: in total, this report will weight N / 4 grades out of your final 20! So if you manage to score full grade in this report, 4 points out of your final 20 are granted. Good luck! 🍀\n▶️ DEADLINE  Report must be completed by   16 January , 14:00 CET\nTO BE SENT Via email to annachiara.picco@kuleuven.be, with the subject of the   email matching the name of the attached zip / tar file, i.e. something like name_lastname_LAB2.zip.","category":"page"},{"location":"11_instructions/#MESA-instructions","page":"Instructions","title":"MESA instructions","text":"","category":"section"},{"location":"11_instructions/","page":"Instructions","title":"Instructions","text":"Just as in the previous session we will be making use of version 15140 of MESA, which is already installed on the lab computers. To be able to run MESA from a folder of your choice, you need to set the Linux environment variables to tell your terminal where to find the software. To do so, open a terminal with ctrl+shift+T and type the following:","category":"page"},{"location":"11_instructions/","page":"Instructions","title":"Instructions","text":"# Set the environment variables\nmodule load mesasdk\nmodule load mesa\n# Check that everything is correct\necho $MESA_DIR\necho $MESASDK_VERSION","category":"page"},{"location":"11_instructions/","page":"Instructions","title":"Instructions","text":"Beware that the module load commands are specific to the setup of the computers at the Institute of Astronomy. If you are running MESA locally on your computer you need to follow the usual instructions to install and run MESA models.","category":"page"},{"location":"11_instructions/","page":"Instructions","title":"Instructions","text":"There are also some specific performance tips you can use at the computers of the Institute of Astronomy to improve the runtime of your simulations. These should not be necessary when running things locally on your own machine. Make sure you use all cores available in your system. By running htop on your terminal you can see the number of cores available, and then in the terminal where you will run the simulations do","category":"page"},{"location":"11_instructions/","page":"Instructions","title":"Instructions","text":"export OMP_NUM_THREADS=6","category":"page"},{"location":"11_instructions/","page":"Instructions","title":"Instructions","text":"where 6 needs to be replaced with your number of cores visible in htop. The second performance tip is to make use of the local storage on the computers rather than network storage which is much slower. Local storage is contained in /scratch, so you can start the lab by moving into that directory:","category":"page"},{"location":"11_instructions/","page":"Instructions","title":"Instructions","text":"cd /scratch","category":"page"},{"location":"11_instructions/","page":"Instructions","title":"Instructions","text":"MESA also stores files containing information from the equation of state, rates and opacities. By default these will be stored on your home folder which needs to go through the network. To switch these to use /scratch you can include the following within the &star_job section of any inlist you run ([...] stands for other parts within this section, you do not need to copy that):","category":"page"},{"location":"11_instructions/","page":"Instructions","title":"Instructions","text":"&star_job\n  [...]\n  eosDT_cache_dir = '/scratch/eosDT_cache'\n  kap_cache_dir = '/scratch/kap_cache'\n  rates_cache_dir = '/scratch/rates_cache'\n  [...]\n/","category":"page"},{"location":"11_instructions/","page":"Instructions","title":"Instructions","text":"Files written to /scratch will remain in the local computer, so remember to erase all files you've added in /scratch before leaving!","category":"page"},{"location":"11_instructions/#The-assigned-masses","page":"Instructions","title":"The assigned masses","text":"","category":"section"},{"location":"11_instructions/","page":"Instructions","title":"Instructions","text":"Similarly to the first MESA lab, you all will be paired during the session. This means that every student (A) will have a mate (B) to look at the simulations with. Each team (A+B) of students will have to produce, during the session, the proposed simulations, and save the outputs for later use (at home). You have 4 exercises, in which a specific mass of the star, M(M_odot) is needed.","category":"page"},{"location":"11_instructions/","page":"Instructions","title":"Instructions","text":"Team number Ex.1 M_mathrmI(M_odot) Ex.2 M_mathrmII(M_odot) Ex.3 M_mathrmIII(M_odot) Ex.4 M_mathrmIV(M_odot)\n1 10 20 2 18\n2 10 18 1.9 20\n3 10 19 1.8 19\n4 10 21 1.7 21\n5 10 22 1.5 18\n6 10 19 1.6 20\n7 10 20 1.9 19\n8 10 18 1.9 18\n9 10 21 2 21","category":"page"},{"location":"11_instructions/","page":"Instructions","title":"Instructions","text":"Please find above the list of masses that you will have to use in each exercises. I will assign to each team a team number, and you will have to modify the mass per team and per exercise accordingly. I will list down here some controls in your inlist_project that you might want to tweak each time you run a simulation with the assigned masses:","category":"page"},{"location":"11_instructions/","page":"Instructions","title":"Instructions","text":"&star_job\n  [...]\n    filename_for_profile_when_terminate = '20Msun_Z2d-2_profile.data'\n  [...]\n/\n\n[...]\n\n&controls\n  [...]\n  !starting specifications\n     initial_mass = 20d0 ! in Msun units\n  [...]\n  !output controls\n     log_directory = 'LOGS_20Msun_Z2d-2'\n  [...]\n/\n\n[...]\n\n&pgstar\n  [...]\n    Grid1_file_dir = 'grid_png_20Msun_Z2d-2'\n  [...]\n/","category":"page"},{"location":"7_nucleo1/#Nucleosynthesis","page":"Notes","title":"Nucleosynthesis","text":"","category":"section"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"Goals:","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"Basic definitions\nCross sections and rates\nTunneling and the Gamow peak\nNuclear burning stages","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"For reference, this section is based on chapter 6 of the lectures on stellar evolution by Onno Pols, available at https://www.astro.ru.nl/~onnop/education/stevutrechtnotes/.","category":"page"},{"location":"7_nucleo1/#Basic-definitions","page":"Notes","title":"Basic definitions","text":"","category":"section"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"We have by now discussed how energy is transported through a star, but have not considered in much detail how it is generated. A natural source of energy is contraction, where a star sinks into its own potential well to provide its surface luminosity. However, through most of a stars lifetime the main source of energy comes from nuclear fusion reactions.","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"Typical notations for reactions are","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"X+arightarrow Y+bquad textor quad X(ab)Y","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"In here it could be read that X produces Y by interacting with a, releasing b as a side product. But in practice X and a have equivalent roles in the reaction. Any such reaction must satisfy two basic conservation laws","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"Conservation of baryon number\nConservation of charge","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"The first conservation law can be taken as that the sum of protons and neutrons must remain constant.","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"The reason why nuclear reactions allow for a release of energy is that due to nuclear forces the rest mass energy of an atomic nucleus is different from that of its constituent neutrons and protons if they were free particles. Considering the actual mass m_i of a nucleus with atomic number A_i, its binding energy is defined as","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"E_mathrmbi=(A_i-Z_i)m_n + Z_i m_p - m_ic^2","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"If we consider the most common isotopes for each element, one can see how the energy per baryon varies with mass number (image source: Wikimedia Commons),","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"(Image: Binding energy of most common isotopes)","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"We see that the most bound nucleus is ^56mathrmFe. This means that by fusing lighter atoms we can release energy (exothermic reactions), but once we burn everything into iron any additional fusion process requires energy (endothermic reaction). The formation of an iron core then represents a critical evolutionary stage, as we will see later.","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"The energy released by a reaction rate can be determined by taking the mass difference between the initial and final states,","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"Q=(m_X+m_a-M_Y-m_b)c^2tag61","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"In some cases some of this energy is, however, lost. This is the case when neutrinos are produced, which can have large energies and can travel pretty much unimpeded from the stellar core to its surface.","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"In order to compute (6.1), one can make use of atomic masses. However, note that these are for neutral atoms, so they include electron masses!","category":"page"},{"location":"7_nucleo1/#Cross-sections-and-rates","page":"Notes","title":"Cross sections & rates","text":"","category":"section"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"Just as wit the interaction of light and matter, nuclear reactions are characterized by cross sections. If we consider fixed particles X against which a flux (particles per unit area) of particles a is shot, then the cross section for the reaction is defined as","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"sigma = fractext of reactions X(ab)Y per unit time per  of X particlestextflux of a in frame of X","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"If the relative velocity between particles X and a is v, then the flux of a in the frame of X is simply n_av (where n_a are the number of a particles per unit volume). For arbitrary particles i and j we can then write the number of reactions per unit time and unit volume as","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"tilder_ij=n_i n_j v sigma","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"There is a small caveat for the case of equal particles reacting together. In that case, if we have N particles the total number of pairings without double counting is","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"frac12N(N-1)sim fracN^22quad(textfor Ngg 1)","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"so the general form of the reaction rate is","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"tilder_ij=frac11+delta_ijn_in_jvsigma","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"where delta_ij is the Kronecker delta.","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"In practice, inside a star we have a distribution of relative velocities between particles, and the cross section is different at different velocities. The rate then comes from integrating over all relative velocities,","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"r_ij=frac11+delta_ijn_in_junderbraceint_0^infty f(v)sigma(v)vmathrmdv_equiv langlesigma vrangletag62","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"Here f(v) has a different meaning to previous sections where we used f to denote the number density of particles per unit something. Here f is the distribution of relative velocities, which is a normalized property:","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"int_o^infty f(v)mathrmdv=1","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"Luckily for us, if both types of particles have a Maxwellian distribution then f(v) also has a Maxwellian form,","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"f(v)=4pi v^2left(fracm2pi k_mathrmBright)^32expleft(-fracmv^22k_mathrmBTright)quad m=fracm_im_jm_i+m_j","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"Changing integration variable in (62) from velocity to energy (non-relavistic, so E=mv^22) one has","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"langlesigma vrangle=left(frac8pi mright)^12(k_mathrmBT)^-32int_0^infty sigma(E)Eexpleft(-fracEk_mathrmBTright)mathrmdEtag63","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"The whole dependence of the nuclear reaction rate on temperature is then condensed in this factor.","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"For the purpose of solving the equations of stellar structure and evolution we need to know the specific nuclear energy generation rate varepsilon_mathrmnuc. For a reaction rate with a Q-value Q_ij and rate per unit volume r_ij, one has","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"varepsilon_mathrmnuc=fracQ_ijr_ijrho","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"where in practice one adds up over all possible reactions.","category":"page"},{"location":"7_nucleo1/#Tunneling-and-the-Gamow-peak","page":"Notes","title":"Tunneling & the Gamow peak","text":"","category":"section"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"For two nuclei with atomic numbers Z_1 and Z_2, their interaction is described by a potential that is dominated by nuclear forces at very small separations and by the Coulomb potential farther away.","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"(Image: Nuclear potential)","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"If we consider the core of the Sun, which has a temperature of order 10^7 Kelvin, the typical particle energy is sim k_mathrmBTsim mathrmkeV. In a classical picture, we need mathrmMeV energies to go above the Coulomb potential and produce a nuclear reaction. One could think it is still possible considering the high energy tail of a Maxwell-Boltzmann distribution, but the probability of having even a single particle with enough energy is vanishingly small.","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"So, we need quantum mechanics to explain how nuclear reactions can happen at all in the solar core. A particle with momentum p has a corresponding wavelength that characterizes it, called the de Broglie wavelength:","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"lambda = frachbarptext normally gg A^13mathrmfm","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"This allows for quantum tunneling to produce nuclear reactions even if the energy is too low to overcome the Coulomb barrier. Formally computing the cross section while accounting for this shows that the cross section is","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"sigma(E)sim pi lambda^2underbraceexp(-b E^-12)_textTunneling factor","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"where","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"b=2pi fracZ_i Z_j e^2hbarleft(fracm2right)^12=3129 Z_iZ_j A^12mathrmkeV^12","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"Here Aequiv A_iA_j(A_i+A_j) is the reduced mass number. The factor b ensures that different burning stages are well separated in temperature as tunneling of particles with a smaller Z is significantly favored.","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"Since p^2(2m)=E, one usually writes","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"sigma(E)=S(E)fracexpleft(-bE^-12right)Etag64","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"where S(E), called the S-factor, quantifies variations over the regular expected behavior. Often S(E) varies very slowly compared to sigma(E), allowing, for example, to extrapolate cross sections determined in the laboratory to energies relevant to stellar interiors. The S-factor can, however, have strong variations due to particular resonances at specific interaction energies.","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"If we apply equation (64) to equation (63), we find that","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"langlesigma vrangle = f(Tm)int_0^infty S(E)expleft(-bE^-12-fracEk_mathrmBTright)mathrmdEtag65","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"Excluding the S-factor, the exponential term in the integral is such that it peaks at a narrow range of energies, as depicted below.","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"(Image: Gamow peak)","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"This figure shows the value of the exponential term in equation (65) (normalized by its maximum) for different values of the ratio bsqrtk_mathrmBT. These values are chosen to be representative of hydrogen burning at a temperature of 10^7mathrmK, helium burning at 10^8mathrmK and carbon burning at 5times 10^8mathrmK. This function is commonly referred to as the Gamow peak, and can to first order be approximated with a Gaussian function. In that case, if one assumes S(E) does not vary significantly within the range of energies relevant to the Gamow peak, it can be taken off the integral in equation (6.5), which can then be evaluated analytically (see exercises for this session). ","category":"page"},{"location":"7_nucleo1/#Nuclear-burning-stages","page":"Notes","title":"Nuclear burning stages","text":"","category":"section"},{"location":"7_nucleo1/#Main-sequence","page":"Notes","title":"Main sequence","text":"","category":"section"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"As under specific conditions tunneling is favored for the particles with lower Z, the first (and longer-lasting) phase of nuclear burning of a star is that of core-hydrogen burning, were hydrogen is fused into helium. This stage is known as the main-sequence, and the onset of core-hydrogen burning is known as the zero-age main sequence. As a hydrogen atom is composed of a single baryon, while helium consists of 4, we need a series of reactions to build it up. The identification of the specific set of reactions that are dominant in stellar evolution led to the discovery of two different burning processes. The first one is the PP-chain, which in its simpler form (called the PP-I chain), is what one might think as the most natural way to fuse four hydrogen atoms into helium. This is depicted in the figure below.","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"(Image: PP-I chain)","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"However, it is found that for stars with masses above sim 15M_odot, a different and much less intuitive process is dominant, known as the CNO cycle. The CNO cycle uses carbon, nitrogen and oxygen as catalysts, where through a series of hydrogen fusion processes with the CNO elements and beta decays helium can be produced without modifying the total number of CNO atoms. The figure below illustrates the CNO-I (left loop) and CNO-II (right loop) cycles.","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"(Image: CNO-I and CNO_II burning processes)","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"Based on the Gamow peak, nuclear energy production rates can be approximated around a specific temperature in terms of a power-law index nu (see exercises for this session):","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"varepsilon_mathrmnuc=varepsilon_0 rho T^nu","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"For main-sequence stars it is found that for PP burning one has nusimeq4, while for CNO burning nusimeq 18. The scaling of nuclear reactions is incredibly sensitive to temperature!","category":"page"},{"location":"7_nucleo1/#Beyond-the-main-sequence","page":"Notes","title":"Beyond the main sequence","text":"","category":"section"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"After a star depletes its central hydrogen, depending on conditions we'll discuss next chapter, it will start burning heavier elements. In particular, lower mass stars can undergo only a subset of the reactions discussed below. The outcome of the main-sequence is to produce a helium core, at which point the core will lose its energy source and start contracting. This leads to shell burning of hydrogen and potentially the ignition of helium in its core. This process is repeated after core helium exhaustion, resulting on shell helium burning and potentially the ignition of nuclear fusion involving heavier nuclei at its core. Below we indicate the main processes operating after the main-sequence, and the characteristic central temperatures T_mathrmc at which they operate.","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"Helium burning, T_mathrmc10^8mathrmK.\nThe main reaction during this stage is known as the triple-alpha reaction, where three helium atoms (alpha particles) are fused into carbon. The first stage consists on the production of an unstable beryllium atom,\n^4mathrmHe+^4mathrmHeleftrightarrow ^8mathrmBe\nThe half-life of ^8mathrmBe is very short, on the order of 10^-16 seconds, so the beryllium nucleus needs to rapidly fuse with another alpha particle before decaying. The most likely process involves the production of an excited state of carbon, denoted as ^12mathrmC^*, which rapidly decays into the ground state of the carbon nucleus,\n^8mathrmBe+^4mathrmHeleftrightarrow ^12mathrmC^*rightarrow ^12mathrmC+gamma\nThe full triple-alpha process can then be summarized as\n3^4mathrmHerightarrow ^12mathrmC+gamma\nTowards the end of helium burning, as the core temperature increases during this phase, alpha captures on the carbon nucleus also become important,\n^12mathrmC+^4mathrmHerightarrow ^16mathrmO+gamma\nsuch that the end result of core-helium burning is the production of a carbon-oxygen core. The ^12mathrmC(alphagamma)^16mathrmO reaction has important uncertainties at the conditions relevant in stellar interiors, which affects the resulting ratio of carbon and oxygen at the end of helium burning.\nCarbon burning, T_mathrmc5times 10^8mathrmK\nCarbon burning proceeds through the fusion of two carbon nuclei into an excited state of magnesium, which then decays into either neon or sodium:\n^12mathrmC+^12mathrmCrightarrow ^24mathrmMg^*\nbeginarrayl\nrightarrow ^20mathrmNe+alpha\nrightarrow ^23mathrmNa+mathrmp\nendarray\nowing to the large temperature, the released alpha particle or proton in these reactions can rapidly fuse with the surrounding atoms. The net result of core carbon burning is then a core formed of ^16mathrmO, ^20mathrmNe and ^2526mathrmMg.\nNeon burning, T_mathrmc15times 10^9mathrmK\nAlthough one would naturally expect oxygen burning to follow after carbon burning, what happens instead is an endothermic reaction involving neon. The ^20mathrmNe atom is not very stable, and before oxygen ignites there are sufficient high energy photons to destroy the neon atom,\n^20mathrmNe+gammarightarrow ^16mathrmO+alpha\nThis process where high energy photons destroy nuclei is called photodisintegration. As for the case of carbon burning, the resulting alpha particle can rapidly fuse, in particular leading to the production of magnesium,\n^20mathrmNe+gamma rightarrow ^24mathrmMg+gamma\nOxygen burning, T_mathrmc2times 10^9mathrmK\nSimilar to carbon burning, oxygen burning proceeds through the fusion of two oxygen atoms into an excited nuclear state (in this case of sulfur), which then can decay into two different atoms.\n^16mathrmO+^16mathrmOrightarrow ^32mathrmS^*\nbeginarrayl\nrightarrow ^28mathrmSi+alpha\nrightarrow ^31mathrmP+mathrmp\nendarray\nThe resulting proton and alpha particle can quickly fuse with surrounding nuclei, leading to a core composition mostly composed of ^28mathrmSi and ^32mathrmS.\nSilicon burning, T_mathrmc3times 10^9mathrmK\nBy the point oxygen is depleted, the core is mostly composed of silicon, but at this stage the Coulomb barrier of the silicon atom turns out to be prohibitively high, preventing the fusion of two silicon atoms. Instead, high energy photons are actually capable of producing a series of photodisintegration processes, effectively undoing the cycle of nuclear reactions up to this point:\n^28mathrmSi(gammaalpha)^24mathrmMg(gammaalpha)^20mathrmNe(gammaalpha)^16mathrmO(gammaalpha)^12mathrmC(gammaalpha)^242alpha\nSimultaneously, the released alpha particles can fuse with surrounding nuclei, leading to the production of heavier elements:\n^28mathrmSi(alphagamma)^32mathrmS(alphagamma)^36mathrmAr(alphagamma)^40mathrmCa(alphagamma)^44mathrmTi(alphagamma)^32mathrmSdots^56mathrmNi\nThe resulting nickel atom can then decay into ^56mathrmFe, at which point we have reached the nucleus with the highest binding energy. This is a critical stage of evolution, as no exothermic reactions are possible beyond that stage. The end result is that the iron core will grow until a point where it experiences a dynamical core-collapse phase, potentially producing a compact object (neutron star or black hole) with an associated supernova event.","category":"page"},{"location":"7_nucleo1/","page":"Notes","title":"Notes","text":"The end result of all these burning processes is that the star ends up with an onion-layer like structure, with the deeper regions of the star corresponding to the later nuclear burning phases.","category":"page"},{"location":"8_instructions/#Instructions","page":"Instructions","title":"Instructions","text":"","category":"section"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"Modules for Experiments in Stellar Astrophysics (MESA) [Paxton2011] is a state of the art, open-source 1D stellar evolution code. MESA is built to allow users to run experiments in stellar evolution, with a huge variety of possibilities for input physics and customization. You are strongly encouraged to give a look at the documentation to discover more about the software. We will specifically use the MESAstar module to evolve a single star.","category":"page"},{"location":"8_instructions/#Lab-intro","page":"Instructions","title":"Lab intro","text":"","category":"section"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"In this lab you will learn how to evolve a star with MESA and how to interpret its outputs in terms of the theory of stellar structure and evolution you have seen so far. In particular","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"FIRST HOUR: see Stellar evolution models. Theoretical overview of the software. The basic numerical scheme used to solve the set of stellar structure and evolution equations; the boundary conditions for the differential equations; the software infrastructure and usage of inlists, output files.\nSECOND HOUR: set up your simulation and save the outputs in your local machines / USB memory / personal folder in the system, as you will need to use it at home to post-process the information and write a report. This time at the lab is mainly meant for you to run the simulation while you have someone that can help you (me); if, at the end, you still have some time, you can start answering the questions of the report.   NB: you will have to run two simulations of two stars with different masses, and save both those outputs. Be sure to do that before you leave the session. ","category":"page"},{"location":"8_instructions/#The-report","page":"Instructions","title":"The report","text":"","category":"section"},{"location":"8_instructions/#General-rules","page":"Instructions","title":"General rules","text":"","category":"section"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"If you still have time during the second hour of the session, you can start going through the list of requests below. You will have to produce a (graded!) report about these. Try to answer to all questions completely: ","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"Are you asked for a number?   If this number comes from a formula, show the formula introducing the quantities appearing in it, as well as under which physical assumptions that specific formula holds. E.g., if you're computing a gravitational energy E_mathrmgr, we would like you to write something like:\n\nThe estimate for the gravitation potential energy E_mathrmgrav is:\nE_mathrmgrequiv int_0^M -dfracGmr(m) dm= 314times 10^7 mathrmerg\nwhere G is the gravitational constant, M is the total star mass and r=r(m) is the Eulerian radial coordinate along the star's structure.\n","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"If the number comes directly out of your simulation, be sure to explicitly say where you found this information: which column of the output file are you using, and at which stage of the evolution of your system? ","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"Are you asked for a derivation?   We would like to see the math with clear passages.\nAre you asked for a plot?     You can use whichever visualization tool you want to produce plots. Just be sure to make them readable: fontsize of any label / tick / legend must be the same as the written text. And everything needs to be properly labeled. Number the plots as Fig.(1), Fig.(2) ... Fig.(n) and refer to those in the text, when you describe how such figure illustrates the answer to the question.","category":"page"},{"location":"8_instructions/#Formalities","page":"Instructions","title":"Formalities","text":"","category":"section"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"PAGE LIMIT   Maximum of 12 pages (including figures) with classical font and fontsize (geq 12pt please). Include your name and student number on the first page of the PDF.\nDo NOT exceed the page limit. I will not correct any additional page beyond the 12th, no exception made for the bonus exercises.\nSUBMISSION FORMAT    Submit a tar / zip named as name_lastname_XMsun_LAB1.zip, where X is defined as M=XM_odot and M is the mass of your assigned star (see below!). Remember to always include your inlist_project in the submission.\n🚨 ATTENTION: Reports are individual: each student is expected to hand in his/her own report 🚨","category":"page"},{"location":"8_instructions/#Grades-and-deadlines","page":"Instructions","title":"Grades and deadlines","text":"","category":"section"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"The idea is that you go through every question; the final question (Bonus: Radiative Opacities) can give you bonus points for the final exam, but if you address all the other requests correctly and completely, you will be able to get the full grade of the report anyway. You will be given approximately 4 weeks to complete the report and send it to us.","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"GRADES Points for each question are made explicit in the text. The maximum is 16 points / 16. Let us say that you totalize N points / 16: in total, this report will weight N / 4 grades out of your final 20! So if you manage to score full grade in this report, 4 points out of your final 20 are granted. Good luck! 🍀\n▶️ DEADLINE  Report must be completed by  3 December, 14:00 CET. No extension possible!\nTO BE SENT Via email to annachiara.picco@kuleuven.be, with the subject of the email matching the name of the attached zip / tar file, i.e. something like name_lastname_XMsun_LAB1.zip.","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"<!– - RETAKE EXAM RESUBMISSION If you are planning to do the retake exam in August, you will be able to resubmit both your reports for LAB1 and LAB2, with deadline strictly before the retake day, no extension possible. The reports will be graded again and the new grades will be used to recalculate your overall grade with your written retake exam.  –>","category":"page"},{"location":"8_instructions/#MESA-instructions","page":"Instructions","title":"MESA instructions","text":"","category":"section"},{"location":"8_instructions/#The-lab-computers","page":"Instructions","title":"The lab computers","text":"","category":"section"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"MESA (v15140) is already installed in the machines of the room 4.33 (4th floor, Instituut voor Sterrenkunde). You will not be required to install any additional package. However, to be able to complete the simulation runs, you will have to access the IvS system with your personal credentials. At the start of your Master in Astronomy & Astrophysics at KU Leuven, you should all have received those credentials. Some of you that are not part of the Master in Astronomy and Astrophysics and I already asked for an account to be set up for you: you should have received an email with the details. If not, please come talk to me as soon as possible.","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"To be able to run MESA from a folder of your choice, you need to set the Linux environment variables to tell your terminal where to find the software. To do so, open a terminal with ctrl+shift+T and type the following:","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"# Set the environment variables\nmodule load mesasdk\nmodule load mesa\n# Check that everything is correct\necho $MESA_DIR\necho $MESASDK_VERSION","category":"page"},{"location":"8_instructions/#The-MESA-work-folder","page":"Instructions","title":"The MESA work folder","text":"","category":"section"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"In the following, I am going to assume that you are working in a folder called MESA_LAB1; you should adapt the commands to the (path of the) folder you chose to use.","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":" # Move to the directory of your choice\n cd MESA_LAB1","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"After running a simulation, this folder will contain the following elements:","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"inlist    Fortran namelist pointing to the specific inlist for the project.","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"inlist_project   Fortran namelist containing all the options for the simulation; these include input physics as well as resolution controls. It is always advisable to give a look at the options and try to understand their meaning, by digging into the parameter libraries in $MESA_DIR/star/defaults/*. These files contain default values for all the options present in your inlist_project, as well as their explanation and reference in literature.\ninlist_pgstar  Fortran namelist specific for the pgstar dynamic window. You can give a look at the default parameters for the pgstar inlist by looking through $MESA_DIR/star/default/pgstar.defaults.\nLOGS   Folder containing all the output files: evolutionary quantities in history.data, profiles information in profileN.data. Profiles are mapped to model numbers as illustrated in profiles.index. The profile files are printed at regular intervals during the simulation, see the option profile_interval = 10 in your inlist_project.\nphotos    Folder containing the simulation photos: files named xN, with N being the photo's number, in machine-language. These are also printed at regular intervals during the simulation, see the option photo_interval = 10 in your inlist_project, and contain all the information about models. They are useful to be able to restart the simulation from different points along the track, in case your run is time-consuming and you want to save some time. You should not need to use those in this lab1.\ngrid_png   Folder containing png snapshots of the pgstar dynamic window: these are called as grid_N.png, where N is the model number along the evolutionary track. These are also printed at regular intervals, see the option Grid1_file_interval = 10 in your inlist_project.\nprofile_columns.list   List of all the information, about structural properties of a model at fixed time, that are printed in the output files profileN.data, and used in the pgstar dynamic window.\nhistory_columns.list   List of all the information, about evolutionary quantities along the track, that are printed in the output file history.data, and used in the pgstar dynamic window.","category":"page"},{"location":"8_instructions/#How-to-run-MESA","page":"Instructions","title":"How to run MESA","text":"","category":"section"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"You will always run MESA from the folder called MESA_LAB1. In such folder, there is a very nicely written README.rst file with a reminder on how to run / compile (and restart, when needed) the simulation. Download the input files from here inputfilesLAB1, and put them inside the MESA_LAB1 folder.","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"# Move to the directory of your choice\ncd MESA_LAB1\n# Decompress the downloaded file\ntar -xf lab1_input.tar.xz\n# Copy all the input files and put them in place of the ones already present in the MESA_LAB1 folder\ncp -R ./lab1_input/* .","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"I'm summarizing herebelow the general instructions for future reference (but don't run the simulation now! Just keep these in mind and we'll use them in a bit):","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"# Move to the MESA_LAB1 directory if you're not there already\ncd MESA_LAB1\n# Compile and produce the executable called \"star\"\n./mk\n# Run the simulation\n./rn\n# Restart the simulation from the photo x050\n./re x050","category":"page"},{"location":"8_instructions/#Reading-MESA-output","page":"Instructions","title":"Reading MESA output","text":"","category":"section"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"Just to save you some time: here's a minimal working script in python that reads the output of MESA stored in a history.data file. There are more efficient ways when the output is large, but for the purpose of this lab you can start from here.","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"# Import numpy\nimport numpy as np\n# Give the relative path of the file\nhistory = \"./LOGS/history.data\"\n# Save the information in a matrix saving their names too\nmatrix = np.genfromtxt(history,skip_header=5,names=True)\n# Load the columns of interest for an HR diagram\nlumi = matrix[\"luminosity\"]\nteff = matrix[\"log_Teff\"]","category":"page"},{"location":"8_instructions/#The-assigned-masses","page":"Instructions","title":"The assigned masses","text":"","category":"section"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"Due to the number of available computers in the lab, you all will be paired during the session. This means that every student (A) will have a mate (B) to look at the simulations with. Each team (student A + student B) of students will have to produce, during the session, a total of two simulations (simulation 1 + simulation 2), and save the outputs for later use (at home). These two simulations will serve the following purposes:","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"Simulation 1  will evolve a star of initial mass M. Student A will have to answer all the questions, aside from Massive vs Low Mass evolution and a small part of the question on Variations of the EoS: Radiation Pressure and Degeneracy, by taking into account exclusively the outcome of simulation 1. Student B will make use of the outcome of simulation 1 just to answer the aforesaid question.\nSimulation 2 will evolve a star of initial mass Mneq M. Student B will have to answer all the questions, aside from  Massive vs Low Mass evolution and a small part of the question on Variations of the EoS: Radiation Pressure and Degeneracy, by taking into account exclusively the outcome of simulation 2. Student A will make use of the outcome of simulation 2 just to answer the aforesaid question.","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"Please find below the list of pairs of masses, together with the team (student A + student B) number. I'll give you the team number once you're paired in the lab and make sure that no pairs of masses is picked by two different teams.","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"Team number M(M_odot) M(M_odot)\n1 0.8 4.25\n2 1 3\n3 1.15 2.25\n4 2 8.75\n5 5.5 1.2\n6 6 2.15\n7 7 2.25\n8 7.5 1.75\n9 8 0.8","category":"page"},{"location":"8_instructions/","page":"Instructions","title":"Instructions","text":"[Paxton2011]: The Astrophysical Journal Supplement, Volume 192, Issue 1, article id. 3, 35 pp. (2011). https://ui.adsabs.harvard.edu/abs/2011ApJS..192....3P/abstract","category":"page"},{"location":"1_introduction_problems/#Exercises","page":"Exercises","title":"Exercises","text":"","category":"section"},{"location":"1_introduction_problems/#List-of-exercises","page":"Exercises","title":"List of exercises","text":"","category":"section"},{"location":"1_introduction_problems/#1:-Timescales-of-stellar-evolution","page":"Exercises","title":"1: Timescales of stellar evolution","text":"","category":"section"},{"location":"1_introduction_problems/","page":"Exercises","title":"Exercises","text":"There are three main timescales in which stars evolve. These are the dynamical, thermal and nuclear timescales. Even without knowing the equations of stellar structure and evolution we can do some estimates on the value of these quantities. Compute these without a calculator! We only care about the order of magnitude of these timescales, which given all the approximations done is all we can do. For solar properties, use the following for the mass, radius and luminosity:","category":"page"},{"location":"1_introduction_problems/","page":"Exercises","title":"Exercises","text":"R_odotsim 7times 10^10mathrmcmquad M_odot sim 2times 10^33mathrmgquad L_odot sim 4times 10^33mathrmergs^-1","category":"page"},{"location":"1_introduction_problems/","page":"Exercises","title":"Exercises","text":"Thermal timescale: One of the main early hypothesis to explain the energy   source of the Sun was that it originated from its slow contraction into its own   gravitational potential. In such a case, a rough estimate of the energy the Sun   would have radiated through its life is given by the negative of the   gravitational potential energy E_mathrmg:\nE_mathrmg sim displaystyle -fracGM_odot^2R_odot\nAssuming that the luminosity of the Sun has always been its current one,   L_odot, compute the age of the Sun under the assumption that it is only   powered by contraction. You can use Gsim 6times 10^-8 mathrmcm^3g^-1s^-2\nDynamical timescale: For most of their lives stars are very close to","category":"page"},{"location":"1_introduction_problems/","page":"Exercises","title":"Exercises","text":"hydrostatic equilibrium, carefully balancing their gravities against the support of a pressure gradient. Whenever these two forces are misbalanced, the star will evolve in what is known as the dynamical timescale. Estimate this timescale by computing the time it would take for the surface of the sun to free-fall all the way to its center if all forces opposing gravity would be removed. For simplicity assume that the gravitational acceleration is constant and equal to its present one.","category":"page"},{"location":"1_introduction_problems/","page":"Exercises","title":"Exercises","text":"Nuclear timescale: As we now know, most stars are powered by nuclear","category":"page"},{"location":"1_introduction_problems/","page":"Exercises","title":"Exercises","text":"reactions. Masses of isotopes are normally given in terms of the atomic mass unit m_mathrmu=1661times 10^-24mathrmg, defined as 112 of the mass of a carbon-12 atom. The mass of a hydrogen atom is m_mathrmH=1007825m_mathrmu and that of a helium atom is m_mathrmHe=4002602 m_mathrmu, such that if four hydrogen atoms are fused into a helium atom there is a mass deficit leading to a release of energy (4m_mathrmH-m_mathrmHe)c^2sim 4times 10^-5mathrmerg. With this information, estimate the lifetime of the Sun as a core-hydrogen burning star. For simplicity, assume the Sun has a constant luminosity and is entirely composed of hydrogen, 10% of which is burned into Helium during core-hydrogen burning.","category":"page"},{"location":"1_introduction_problems/#Solutions","page":"Exercises","title":"Solutions","text":"","category":"section"},{"location":"1_introduction_problems/#1:-Timescales-of-stellar-evolution-2","page":"Exercises","title":"1: Timescales of stellar evolution","text":"","category":"section"},{"location":"1_introduction_problems/","page":"Exercises","title":"Exercises","text":"Thermal timescale:   Assuming the Sun started its life as a diffuse expanded cloud, covering a distance much larger than its current radius, we can take its initial gravitational energy to be much smaller than the current one (E_gmathrmill E_g). In that case the sun has radiated a total energy sim E_g and we can compute the time it has taken to do so dividing by its luminosity. The resulting timescale is known as the Kelvin-Helmholtz timescale,\ndisplaystyletau_mathrmKH = fracGM_odot^2R_odot L_odotsim frac6times 10^-8 cdot(2times 10^33)^27times 10^10cdot 4times 10^33 mathrms\nWe care about orders of magnitude, so we can eliminate nearly equal factors,\ndisplaystyletau_mathrmKH sim fraccancel6times 10^-8 cdot cancel4times 10^66cancel7times 10^10cdot cancel4times 10^33 mathrms = 10^15mathrms\nThat is a lot of seconds. It is easier to read in terms of years. Approximately, 1mathrmyr=3times 10^7mathrms, so\ndisplaystyletau_mathrmKH sim frac10^153times 10^7mathrmyr = frac1310^8mathrmyrsim 3times 10^7mathrmyr\nwhere I used that 13sim 3times 10^-1. The thermal timescale is then of the order of tens of millions of years, much shorter than the age of the Sun. Before it was understood that the Sun was powered by hydrogen fusion it was the accepted model that gravitational contraction was its energy source, but as the age of the Earth became constrained through radiometric dating, it was seen that that could not possibly be the case. One small caveat that we will see later on is that part of the gravitational energy is not radiated, but rather heats up the star. However, this only lowers the timescale by a factor of sim 2.\nDynamical timescale: The surface gravity of the Sun is g=GM_odotR_odot^2.   An object falling during a time t with a constant acceleration, and starting   at rest, travels a distance\ndisplaystyle d=frac12gt^2\nWe get the dynamical timescale by equating this to the solar radii, and naming the time t as tau_mathrmdyn\ndisplaystyle tau_mathrmdyn=sqrtfrac2R_odotg=sqrtfrac2R_odot^3GM_odottag1\nThe ratio M_odotR_odot^3 is (except for a constant factor), equal to the average density of the Sun langle rho rangle_odot, so often the dynamical timescale of a star is expressed as\ndisplaystyle tau_mathrmdynsimsqrtfrac1Glangle rho rangle_odot\nGoing back to Equation (1), let's evaluate it:\ndisplaystyle tau_mathrmdynsim sqrtfrac2cdot 7^3times 10^306times 10^-8cdot 2times 10^33mathrms\nAgain, we are doing an order of magnitude calculation, so we play a bit freely with elimination of terms,\ndisplaystyle tau_mathrmdynsimsqrtfraccancel2cdot 7^cancel32times 10^30cancel6times 10^-8cdot cancel2times 10^33mathrmssim sqrt7^2times 10^5mathrms\nOne can approximate 10^05sim 3 to obtain\ndisplaystyle tau_mathrmdynsim 7times 3times 10^2mathrmssim 2times 10^3mathrms\nWhich is about half an hour. We see that the timescale for dynamical adjustments is dramatically lower than the timescale for thermal adjustments!\nNuclear timescale: The number of hydrogen atoms that will be burned is given by\ndisplaystyle N=01fracM_odotm_mathrmH\nand the energy released per hydrogen atom that is burned is 10^-5mathrmerg. The Nuclear timescale can then be estimated as:\ndisplaystyle tau_mathrmnuc=fracNtimes 10^-5mathrmergL_odot\nLet's evaluate this, using m_mathrmHsim 2times 10^-24 for simplicity,\ndisplaystyle tau_mathrmnucsimfrac10^-1cdot 2times 10^33cdot 10^-52times 10^-24cdot 4 times 10^33sim frac12times 10^18mathrms\nAgain, that's a lot of seconds. Let's write it in years:\ndisplaystyle tau_mathrmnucsim frac(12)times 10^183times 10^7mathrmyr=frac16times 10^11mathrmyrsim 20 mathrmGyr\nWhere I have expressed the final result in units of Gigayears (equal to 10^9 years). Again, we see that this is very different from the other two timescales. These three timescales are the fundamental evolutionary timescales of stars, and as they differ significantly, it means that the rate of change of properties of a star can be very different depending on the nature of its evolution.","category":"page"},{"location":"1_introduction/#Introduction","page":"Notes","title":"Introduction","text":"","category":"section"},{"location":"1_introduction/","page":"Notes","title":"Notes","text":"Slides for the introductory session can be found here.","category":"page"},{"location":"4_eos2/#Degenerate-equations-of-state","page":"Notes","title":"Degenerate equations of state","text":"","category":"section"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"Goals","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"Derive how u and P are obtained from a distribution of momenta\nPauli exclusion principle and degeneracy\nNon-relativistic and extremely relativistic limits of a degenerate EOS\nPolytropes & the Chandrasekhar mass","category":"page"},{"location":"4_eos2/#Deriving-u-and-P","page":"Notes","title":"Deriving u and P","text":"","category":"section"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"We will consider a distribution of momenta, such that the number of particles with momentum between p and p+mathrmdp in a volume mathrmdV is","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"N(pp+mathrmdp)=f(p)mathrmdpmathrmdV","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"One example for f(p) is the Maxwell-Boltzmann distribution,","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"f(p)=displaystyle nfrac4pi p^2(2pi m k T)^32expleft(-fracp^22m k Tright)","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"which has a maximum at","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"p_mathrmmax=(2m k T)^12","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"This distribution corresponds to the momenta of particles of mass m in an ideal monoatomic gas. In the case of an ionized gas, or a gas with multiple ions of different type, each component follows the distribution with their corresponding mass and particle density. For instance, for free electrons we have","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"n_e = displaystylefracrhomu_e m_u","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"where m_u is the atomic mass unit and mu_e is the mean molecular weight per electron. The quantity mu_e can be read as the number of atomic mass units in the fluid per electron, which means that for pure ionized hydrogen mu_esimeq1, while for pure ionized helium mu_esimeq2.","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"If each particle has an energy E(p), then the specific internal energy of the gas is","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"u = frac1rhoint_0^infty E(p)f(p)mathrmdpquad E(p)=mc^2sqrtdisplaystyle 1+fracp^2m^2c^2","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"as the integral gives the internal energy per unit volume, which is turned into the specific internal energy by multiplying by the specific volume rho^-1.","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"Computing pressure is a bit more complex. Consider a slab of area mathrmdsigma embedded in the gas, on which particles will be bouncing,","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"(Image: asdf)","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"A particle with momentum p colliding at an angle theta with respect to the normal will transfer momentum equal to","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"Delta p = 2pcostheta tag31","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"The pressure corresponds to a force per unit area, and a force corresponds to a change in momentum per unit time. This means that if we know the rate of collisions per unit time and direction on mathrmdsigma we can integrate over all directions to get the pressure. Let's consider particles coming from a direction thetaphi, which cover a solid angle mathrmdvecOmega in the direction of their momenta p and hit the slab mathrmdsigma,","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"(Image: asdf)","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"As the distribution is isotropic, the number of particles with momenta between p and p+mathrmdp contained in the solid angle mathrmdvecOmega is","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"N(pp+mathrmdpmathrmdvecOmega)=fracf(p)4pimathrmdpmathrmdVmathrmdOmega","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"next we need to know how many particles per unit time, unit momenta and unit solid angle will cross the slab. If we consider particles with momentum p hitting the slab at an angle theta, and take the velocity v_p for a given momentum, then in a time Delta t all particles in an area v_pcosthetamathrmdsigmaDelta t will cross the slab.","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"(Image: asdf)","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"The number of collisions per unit time onto the slab, with momenta between p and p+mathrmdp coming from a solid angle mathrmdvecOmega is","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"r_mathrmcoll=fracf(p)4piv_pcosthetamathrmdthetamathrmdsigmamathrmdrhomathrmdOmega","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"Each of these collisions imparts a momentum Delta p given by equation (31). The pressure is then obtained by integrating over all angles in a half sphere and dividing by mathrmdsigma:","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"P=int_0^inftyint_0^2piint_0^pi2 2pcostheta cdot fracf(p)4piv_pcostheta sintheta mathrmdthetamathrmdphimathrmdp","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"P=frac12piint_0^infty v_p p f(p)mathrmdp int_0^2pimathrmdphi int_0^pi2cos^2thetasintheta mathrmdtheta","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"boxedP=frac13int_0^infty v_p p f(p)mathrmdptag32","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"where we used mathrmdOmega=sinthetamathrmdthetamathrmdphi. We already saw in the exercises last class how this expression gives the ideal gas pressure for a Maxwell-Boltzmann distribution.","category":"page"},{"location":"4_eos2/#Pauli-exclusion-principle-and-degeneracy","page":"Notes","title":"Pauli exclusion principle and degeneracy","text":"","category":"section"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"If we were to take a Maxwell-Boltzmann distribution and lower the temperature towards zero, all particles would tend to zero momentum. As electrons, protons and neutrons have half spin (ie. they are fermions), this cannot happen as they must satisfy the Pauli exclusion principle. If a particle has an uncertainty in momentum equal to mathrmd^3 p and an uncertainty in position mathrmd^3 x then we must have","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"mathrmd^3 pmathrmd^3xh^3","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"where h is Planck's constant. Pauli's exclusion principle indicates that only two fermions can occupy a quantum cell of 6-D volume h^3. Gases for which their properties become affected by this quantum limit are referred to as Degenerate.","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"Now let's think that all particles go to their lower energy state. If we consider a volume mathrmd^3x, then each particle will occupy a momentum space","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"mathrmd^3p=frach^32mathrmd^3 x","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"As they go to the lowest possible energy states, we can think they fill a sphere in momentum space up to a value p_mathrmF, known as the Fermi momentum:","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"(Image: asdf)","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"The volume in momentum is simply","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"int_0^p 4pi p^2 mathrmd p = frac4pi3p_mathrmF^3","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"Since we know each cell occupies a 3-D momentum-space volume h^3(2mathrmd^3x), the number of particles in mathrmd^3x should be:","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"N=nmathrmd^3x = fracleft(displaystyle frac4pi3p_mathrmF^3right)displaystyle left(frach^32mathrmd^3xright)=frac8pi3h^3p_mathrmF^3 mathrmd^3 x","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"rightarrow n=frac8pi3h^3p_mathrmF^3","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"This expression allows us to compute the Fermi momentum if we know the particle density of the medium, meaning that for a given density, we know the radius in momentum space that would be occupied by particles if the sink towards the lowest energy state allowable by quantum mechanics.","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"So what is f(p)? Between momenta p and p+mathrmdp we have a volume in momentum equal to V_mathrmp(pp+mathrmdp)=4pi p^2mathrmdp The number of particles in this momentum shell within the volume mathrmd^3 x is N(pp+mathrmdp)=frac4pi p^2 mathrmdpdisplaystyleleft(frach^32mathrmd^3 xright) which from the definition of f(p) means that $\\boxed{f(p)= \\begin{cases} \\displaystyle \\frac{8\\pi}{h^3}p^2 & p<p\\mathrm{F} \\\n0 & p>p\\mathrm{F}. \\end{cases}}\\tag{3.3} $","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"So how does this compare to a Maxwell-Boltzmann distribution? The image below (source to produce this figure available here) shows the Maxwell Boltzmann distribution of electron momenta for different temperatures at the mass density of the solar core (sim 150mathrmgcm^-3). The hydrogen mass fraction at the solar core is Xsimeq 035, and the electron number density can be determined under the assumption of full ionization using the approximation mu_e=2(1+X).","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"(Image: Degeneracy at solar core)","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"The temperature at the core of the Sun is sim 15times 10^7mathrmK, and we see that at the conditions of the solar center a Maxwell-Boltzmann distribution does not violate the Pauli exclusion principle. However, this is not the case as the temperature is lowered, and we see that if the solar core would instead have a temperature of a million Kelvin we expect significant quantum effects to play a role. In practice, one has a soft transition between the Maxwell-Boltzmann distribution and the distribution of a fully degenerate gas (equation 33).","category":"page"},{"location":"4_eos2/#Non-relativistic-and-extremely-relativistic-regimes-of-a-degenerate-EOS","page":"Notes","title":"Non-relativistic and extremely relativistic regimes of a degenerate EOS","text":"","category":"section"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"Within a mixture of ions and electrons, as density increases electrons will be the first to become degenerate (see the exercises) and dominate the gas pressure. This is the case in white dwarf interiors. Since we have","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"n_e = fracrhomu_e m_mathrmu","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"the Fermi momentum is","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"p_mathrmF=left(frac3h^38pifracrhomu_e m_mathrmuright)^13","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"and for the case of full degeneracy, the distribution of momenta is given by equation (33). We can then use equation (32) to evaluate the pressure. The integral depends on the value of the velocity as a function of momentum, which can be obtained from the relationship","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"p = fracm_e v_psqrt1-v_p^2c","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"The pressure integral has an analytical solution in this general case, but it is much more instructive to explore two limiting cases in which the relationship between velocity and momentum is simpler:","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"Non relativistic: In this case we have the simple classical relationship   displaystyle v_p=fracpm_e\nExtremely relativistic: As the electron density increases, the fermi momentum becomes larger and larger, and eventually the majority of the electrons will have vsim c. The extremely relativistic limit considers the case where we take for all particles   v_p = c","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"In both cases the integral for the pressure comes out to be a simple integral over a power of p (see exercises). The pressure in the two limits turns out to be a polytrope with a specific polytropic index n,","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"P_mathrmNR = frac120left(frac3piright)^23frach^2m_e m_mathrmu^53left(fracrhomu_eright)^53tagn=32","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"P_mathrmER=left(frac3piright)^13frachc8m_mathrmu^43left(fracrhomu_eright)^43tagn=3","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"Since the equations of state in these limiting cases are polytropes, we can make use of the Lane-Emden equation to describe stars that follow them!","category":"page"},{"location":"4_eos2/#Polytropes-and-the-Chandrasekhar-mass","page":"Notes","title":"Polytropes and the Chandrasekhar mass","text":"","category":"section"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"Let's recap the Lane-Emden equation. If we have a polytropic EOS","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"P=Krho1+1n","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"then a hydrostatic model satisfies the equation","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"frac1zfracmathrmdmathrmdzleft(z^2fracmathrmdwmathrmdzright) = -w^nquad w(0)=1quad w(0)=0","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"where","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"rho = rho_mathrmc (w(z))^nquad P=P_mathrmc(w(x))^n+1","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"and","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"r = r_nzquad r_n^2 = frac(n+1)P_mathrmc4pi G rho_mathrmc^2","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"The surface is located at the value z_n where the function has its first zero.","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"(Image: Degeneracy at solar core)","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"As part of the exercises it was also shown that the total mass of a polytropic model is","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"M=4pi r_n^3 rho_mathrmcleftleft(-z^2fracmathrmdwmathrmdzright)right_z=z_ntag34","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"and that if K is fixed, we have a mass radius relationship,","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"Rpropto M^betaquad beta=frac1-n3-n","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"let's consider first the non-relativistic case, where n=32 which gives us beta=-13. This means that more massive degenerate stars are more compact. In turn, this also means that their Fermi momentum is higher everywhere (as it increases with density), making them more relativistic. As the mass keeps increasing, we'd expect a star to approach the extremely relativistic regime, for which n=3. However this would give us an undefined beta, meaning the mass radius relationship is not defined. Why is this the case?","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"Using the definition of r_n we can rewrite (43) as","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"M=4pi left(frac(n+1)P_mathrmc4pi G rho_mathrmcright)^32rho_mathrmcA_n","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"where A_n is just a constant that depends on the polytropic index. Ignoring all constants (either fixed values from solutions to the Lane-Emden equation or fundamental constants) we find that","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"Mpropto fracP_c^32rho_c^2=left(fracP_mathrmc^3rho_c^4right)^12","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"But in the extremely relativistic ,case P_mathrmcpropto rho_c^43, meaning that in this limit M has a unique value which is just a function of fundamental constants! If we properly evaluate all those constants we find that this mass (known as the Chandrasekhar mass) is:","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"M_mathrmCh=frac5836mu_e^2M_odot","category":"page"},{"location":"4_eos2/","page":"Notes","title":"Notes","text":"which is equal to 146M_odot for mu_e=2, characteristing of white dwarf composition. This is a fundamental limit for the mass of a star supported by electron pressure degeneracy.","category":"page"},{"location":"6_convection_problems/#Exercises","page":"Exercises","title":"Exercises","text":"","category":"section"},{"location":"6_convection_problems/#List-of-exercises","page":"Exercises","title":"List of exercises","text":"","category":"section"},{"location":"6_convection_problems/#1:-The-Ledoux-criterion","page":"Exercises","title":"1: The Ledoux criterion","text":"","category":"section"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"As a star undergoes nuclear burning, it produces a composition gradient in its interior. This composition gradient affects the Brunt-Väisälä frequency and thus the stability criterion for convection. Consider an equation of state where this composition dependence is characterised by the mean molecular weight mu of the fluid, such that rho=rho(PTmu) and","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"fracdrhorho=alphafracdPP-deltafracdTT+varphifracdmumu","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"where","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"alphaequiv left(fracpartial ln rhopartial ln Pright)_Tmuquad\ndeltaequiv -left(fracpartial ln rhopartial ln Tright)_Pmuquad\nvarphiequiv left(fracpartial ln rhopartial ln muright)_PT","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"Show that for an adiabatic displacement of a mass element at a subsonic velocity (such that the pressure of the surrounding medium and the element equalizes), the stability criterion is:","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"nablanabla_mathrmad+fracvarphideltanabla_muquad nabla_muequiv left(fracd ln mud ln Pright)_mathrms","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"where nabla_mu describes the composition gradient of the medium surrounding the displaced mass element. This is known as the Ledoux criterion. Remember that for stability we require that","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"left(fracdrhodrright)_mathrme-left(fracdrhod rright)_mathrms0","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"where mathrme and mathrms stand for the properties of the environment and the surrounding. We can assume the displaced mass element has a constant mu. Radial derivatives can be turned into pressure derivatives by multiplication with the pressure scale height H_Pequiv -P drdP.","category":"page"},{"location":"6_convection_problems/#Core-convection","page":"Exercises","title":"Core convection","text":"","category":"section"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"Consider the radiative temperature gradient","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"nabla_mathrmrad=frac316pi a c Gfrackappa l Pm T^4","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"And the adiabatic temperature gradient, which for an ideal gas without radiation gives","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"nabla_mathrmad=fracPdeltaTrho c_P=frac25","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"Near the core of a star undergoing some form of nuclear burning in thermal equlibrium, we have from the energy equation that","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"fracpartial lpartial m=varepsilon_mathrmnuc","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"For a star with a given central value of the nuclear energy generation rate varepsilon_mathrmnucc, as a well as a known central pressure P_mathrmc and central temperature T_mathrmc, determine the value of nabla_mathrmrad at its core. You will need to determine l(m) near the center of the star.\nA detailed model of the Sun with a metallicity Z=002 and a hydrogen mass fraction X=07 has, at the onset of core hydrogen burning, varepsilon_mathrmnuccsimeq 14mathrmergs^-1g^-1, P_mathrmc=15times 10^17mathrmdyncm^-2 and T_mathrmc=14times 10^7mathrmK. Do you expect its core to be convective or radiative? Take the value nabla_mathrmad=25, which corresponds to an ideal monoatomic gas. Take also kappa=02(1+X)mathrmcm^2g^-1 which corresponds to the electron scattering opacity and is a good approximation at the core of a hydrogen burning star.\nAnswer the same question but for a 10 M_odot star, from which a detailed model gives varepsilon_mathrmnuccsimeq 34times 10^4mathrmergs^-1g^-1, P_mathrmc=40times 10^16mathrmdyncm^-2 and T_mathrmc=32times 10^7mathrmK.","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"You will need the following constants:","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"asim 76times 10^-15mathrmergcm^-3K^-4\nGsim 67times 10^-8mathrmcm^3g^-1s^-2\ncsim 3times 10^10mathrmcms^-1.","category":"page"},{"location":"6_convection_problems/#Envelope-convection-in-the-Sun","page":"Exercises","title":"Envelope convection in the Sun","text":"","category":"section"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"Stars with the mass of the Sun are expected to have an outer convective envelope. How much superadiabaticity (meaning, nabla-nabla_mathrmad) is actually required to drive the solar luminosity through it? Ignoring energy losses from radiation for convective elements we have estimated the energy flux to be","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"F_mathrmcon=rho c_P T sqrtg deltafracl_m^24sqrt2H_P^-32(nabla-nabla_mathrmad)^32","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"In the mixing length model, it is common to take l_mathrmMLT=alpha_mathrmMLT H_P, where alpha_mathrmMLT is a dimensionless quantity. From a detailed stellar evolution model similar to the sun, one finds that at r=08R_odot the star is unstable to convection and has:","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"m(r=08R_odot)= 099M_odot You can just approximate this as M_odot.\nrho(r=08R_odot)sim 01mathrmgcm^-3\nT(r=08R_odot)sim 1times 10^6mathrmK\nP(r=08R_odot)sim 2times 10^13mathrmdyncm^-2","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"Taking alpha_mathrmMLT=1, what is the value of nabla-nabla_mathrmad required to carry the entire luminosity L_odot of the Sun through convection at this point?","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"To compute the pressure scale height H_P=-P drdP you will need to make use of the equation of hydrostatic equilibrium,","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"fracdPdr=-fracGm(r)rhor^2","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"For delta and c_P take the values that correspond to an ideal monoatomic gas without radiation,","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"delta=1quad c_P=frac52frack_Bmu m_u","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"and for the purpose of this exercise you can just approximate musim 12, which corresponds to an ionized hydrogen gas.","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"Additional constants you will require:","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"Gsim 7times 10^-8mathrmcm^3g^-1s^-2\nM_odot sim 2times 10^33mathrmg\nR_odot sim 7times 10^10mathrmcm\nL_odot sim 4times 10^33mathrmergs^-1\nk_Bsim 1 times 10^-16mathrmergK^-1\nm_mathrmusim 2times 10^-24mathrmg","category":"page"},{"location":"6_convection_problems/#Solutions","page":"Exercises","title":"Solutions","text":"","category":"section"},{"location":"6_convection_problems/#1:-The-Ledoux-criterion-2","page":"Exercises","title":"1: The Ledoux criterion","text":"","category":"section"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"Using the expression for drhorho, we find that","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"frac1rholeftleft(fracdrhodrright)_mathrme-left(fracdrhod rright)_mathrmsright = fracalphaPleft(fracd Pdrright)_mathrme -fracdeltaTleft(fracd Tdrright)_mathrme+fracvarphimuleft(fracd mudrright)_mathrme-fracalphaPleft(fracd Pdrright)_mathrms+fracdeltaTleft(fracd Tdrright)_mathrms-fracvarphimuleft(fracd mudrright)_mathrms","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"Since the pressure of the environment is equalized to that of the displaced element, the pressure derivatives cancel. Also, since the composition of the displaced element remains fixed, we can ignore its mu derivative:","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"frac1rholeftleft(fracdrhodrright)_mathrme-left(fracdrhod rright)_mathrmsright = -fracdeltaTleft(fracd Tdrright)_mathrme+fracdeltaTleft(fracd Tdrright)_mathrms-fracvarphimuleft(fracd mudrright)_mathrms","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"Multiplication by H_P turns the derivatives into derivatives with respect to pressure,","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"fracH_Prholeftleft(fracdrhodrright)_mathrme-left(fracdrhod rright)_mathrmsright = fracPdeltaTleft(fracd TdPright)_mathrme-fracPdeltaTleft(fracd Tdrright)_mathrms-fracPvarphimuleft(fracd mudrright)_mathrms","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"Turning all derivatives on the right side on logarithmic derivatives of the form d ln Xdln P, we get","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"fracH_Prholeftleft(fracdrhodrright)_mathrme-left(fracdrhod rright)_mathrmsright = deltanabla_mathrme-deltanabla-varphinabla_mu","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"For an adiabatic displacement where delta_mathrme=delta_mathrmad, the stability condition is then:","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"deltanabla_mathrmad-deltanabla-varphinabla_mu  0","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"which gives the desired result if delta0. Do you expect delta0?","category":"page"},{"location":"6_convection_problems/#Core-convection-2","page":"Exercises","title":"Core convection","text":"","category":"section"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"Near the core, the luminosity as a function of mass is given by","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"l(m)=varepsilon_mathrmnuccm","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"such that the radiative temperature gradient is independent of mass,","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"nabla_mathrmradc=frac316pi a c Gfrackappa varepsilon_mathrmnucc PT^4","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"Evaluating this for the given central properties of the Sun and the 10M_odot star gives us:","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"mathrmSunquadnabla_mathrmradc=007","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"mathrm10M_odotquadnabla_mathrmradc=17","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"Taking nabla_mathrmad=25 we find that the core of the Sun is expected to be stable to convection, while that of a massive star is expected to be unstable to it.","category":"page"},{"location":"6_convection_problems/#Envelope-convection-in-the-Sun-2","page":"Exercises","title":"Envelope convection in the Sun","text":"","category":"section"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"We only need to compute F_mathrmcon=L(4pi r^2) and","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"H_Psim fracP r^2GM_odot rhosim 006 R_odot","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"which shows that in the mixing length model with alpha_mathrmMLT of order unity we expect convective elements to travel a large distance compared to the stellar radius. Using this we can just evaluate the superadiabaticity,","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"nabla-nabla_mathrmad sim 10^-6","category":"page"},{"location":"6_convection_problems/","page":"Exercises","title":"Exercises","text":"so indeed in these conditions we would expect a very small digression from nabla_mathrmad to be sufficient to transport all energy. Be aware though that we are ignoring radiative losses in convective blobs. In the full mixing length model, one can find conditions under which this losses are so high that almost all energy is transported through radiation in a convective zone.","category":"page"},{"location":"2_equations/#The-equations-of-stellar-structure-and-evolution","page":"Notes","title":"The equations of stellar structure and evolution","text":"","category":"section"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"Goals:","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"Derive the equation of motion\nDerive a form of the energy equation\nDerive the continuity equation\nVirial theorem\nLane-Embden equation","category":"page"},{"location":"2_equations/#Equation-of-motion","page":"Notes","title":"Equation of motion","text":"","category":"section"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"We first consider the 3D problem before reducing it to radial symmetry. Start with a box with sides of size mathrmdl and density rho.","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"(Image: asd)","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"The mass of the box is simply","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"mathrmdm = rho mathrmd V = rho(mathrmdl)^3","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"If we consider the box is moving with the fluid, rather than being static in space, we can write its equation of motion as mathrmdmcdotveca=vecf, where veca is the acceleration and vecf are the forces acting on the box:","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"mathrmdmcdot veca=vecf=vecf_g + vecf_P","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"where we have separated the forces into the contribution from gravity and that from the fluid pressure. The gravitational force can be expressed as the gradient of the gravitational potential, which in turn must satisfy Poisson's equation,","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"vecf_g=-mathrmdmnablaPhiquad nabla^2Phi = 4pi G rho","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"To compute vecf_P, we focus first on its component in one cartesian direction. If our box is aligned with the x axis, then the force of pressure will be given by the difference in pressure between two sides, multiplied by the area of the face. This is illustrated in the figure below, where P_-x and P_+x is the value of the pressure at each side.","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"(Image: asdf)","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"The x component of the pressure force is then","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"vecf_Pcdot hatx=(mathrmdl)^2left(P_-x-P_+xright)","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"= (mathrmdl)^3 left(fracpartial Ppartial xright)_t","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"where the partial derivative is taken at constant time. Repeating this in all directions we find","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"vecf_P = -mathrmd Vleft(left(fracpartial Ppartial xright)_t left(fracpartial Ppartial yright)_t left(fracpartial Ppartial zright)_tright)=-mathrmdV nabla P","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"which gives us the equation of motion","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"veca=-nablaPhi -fracnabla Prho","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"If we consider spherical symmetry, we find that","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"boxeda_r = -fracG m(r)r^2-frac1rhofracpartial Ppartial r","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"where m(r) is the mass contained inside the radius r and we have used that in spherical symmetry nabla Phi = Gm(r)r^2.","category":"page"},{"location":"2_equations/#Energy-equation","page":"Notes","title":"Energy equation","text":"","category":"section"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"We consider the second law of thermodynamics,","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"Tfracmathrmd smathrmd t=fracmathrmd qmathrmd t","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"where s is the specific entropy (meaning, per unit mass) and dqdt is the head added per unit mass and per unit time. Here we are also distinguishing between a co-moving time derivative (mathrmdmathrmdt) and a time derivative fixed in space (partial partial t). In three dimensions these two operators are related via","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"fracmathrmdmathrmd t = fracpartialpartial t + vcdotnabla","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"If we have an energy flux vecF going through the fluid, our mass element mathrmdm can have energy deposited onto it if vecF is not constant in space. To determine this, we apply a similar reasoning to what we did in the previous section, considering first the energy that flows through two sides of the box in the x direction. The energy being deposited in each side of the box corresponds to the flux times the area, as illustrated below where F_x-x and F_x+x represent the flux at each of the faces.","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"(Image: asdf)","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"The heat deposited by radiation (per unit time and mass) in the x direction is then","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"fracmathrmd qmathrmd t=frac(mathrmdl)^2mathrmdmleft(F_x-x-F_x+xright)","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"=-frac(mathrmdl)^3mathrmdmleft(fracpartial F_xpartial xright)_t=-frac1rholeft(fracpartial F_xpartial xright)_t","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"Combining contributions from all directions we have","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"fracmathrmd qmathrmd t=-frac1rholeftleft(fracpartial F_xpartial xright)_t+left(fracpartial F_ypartial yright)_t + left(fracpartial F_zpartial zright)_tright=-fracnablacdot vecFrho","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"rightarrow Tfracmathrmd smathrmd t = -fracnablacdot vecFrho","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"And if we consider spherical symmetry the result is","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"Tleft(fracpartial spartial tright)_m=-frac1rhocdotfrac1r^2left(fracpartial(r^2 F_r)partial rright)_t","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"where the comoving time derivative in 1D corresponds to taking the time derivative at a fixed mass coordinate. Generally one uses the luminosity L=4pi r^2 F_r rather than the flux, which gives us","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"Tleft(fracpartial spartial tright)_m=-frac14pi rho r^2left(fracpartial Lpartial rright)_t","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"In practice, we don't only have heat deposited by variations in the flux, but also locally through nuclear reactions. If varepsilon_mathrmnuc is the energy deposited per unit mass and time, then we have","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"left(fracpartial qpartial tright)_m=-fracnabla cdot vecFrho+varepsilon_mathrmnuc","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"rightarrow boxedTleft(fracpartial spartial tright)_m=-frac14pi rho r^2left(fracpartial Lpartial rright)_t + varepsilon_mathrmnuc","category":"page"},{"location":"2_equations/#Continuity-equation","page":"Notes","title":"Continuity equation","text":"","category":"section"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"The continuity equation describes how the density evolves as a function of time. To obtain this equation we can think again about our box with sides mathrmdl, but this time we will consider the box to be static in space rather than comoving with the fluid. In this case we have that the volume mathrmdV of the box remains constant, but not its mass mathrmdm. In particular,","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"mathrmdm=(dl)^3rho rightarrow fracpartial rhopartial t=frac1mathrmdVfracpartial(mathrmdm)partial t","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"The image below shows how, during an amount of time mathrmdt, material would flow from the two sides of the box in the x-direction.","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"(Image: asdf)","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"Material coming from the -x direction would fill a region of volume (mathrmdl)^2v_x-xmathrmdt, from which the total mass flowing is obtained by mutiplying by the density at the face. The corresponding change in mass at each face is then","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"mathrmd(mathrmdm)_-x=(mathrmdl)^2 v_x-xrho_-xmathrmdt","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"mathrmd(mathrmdm)_+x=(mathrmdl)^2 v_x+xrho_+xmathrmdt","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"We can then proceed in the same way as we did in the previous section to compute partial (mathrmd m)partial t, which will give us","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"boxedfracpartial rhopartial t=-nabla cdot (rho vecv)","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"which is known as the continuity equation. If we consider spherical symmetry we find that","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"left(fracpartial rhopartial tright)_r=-frac1r^2fracpartialpartial rleft(r^2 rho v_rright)tag11","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"Note that the time derivative is taken at fixed radius rather than at fixed mass coordinate, as we were considering how properties change at a fixed location in space rather following a comoving mass element.","category":"page"},{"location":"2_equations/#Eularian-versus-Lagrangian-description","page":"Notes","title":"Eularian versus Lagrangian description","text":"","category":"section"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"In practice, we often use the mass coordinate m(r) as a variable instead of r,","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"m(rt)=int_0^r 4pi r^2 rho(rt) mathrmdrtag12","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"rightarrow left(fracpartial mpartial rright)_t = 4pi r^2rhoquadmathrmorquadleft(fracpartial rpartial mright)_t = frac14pi r^2rhotag13","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"The change of m(rt) with respect to time is given by the mass flux over a shell at fixed radius r,","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"left(fracpartial mpartial tright)_r = -4pi r^2 rho v_r tag14","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"One can combine Equations (12), (12) and (13) to obtain the equation of continuity under the assumption of radial symmetry (Equation (11)). Owing to this, Equation (13) is normally referred to as the continuity equation in stellar astrophysics. We will generally be working under the assumption of hydrostatic equilibrium, in which case there is no difference between time derivatives at constant radius or mass coordinate. Derivatives with respect to radius and mass coordinate also are always taken at fixed time. Because of this we will drop the specification of which quantity is taken to be fixed from the partial derivatives, as they can be identified from the context.","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"We then have two different forms for the equations of stellar structure and evolution, which depend on whether we use r or m as the independent spatial variable. If r is the independent variable then the equations are in \"Eularian\" form, while using m as independent variable is the \"Lagrangian\" form. The equation of continuity (13) can be used to switch between both formulations, and these are summarized in the table below (note that for the energy equation we are using a time derivative at fixed mass in both formulations).","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":" Eularian Lagrangian\nIndependent variable m=m(r) r=r(m)\nContinuity equation displaystylefracpartial mpartial r=4pi r^2rho displaystylefracpartial rpartial m=frac14pi r^2 rho\nEquation of motion displaystyle a_r = -fracGmr^2 - frac1rhofracpartial Ppartial r displaystyle a_r = -fracGmr^2 - 4pi r^2fracpartial Ppartial m\nEnergy equation displaystyle Tfracpartial spartial t=-frac14pi r^2 rhofracpartial Lpartial r+varepsilon_mathrmnuc displaystyle Tfracpartial spartial t=-fracpartial Lpartial m+varepsilon_mathrmnuc","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"Now we can ask, can we actually solve these equations? On top of initial conditions, we need boundary conditions (BCs) for each equation containing a spatial derivative (as these will result in an integration constant). Two general BCs can be set at the center of the star,","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"r(m=0)=0quad L(m=0)=0","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"We need one additional boundary condition, which can be set at the surface. In regular applications, one uses a definition of a photosphere, where the density and pressure are finite and most photons freely travel to infinity. For analytical purposes it is better to approximate the surface as the place where pressure vanishes,","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"P(m=M)=0","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"where M is the total mass of the star. The two conditions at the core are very general, while we will refine the one at the surface later on in the course.","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"We can then count the number of unknowns against the number of differential equations. We have not considered composition yet, but for each element we consider, we will have one equation describing its time derivative. Using a Lagrangian formulation we have the following unknowns:","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"The radius r(mt)\nThe density rho(mt)\nThe pressure P(mt)\nThe specific entropy s(mt)\nThe temperature T(mt)\nThe luminosity L(mt)\nAnd the rate of nuclear energy generation rate varepsilon_mathrmnuc(mT)","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"This is a total of 7 unknown variables, with only 3 differential equations! This conundrum will be solved in the following way:","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"rho, P, s and T: An equation of state (EOS) of the fluid will give us two of these properties by specifying any of the other two (as well as the composition). This reduces the number of unknown properties by 2.\nL: This will come from our study of energy transport, which will give us an equation for L in terms of all other local properties such as the temperature gradient.\nvarepsilon_mathrmnuc: This is a microphysical property that depends on local conditions such as temperature, density, and composition. We will see how it is computed when we study nuclear reactions.","category":"page"},{"location":"2_equations/#Virial-theorem","page":"Notes","title":"Virial theorem","text":"","category":"section"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"Consider the Lagrangian form of the equation of motion, in the case where gravity and the pressure gradient are perfectly balanced such that there is no acceleration. Then one obtains the equation of hydrostatic equilibrium:","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"boxedfracpartial Ppartial m=-fracGm4pi r^4","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"A very useful expression, known as the virial theorem, can be derived by multiplying both sides by 4pi r^3 and integrating over mass,","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"int_0^M 4pi r^2 fracpartial Ppartial mmathrmdm=int_0^M -fracGmrmathrmdm","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"The right hand term is the gravitational potential energy, E_g, which corresponds to assembling the star by succesively bringing mass elements mathrmdm from infinity. The left hand side can be rewritten using integration by parts:","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"int_0^M 4pi r^2 fracpartial Ppartial mmathrmdm = left(4pi r^2 P)right_m=0^m=M-int 12pi r^2 fracpartial rpartial mP mathrmdm","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"The first term on the right hand side vanishes from the boundary conditions, and using the continuity equation we have","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"int 4pi r^2 fracpartial Ppartial mmathrmdm = -3int_0^MfracPrhomathrmdm","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"which gives us the virial theorem","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"boxedE_g = -3int_0^MfracPrhomathrmdmtag15","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"To see what this implies, let's consider the very simple case of a monoatomic gas:","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"P=nk_mathrmBTquad n=fracrhom_gtag16","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"where k_mathrmB is Boltzmann's constant and m_g is the mass of the individual gas particles. This is very simplified as it does not account for electrons in an ionized gas, but this will be generalized in later classes. For the monoatomic ideal gas the energy per particle is","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"e=frac32k_mathrmBT","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"from which we can compute the specific (meaning, per unit mass) internal energy of the gas,","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"u=fracem_g=frac32frack_mathrmBTm_gtag17","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"Plugging (17) and (16) into (15) we find","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"E_g = -2int_0^M u mathrmdm=-2E_i","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"where E_i is the internal energy of the gas. The total energy of the gas can be determined by adding up the potential and gravitational energies, which combined with the previous equation results in","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"E=E_g+E_i=-E_i","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"From this we see that the total energy is negative (as expected for a bound star) and that as a star loses (for instance, due to radiation at their surface), its internal energy increases. This implies that a star will often increase its temperature as a consequence of mass loss! Often this is referred to as stars having a negative heat capacity.","category":"page"},{"location":"2_equations/#Lane-Emden-equation","page":"Notes","title":"Lane-Emden equation","text":"","category":"section"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"Consider the continuity and hydrostatic equilibrium equations in their Eularian form,","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"fracpartial mpartial r=4pi r^2 rhoquad fracpartial Ppartial r=-fracGmrhor^2","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"It could be possible to find solutions to these equations if there was a simple relationship of the form P=P(rho) (meaning, temperature independent), such that we only have as unknowns rho(r) and m(r). As it turns out an important particular case is that of a so called polytropic equation of state,","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"P=Krho^gamma","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"where K and gamma are constant. Depending on the relevant equation of state that describes a star at a given stage, we will see both cases where K is a function of fundamental constants that is independent of a specific star, as well as cases where K can vary during the evolution of a star. Rather than using the exponent gamma, it is common to use the polytropic index n, with","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"P=Krho^1+1n","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"We can combine the equation of hydrostatic equilibrium with the equation of continuity to obtain a single second order differential equation as follows:","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"leftfracpartial Ppartial r=-fracGmrhor^2quadright fracr^2rhocdot","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"leftfracr^2rhofracpartial Ppartial r=-Gmquadright fracpartialpartial rcdot","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"fracpartialpartial rleft(fracr^2rhofracpartial Ppartial rright)=-Gfracpartial mpartial r=-4pi G rho r^2tag18","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"If we have a polytropic relationship between density and pressure, then this is just a second order differential equation for rho(r), and we can obtain a solution for it if we have two boundary conditions. A useful dimensionless form of this equation can be obtained if we define a new variable z instead of r from","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"r=r_n zqquad r_n equiv sqrtfrac(n+1)P_c4pi Grho_c^2","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"and we define a function w(z) such that","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"rho = rho_c leftw(z)right^nrightarrow P=P_cleftw(z)right^n+1","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"where rho_c and P_c are the central density and pressure. Using z and w(z) to replace r, rho and P in Equation (1.8), one obtains the Lane-Emden equation:","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"frac1z^2fracmathrmdmathrmd zleft(z^2fracmathrmdwmathrmdzright)=-w^n","category":"page"},{"location":"2_equations/","page":"Notes","title":"Notes","text":"We need two boundary conditions, one of them clearly being w(0)=1 as we require the central density and pressure to be rho_c and P_c respectively. The second boundary condition can be determined from a restriction on the central temperature gradient. Since near the core the mass is given by msimeq 4pi r^3 rho_c3, the equation of hydrostatic equilibrium implies that (partial Ppartial r)_r=0=0 which in turn implies that w_xi=0=0. With these two boundary conditions the Lane-Emden equation has a unique solution for each n, and using our definition of the stellar surface as P(R)=0, the surface is determined by the first value xi_1 for which w(xi_1)=0. As we consider different equations of state that can be approximated as polytropes, the Lane-Emden equation will be a useful source of insight to determine how different properties of the star (such as their mass and radius) relate to each other.","category":"page"},{"location":"9_homology_problems/#Exercises","page":"Exercises","title":"Exercises","text":"","category":"section"},{"location":"9_homology_problems/#List-of-exercises","page":"Exercises","title":"List of exercises","text":"","category":"section"},{"location":"9_homology_problems/#1:-Timescales-for-different-burning-phases","page":"Exercises","title":"1: Timescales for different burning phases","text":"","category":"section"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"Consider the main isotopes of hydrogen, helium, carbon and oxygen that are produced through nuclear reactions in stellar interiors:","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"isotope Z A mm_u\nH 1 1 1.007825\nHe 2 4 4.002603\nC 6 12 12.000000\nO 8 16 15.994915","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"Simplify all nuclear burning stages by assuming that they proceed as (we ignore neon burning here):","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"The star is composed purely of hydrogen at the start\nAll hydrogen is burnt into helium\nAll helium is burnt into carbon\nAll carbon is burnt into oxygen","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"If through these burning phases the star has a fixed luminosity, determine the duration of each core helium and core carbon burning relative to the core hydrogen burning phase. Ignore any energy loss through neutrinos.","category":"page"},{"location":"9_homology_problems/#2:-Homology-for-radiative-energy-transport","page":"Exercises","title":"2: Homology for radiative energy transport","text":"","category":"section"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"Given the equation for the temperature gradient in a region where energy is transported through radiation, we have that","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"fracdT^4dm=-frac3kappa l16pi^2 a c r^4","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"Assuming an ideal gas law without radiation, and an opacity of the form kappa=kappa_0 rho^aT^b (with a and b constant) show that two homologous stars of constant opacity (but not necessarily equal opacity between them) satisfy the relationship","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"left(fracT_2(x)T_1(x)right)^4=fracl_2(x)l_1(x)fracM_2M_1frackappa_2kappa_1left(fracR_2R_1right)^-4","category":"page"},{"location":"9_homology_problems/#3:-Homologous-contraction","page":"Exercises","title":"3: Homologous contraction","text":"","category":"section"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"Consider the homology relations derived using the equation of continuity and the equation of hydrostatic equilibrium,","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"fracrho_2(x)rho_1(x)=fracM_2M_1left(fracR_2R_1right)^-3quad fracP_2(x)P_1(x)=left(fracM_2M_1right)^2left(fracR_2R_1right)^-4","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"These expressions can be used to describe a star contracting homologously with a fixed mass, meaning that M_1=M_2 and R_1 and R_2 represent the radii at two different stages of contraction. Show from this that as the star contracts homologously it satisfies","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"fracdotP(m)P(m)=-4fracdotRR=frac43fracdotrho(m)rho(m)","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"Making use of the EOS quantities","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"chi_Tequiv left(fracpartial ln Ppartial ln Tright)_rho quad chi_rhoequiv left(fracpartial ln Ppartial ln rhoright)_T","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"show that","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"fracdotT(m)T(m)=frac1chi_Tleft(frac43-chi_rhoright)fracdotrho(m)rho(m)=frac1chi_Tleft(3chi_rho-4right)fracdotRR","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"What does this implies for the temperature of a star composed of an ideal gas? What about the temperature for a non-relativistic degenerate gas?","category":"page"},{"location":"9_homology_problems/#Solutions","page":"Exercises","title":"Solutions","text":"","category":"section"},{"location":"9_homology_problems/#1:-Timescales-for-different-burning-phases-2","page":"Exercises","title":"1: Timescales for different burning phases","text":"","category":"section"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"If the luminosity is fixed, we only need to consider the mass difference per baryon through each burning stage. For Hydrogen burning we will have:","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"fracDelta m_H-Hem_mathrmu=left(1007825-frac40026034right)=0007174","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"We repeat this for all other stages:","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"fracDelta m_He-Cm_mathrmu=left(frac40026034-frac1212right)=0000651","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"fracDelta m_C-Om_mathrmu=left(frac1212-frac1599491516right)=0000318","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"From this one finds that core helium burning lasts only sim 10 of the duration of the core-hydrogen burning phase, while core-carbon burning lasts just sim 5 of the core hydrogen burning phase. In practice most stars actually becomes more luminous through their evolution, exacerbating this further!","category":"page"},{"location":"9_homology_problems/#2:-Homology-for-radiative-energy-transport-2","page":"Exercises","title":"2: Homology for radiative energy transport","text":"","category":"section"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"We start by changing the derivative to one with respect to x=mM,","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"fracdT^4dx=-frac3kappa l M16pi^2 a c r^4","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"We consider a solution to the equations of stellar structure which we denote with the subscript 1, and consider another analogous solution with a subscript 2. The equation for radiative energy transport for star 1 can be written as","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"fracdT_1^4dx=-frac3kappa_1 l_1 M_116pi^2 a c r_1^4=-frac3kappa_2 l_2 M_216pi^2 a c r_2^4leftfracl_1l_2fracM_1M_2frackappa_1kappa_2left(fracr_1r_2right)^-4right","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"On the right hand side we identify the equation of radiative energy transport for star 2, such that we have","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"fracdT_1^4dx=fracdT_2^4dxleftfracl_1l_2fracM_1M_2frackappa_1kappa_2left(fracr_1r_2right)^-4right","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"The desired result is then obtained by integrating from an arbitrary value of x all the way to the surface (x=1), while ignoring the temperature at the surface. We can take the entire term in the brackets as constant, as we have shown in class that an ideal gas law without radiation implies T follows a simple homology relationship. This means kappa=kappa_0rho^a T^b will do to, so the equation of radiative energy transport implies the same thing for the luminosity.","category":"page"},{"location":"9_homology_problems/#3:-Homologous-contraction-2","page":"Exercises","title":"3: Homologous contraction","text":"","category":"section"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"Considering two homologous stars with the same mass but different radii, we get","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"fracrho_2(x)rho_1(x)=left(fracR_2R_1right)^-3quad fracP_2(x)P_1(x)=left(fracR_2R_1right)^-4","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"Fixing the values for star 2, and taking the properties of star 1 to represent those of a homologously contracting star, we obtain","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"rho_1(xt) = C_1(x) R_1(t)^-3quad P_1(xt) = C_2(x) R_1(t)^-4","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"from which the derivatives of density and pressure with respect to radius are straightforward to derive,","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"fracdotP(m)P(m)=-4fracdotRR=frac43fracdotrho(m)rho(m)","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"To switch from pressure to density we make use of the relationship","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"fracdPP=chi_TfracdTT+chi_rhofracdrhorho","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"which combined with the previous equation results in","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"chi_T fracdotTT+chi_rhofracdotrhorho=frac43fracdotrho(m)rho(m)","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"Using the derived relationship between dotRR and dotrhorho we obtain the temperature time derivative as a function of the radial time derivative,","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"fracdotT(m)T(m)=frac1chi_Tleft(3chi_rho-4right)fracdotRR","category":"page"},{"location":"9_homology_problems/","page":"Exercises","title":"Exercises","text":"As contraction implies a negative dotR, we find that the temperature will increase if the fluid has chi_rho43. This is the case in particular for an ideal gas, specifically for the case where we can ignore radiation one has chi_rho = 1. If we instead consider a non-relativistic degenerate gas, we have instead that chi_rho=53, implying that a degenerate star will cool down with contraction.","category":"page"},{"location":"#Overview","page":"Overview","title":"Overview","text":"","category":"section"},{"location":"","page":"Overview","title":"Overview","text":"Welcome to the 2024 rendition of the course \"Stellar Structure and Evolution\" at the institute of astronomy of KU Leuven. This website will contain notes from classes, exercises with included solutions, and examples of computational problems. Below you can find links to the different sections of this website that are available at the moment.","category":"page"},{"location":"","page":"Overview","title":"Overview","text":"Pages = [\"1_introduction.md\", \"2_equations.md\", \"3_eos1.md\", \"4_eos2.md\", \"5_radiative.md\", \"6_convection.md\"]\nDepth = 2","category":"page"},{"location":"2_equations_problems/#Exercises","page":"Exercises","title":"Exercises","text":"","category":"section"},{"location":"2_equations_problems/#List-of-exercises","page":"Exercises","title":"List of exercises","text":"","category":"section"},{"location":"2_equations_problems/#1:-Constant-density-star","page":"Exercises","title":"1: Constant density star","text":"","category":"section"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"Consider a star with constant density,","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"rho(m)=rho_mathrmcquad m(r) =frac4pi3r^3 rho_mathrmc","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"Use the equation of hydrostatic equilibrium in its Eularian form,","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"fracpartial Ppartial r = -rho g=-fracrho G m(r)r^2","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"to obtain the interior pressure of the star as a function of the central pressure P_mathrmc and rR, where R is the total radius of the star. Assume that the pressure at the surface of the star is much smaller than the central pressure.","category":"page"},{"location":"2_equations_problems/#2:-Lower-bound-on-central-pressure-of-the-Sun","page":"Exercises","title":"2: Lower bound on central pressure of the Sun","text":"","category":"section"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"Using the Lagrangian form of the equation of hydrostatic equilibrium,","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"fracpartial Ppartial m=-fracGm4pi r^4","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"place a lower bound on the central pressure of the sun by making use of the basic property that anywhere within the stellar interior we have that rR_odot.","category":"page"},{"location":"2_equations_problems/#3:-Dynamical-instability","page":"Exercises","title":"3: Dynamical instability","text":"","category":"section"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"Consider a polytropic equation of state of the form","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"P = K rho^gamma","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"where K is a constant. If the density of a fluid element is perturbed slightly by an amount delta rhollrho, then the pressure is perturbed by an amount","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"P_0+delta P = K (rho_0+deltarho)^gamma simeq Krho_0^gammaleft(1+fracgamma deltarhorho_0right)","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"where P_0 and r_0 are the unperturbed values of pressure and density. It follows that the perturbations on density and pressure can be related to each other:","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"fracdelta PP_0=gammafracdelta rhorho_0","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"Using this answer the following questions:","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"If the radii r_0(m) of each mass shell in a star is perturbed by delta r=alpha r_0 (where alphall 1 is a small positive number independent of m), show that the stellar density is perturbed at each point by an amount delta rhorho_0=-3alpha at each point of the star. To do this, take the continuity equation of the unperturbed fluid,  \ndisplaystylefracpartial r_0partial m=frac14pirho_0 r_0^2\nand find delta rhorho_0 from its perturbed form  \ndisplaystylefracpartial (r_0+alpha r_0)partial m=frac14pi(rho_0+delta rho) (r_0+alpha r_0)^2\nby ignoring perturbation terms of quadratic order.\nAssume the unperturbed star is in hydrostatic equilibrium,  \ndisplaystylefrac14pi r_0^2a_r=-fracpartial P_0partial m-fracG m4pi r_0^4=0\nwhere a_r is the radial component of the acceleration. Compute the resulting acceleration after the perturbation delta r=alpha r_0. For which values of gamma does the resulting acceleration point inwards or outwards? What does this say about stability?","category":"page"},{"location":"2_equations_problems/#4:-Mass-Radius-relationship-for-a-polytrope","page":"Exercises","title":"4: Mass-Radius relationship for a polytrope","text":"","category":"section"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"The structure of a star with a polytropic equation of state P=K rho^1+1n can be computed using the Lane-Emden equation,","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"frac1z^2fracddzleft(z^2fracd w_nd zright)=-w_n^n","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"where","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"rho=rho_mathrmcw_n^n quad P=P_c w_n^1+n quad r = r_n z quad r_n^2equivfrac(n+1)P_mathrmc4pi G rho_mathrmc^2","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"The central boundary conditions for this equation are w_n(0)=1 and w_n(0)=0, while the surface is defined by the first zero of w_n, at which point we define z_1 and R=r_n z_1.","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"Show that the mass contained inside a given value of the coordinate z is given by  ","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"m(z)=4pi r_n^3 rho_mathrmc(-z^2 w_n(z))","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"Show that for an equation of state P=Krho^53 higher mass stars have smaller radii.","category":"page"},{"location":"2_equations_problems/#Solutions","page":"Exercises","title":"Solutions","text":"","category":"section"},{"location":"2_equations_problems/#1:-Constant-density-star-2","page":"Exercises","title":"1: Constant density star","text":"","category":"section"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"Using the expression of m(r) we can write the hydrostatic equilibrium equation as,","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"fracpartial Ppartial r = -frac4pi rho_c^2 G3 r","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"which can be integrated from the core to the surface","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"int_0^R fracpartial Ppartial r dr = P_mathrms - P_mathrmc=-frac4pi rho_c^2 G6 R^2","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"Ignoring the surface pressure P_mathrms we obtain the central density of the star","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"P_c = frac4pi rho_c^2 G6 R^2","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"The pressure at an arbitrary radius can be obtained by changing the integration limits","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"int_0^r fracpartial Ppartial r dr = P(r) - P_mathrmc","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"which can be rewritten as","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"P(r) = -frac4pi rho_c^2 G6 (r^2-R^2)=P_mathrmc(1-r^2R^2)","category":"page"},{"location":"2_equations_problems/#2:-Lower-bound-on-central-pressure-of-the-Sun-2","page":"Exercises","title":"2: Lower bound on central pressure of the Sun","text":"","category":"section"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"We can integrate the equation over mass, again ignoring surface pressure:","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"int_0^M fracpartial Ppartial m dm = -P_mathrmc=-int_0^M fracGm4pi r^4","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"Since rR, we can place a bound on the integral by replacing r with R,","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"P_mathrmc  int_0^M fracGm4pi R^4=fracGM^28pi R^4","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"It is quite common to write expressions like this for any star, but scaled to the properties of the Sun. We can do this by evaluating the expression for the solar radius and mass, while keeping the relevant power laws on mass and radius:","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"P_mathrmc=fracGM_odot^28pi R_odot^4left(fracMM_odotright)^2left(fracRR_odotright)^-4simeq 45times 10^14mathrmdynecm^-2 left(fracMM_odotright)^2left(fracRR_odotright)^-4","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"Considering one atmosphere is sim 10^6mathrmdynecm^-2, this means the core of the sun has over eight orders of magnitude higher pressure than we get on our daily lives!","category":"page"},{"location":"2_equations_problems/#3:-Dynamical-instability-2","page":"Exercises","title":"3: Dynamical instability","text":"","category":"section"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"We start by noting that:","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"frac1(r_0+alpha r_0)^2 = frac1r_0^2(1+alpha)^2=frac1-2alphar_0^2","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"and","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"frac1rho_0+delta rho = frac1rho_0(1+delta rhorho_0)=frac1-delta rhorhorho_0","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"The continuity equation then reads as","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"fracpartial r_0partial m(1+alpha)=frac14pi r_0^2 rho_0(1-2alpha)(1-deltarhorho_0)","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"and replacing partial r_0partial m with the unperturbed continuity equation, while ignoring quadratic perturbation terms, gives us the desired result:","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"fracdelta rhorho_0=-3alpha","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"which as expected is negative (a lowering of density) with expansion. With this we immediately know that delta PP_0=-3alphagamma. Next we want to obtain the sign of the acceleration after the perturbation,","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"frac14pi (r_0+alpha r_0)^2fracpartial^2 r_0partial t^2 = -fracpartial P_0partial m(1-3alphagamma) - fracGm4pi r_0^4(1-4alpha)","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"Since we only care about the sign of the acceleration, we don't need to expand the left-hand side further. For the right-hand side we use the equation of hydrostatic equilibrium for the unperturbed state to obtain:","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"frac14pi (r_0+alpha r_0)^2fracpartial^2 r_0partial t^2 = fracGm4pi r_0^4times alpha(4-3gamma)","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"This implies that for expansion (alpha0) we will get an outwards acceleration if gamma43, which is an unstable situation. Conversely, if we had contraction (alpha0) we would obtain a negative acceleration.","category":"page"},{"location":"2_equations_problems/#4:-Mass-Radius-relationship-for-a-polytrope-2","page":"Exercises","title":"4: Mass-Radius relationship for a polytrope","text":"","category":"section"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"The mass of the star up to a certain radius can be obtained by integrating the continuity equation:","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"m(r)=int_0^r 4pi r^2 rho dr","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"Using rho = rho_c w_n^n we find","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"m(r)=4pi rho_c int_0^r r^2 w_n^n dr = 4pi r_n^3 rho_c int_0^z z^2 w_n^ndz","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"The integrand can be replaced using the Lane-Equation, which gives allows for immediate integration:","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"m(z)=4pi r_n^3 rho_c int_0^z fracdd zleft(-z^2 w_nright)=4pi r_n^3 rho_c (-z^2 w_n)","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"giving the total mass when evaluated at z=z_1.","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"To obtain the mass-radius relationship, we note from the definition of r_n that","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"Rpropto r_npropto sqrtfracP_mathrmcrho_c^2propto rho_c^-12+12n","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"and since Mpropto r_n^3rho_c we get the scaling between mass and central density:","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"Mpropto rho_c^-12+32n","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"Combining the equations for R and M we find that","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"Rpropto M^betaquad beta=frac1-n3-n","category":"page"},{"location":"2_equations_problems/","page":"Exercises","title":"Exercises","text":"A negative exponent, indicative of a decreasing radius with mass, happens between n=1 and 3. One can use the case n=0, corresponding to constant density, as a validity check. What value of beta do you expect then? An equation of state Ppropto rho^53 corresponds to n=15, and the above shows we expect more compact stars as mass increases. As we will see in a few classes, this case corresponds to a fully degenerate non-relativistic gas, and can be used to describe the properties of white dwarfs. An equation of state Ppropto rho^43 corresponds to n=3, which we can see is a critical point where the above expression is undefined. Yet again, the 43 value holds an important meaning!","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"EditURL = \"1_introduction_computational.jl\"","category":"page"},{"location":"1_introduction_computational/#Constructing-an-HR-diagram","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"","category":"section"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"# Include imports\nusing DataFrames     # Used to deal with tabular data\nusing Plots          # Provides a multitude of plotting routines\nusing CSV            # Efficient reading of files in \"comma separated values\" format\nusing LaTeXStrings   # Makes it easy to write LaTeX strings","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"To run this lab locally you will need three additional files, solar_spectrum.dat, gaia_100pc_par_over_err_100.csv and passband.dat.","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"The radiation coming out of a star can be approximated to first order using black body radiation. In this case the intensity is described by Planck's law,","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"B_lambda(lambdaT) = frac2h c^2lambda^5frac1expleft(frachclambda k_mathrmBTright)-1","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"which describes the energy flux per unit area and unit solid angle. This function peaks at a value of lambda_mathrmmax=hc(4965 k_mathrmBT). We can use this to normalize the distribution such that its peak value is 1, which is useful for visualization. Below we define both B_lambda and its normalized version.","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"# Define constants and Plank function\nh = 6.6261e-27      # Planck's constant, cm^2 g s^-1\nc = 2.99792458e10   # speed of light cm s^-1\nk_B = 1.3807e-16    # Boltzmann constant erg K-1\nσ = 2*π^5*k_B^4/(15*h^3*c^2) # Stefan-Boltzmann constant\nfunction B_λ(λ,T) #λ in nm, T in Kelvin\n    λ_cm = λ*1e-7\n    return 2*h*c^2/λ_cm^5*(1/(exp(h*c/(λ_cm*k_B*T))-1))\nend;\nfunction normalized_B_λ(λ,T) #λ in nm, T in Kelvin\n    peak_λ = h*c/(4.965*k_B*T)*1e7 #in nm\n    return B_λ(λ,T)/B_λ(peak_λ,T)\nend;\nnothing #hide","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"To see what we mean when we say the spectrum of a star resembles that of a black body, we can check a solar spectrum. The flux that would come out of the surface of the sun per unit wavelength can be obtained by integration of B_lambda over a half sphere, with a cos(theta) correction to account for projection effects,","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"F_lambda = int_0^2 pidphiint_0^pi2B_lambda(lambdaT)cos(theta)sin(theta) dtheta dphi=pi B_lambda","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"Integrated over all wavelengths it can be shown that the total flux is given by F=sigma T^4, where sigma is the Stefan-Boltzmann constant. While travelling through vacuum the flux scales as the inverse of the square distance, such that the solar flux observed at Earth can be computed as","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"F_lambdamathrmEarth = pi B_lambda left(fracR_odot1mathrmauright)^2","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"Below we compare this black body prediction to a standard solar spectrum from the National Renewable Energy Laboratory of the US. Here we use a temperature of T_mathrmeff=5772mathrmK for the Sun, which is a standard value defined by the International Astronomical Union.","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"# We read a CSV file into a dataframe. The first line of the file contains the column names\nsolar_spectrum = CSV.read(\"assets/solar_spectrum.dat\", header=1, delim=\" \", ignorerepeated=true, DataFrame)\n\nplot(xlabel=L\"$\\mathrm{Wavelength\\;[nm]}$\", ylabel=L\"$\\mathrm{Flux}\\; [\\mathrm{erg\\;s^{-1}\\;cm^{-2}\\;nm^{-1}}]$\", xlims=[0,2000])\n\nxvals = LinRange(200.0,2000.0,100)\nau = 1.5e13\nRsun = 7e10\nplot!(xvals, pi*B_λ.(xvals,5772)/1e7/(au/Rsun)^2) # 1e7 factor converts from centimeter to nanometer\nplot!(solar_spectrum.lambda, solar_spectrum.flux) # columns in a dataframe can be easily accesible by name","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"In this exercise we will work with Gaia data. Gaia is a space mission that is performing astrometry of over a billion targets, providing an incredible picture on the structure of our Galaxy. Using parallaxes we can determine the distance to these stars and thus infer their absolute magnitudes. Gaia also provides photometric measurements in three bands, called G, G_RP and G_BP. The G band is a broadband filter, while the G_RP and G_BP filters are more sensitive to short and long wavelengths respectively. The sensitivity of each filter to light at different wavelengths is described by the passbands, which are shown below compared to a (normalized) black body spectrum with the effective temperature of the Sun. For simplicity from here on we refer to the G_RP and G_BP filters as RP and BP.","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"# Visualize Gaia passbands\npassbands = CSV.read(\"assets/passband.dat\", header=1, delim=\" \", ignorerepeated=true, DataFrame)\nplot(xlabel=L\"$\\mathrm{Wavelength\\;[nm]}$\", ylabel=L\"\\mathrm{Transmissivity}\", legendfontsize=10)\nplot!(passbands.lambda, passbands.G_pb, label=L\"$G$\")\nplot!(passbands.lambda, passbands.BP_pb, label=L\"BP\")\nplot!(passbands.lambda, passbands.RP_pb, label=L\"RP\")\n\nxvals = LinRange(200.0,1500.0,100)\nplot!(xvals, normalized_B_λ.(xvals,5772), label=L\"$T=5772\\;\\mathrm{[K]}$\")","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"The Gaia archive gives us a nice interface to query results from this mission (although queries are limited to 2000 results). Here we read a file gaia_100pc_par_over_err_100.csv that containts a sample of stars within 100 parsecs for which the error in the measured parallax is smaller that 1 of the total. As a quick reminder on what parallax means, it refers to the angular displacement of stars as seen by two different observers. When this angle is taken between two measurements at opposite ends of a circle with a distance of 1mathrmau (so, for an observer on Earth), the parallax p is half the of the angular displacement measured against a background of distant \"fixed\" stars. A parsec corresponds to the distance at which a source has a parallax of 1 ( stands for arcsecond, which corresponds to 1(60times 3600) of a degree). In this way the distance of a source is given by","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"fracd1mathrmpc = frac1p1","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"Knowing the distance we can compute the absolute magnitude M of a star of known apparent magnitude m,","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"M=m-5(log_10d_mathrmpc-1)","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"where d_mathrmpc is the distance to the source in parsecs. Using this, below we read the datafile obtained from the Gaia archive, compute the absolute G magnitude of each object using the distance obtained from the parallax (note that the parallaxes are in units of milliarcseconds), and plot a Hertzsprung-Russell diagram. The x-coordinate of the diagram is the color, obtained from substracting the magnitudes on the BP and RP filters. As lower magnitudes imply higher flux, sources to the left of the diagram have a bluer spectrum. We also include in here the location of the Sun using the values provided by [CasagrandeVandenBerg2018].","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"# Plot a color-magnitude diagram with Gaia data\ngaia_data = CSV.read(\"assets/gaia_100pc_par_over_err_100.csv\", header=1, DataFrame)\n\nplot(xlabel=L\"$m_{BP}-m_{RP}$\", ylabel=\"Absolute G magnitude\")\ncolor = gaia_data.phot_bp_mean_mag - gaia_data.phot_rp_mean_mag\ndistance_pc = 1 ./ (1e-3.*gaia_data.parallax)\nabs_G = gaia_data.phot_g_mean_mag .- 5 .* (log10.(distance_pc).-1)\n\n# Solar absolute magnitudes from Casagrande & VandenBerg (2018)\nG_sun = 4.67\nBP_sun = G_sun+0.33\nRP_sun = G_sun-0.49\n\nscatter!(color, abs_G,label=\"Gaia\")\nscatter!([BP_sun-RP_sun],[G_sun], label=\"Sun\")\nyflip!(true)","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"A lot of interesting structure comes right out of this figure. We have that most stars live in a narrow band which crosses the figure diagonally. This band is the main-sequence, and is populated by core-hydrogen burning stars. On the lower left of the diagram we see an additional band of stars, which are much fainter for a given color. These stars correspond to white dwarfs. Finally, and not so apparent, on the upper left of the main sequence there are a few objects which diverge to higher luminosities than the main sequence. These are stars on their red-giant branch. We will go through all of these types of stars later in this course.","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"Next up, we want to turn this into a theoretical Hertzprung-Russell diagram which shows the effective temperature T_mathrmeff versus the luminosity. For this we need to know how to transform the color into an effective temperature, and how to determine the luminosity of a star with a given absolute G band magnitude and color. We will start with the mapping from color to effective temperature. In all of this we will assume all stars radiate as black bodies with an unkown temperature. For a source with a temperature T_mathrmeff we can compute the magnitude in each band as","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"m_BP=-25log_10 F_BP + m_0BPquad m_RP=-25log_10 F_RP + m_0RP","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"where the fluxes on each band are obtained by integrating a black body spectrum with the corresponding passband (varphi_BP(lambda) or varphi_RP(lambda)) that were plotted earlier:","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"F_BP = Cint_0^infty B_lambda(lambdaT) varphi_BP(lambda) dlambdaquad F_RP=Cint_0^infty B_lambda(lambdaT) varphi_RP(lambda) dlambda quad C=pi left(fracRdright)^2","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"The two zero-points m_0BP and m_0RP form part of the definition of the photometric system. Taking the difference between the magnitudes we obtain the color,","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"m_BP-m_RP = -25 log_10left(fracint_0^infty B_lambda(lambdaT) varphi_BP(lambda) dlambdaint_0^infty B_lambda(lambdaT) varphi_RP(lambda) dlambdaright) + m_0BP - m_0RP","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"(zero_point1)","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"Taking the absolute magnitude of the Sun in the BP and RP bands, and assuming it radiates as a black body with T=5772mathrmK, the difference between the zero-points can be expressed as (it does not make a difference if we use the absolute or apparent magnitude of the Sun here)","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"m_0BP - m_0RP= M_BPodot-M_RPodot + 25 log_10left(fracint_0^infty B_lambda(lambda5772mathrmK) varphi_BP(lambda) dlambdaint_0^infty B_lambda(lambda5772mathrmK) varphi_RP(lambda) dlambdaright)","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"(zero_point2)","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"Although we are getting the difference in the zero points by using an approximation of the Sun as a black body, a more formal approach would be to use the definition of the zero point of the GAIA photometric system, which uses the VEGAMAG system. In this system the zero points are set such that one particular star, Vega, has a magnitude of zero in all bands (or more specifally, a particular spectral model of Vega satisfies that). However, for this exercise, Vega is not ideal to use because it is a rapidly rotating star which cannot be well approximated with a blackbody spectrum. For details on this, you can check the section on external calibration from the documentation of the third Gaia data release {cite}vanLeeuwen+2022.","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"Combining equations {eq}zero_point1 and {eq}zero_point2 we can infer the color m_BP-m_RP of a source as a function of T_mathrmeff. This is illustrated below.","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"function flux_ratio_BP_RP(T)\n    #Ignoring constant in the integration as we just care about the ratio, relying on bins being equally spaced in lambda\n    F_sun_BP = sum(passbands.BP_pb .* B_λ.(passbands.lambda,T))\n    F_sun_RP = sum(passbands.RP_pb .* B_λ.(passbands.lambda,T))\n    return F_sun_BP/F_sun_RP\nend\n\ndiff_zero_point_BP_RP = BP_sun - RP_sun + 2.5*log10(flux_ratio_BP_RP(5772))","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"sample","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"log10_T_sample = LinRange(3.0,6.0,100)\nBP_sub_RP = -2.5*log10.(flux_ratio_BP_RP.(10 .^ log10_T_sample)) .+ diff_zero_point_BP_RP\n\nplot(xlabel=L\"$log_{10} T_\\mathrm{eff}$\",ylabel=L\"$m_\\mathrm{BP}-m_\\mathrm{RP}$\")\nplot!(log10_T_sample, BP_sub_RP,label=\"\")","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"Now, on our quest to turn the Gaia Hertzsprung-Russell diagram into one of effective temperature versus luminosity, we run into a small problem. We have found a way to get a color from an effective temperature but what we need is the inverse! The inverse function can be computed numerically using a bisection algorithm. From the plot above we see that the relationship between temperature and color is monotonic. If we have an upper and a lower bound on the temperature that corresponds to a given color, we can iteratively improve on these bounds by taking their average and seeing if this new value corresponds to an upper or a lower bound. This can be iterated upon until the upper and lower bounds are close enough (down to a specific tolerance). The function below implements such a bisection solver.","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"# bisection algorithm to get Teff from the color BP-RP\nfunction log10_T_from_BP_minus_RP(BP_minus_RP)\n    log10_T_min = 3.0 # lower bound\n    log10_T_max = 6.0 # upper bound\n    log10_T = 0.0 # initialize at an arbitrary value\n    while abs(log10_T_min-log10_T_max) > 0.001 # Iterate until we reach this tolerance\n        #bisect bounds\n        log10_T = 0.5*(log10_T_max + log10_T_min)\n        #evaluate the color that corresponds to this temperature\n        BP_minus_RP_new = -2.5*log10.(flux_ratio_BP_RP(10^log10_T)) .+ diff_zero_point_BP_RP\n\n        #Determine if the new value for log10_T is an upper or lower bound.\n        #This relies on BP-RP decreasing monotonically with temperature\n        if BP_minus_RP_new > BP_minus_RP # T too low, update lower limit\n            log10_T_min = log10_T\n        else #otherwise, update upper limit\n            log10_T_max = log10_T\n        end\n    end\n    return log10_T\nend;\n# we use the function defined above to compute log10_Teff for all our Gaia sources\nlog10_T = log10_T_from_BP_minus_RP.(color); #remember that color is defined as BP-RP\nnothing #hide","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"We can make use of this to make a T_mathrmeff versus absolute G magnitude diagram.","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"plot(xlabel=L\"$\\log_{10}T_\\mathrm{eff}$\", ylabel=\"Absolute G magnitude\")\nscatter!(log10_T, abs_G,label=\"Gaia\")\nscatter!([log10_T_from_BP_minus_RP(BP_sun-RP_sun)],[G_sun],label=\"Sun\")\nyflip!(true)\nxflip!(true)","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"We're almost there, just need to turn the y-axis into a luminosity! To do this, we first compute the ratio of flux in the G band versus the total flux for a source at a given temperature. Since we have that F_lambda = pi B_lambda and F=sigma T^4 we find:","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"R(T)equivfracF_GF=fracpisigma T^4int_0^infty B_lambda(lambda T) varphi_G(lambda)dlambda","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"Below we illustrate this ratio as a function of temperature.","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"function flux_ratio_G_total(T)\n    #This numerical integration relies on bins being spaced by a nanometer in the passband data\n    F_G = π*sum(passbands.G_pb .* B_λ.(passbands.lambda,T) .*1e-7)\n    return F_G/(σ*T^4)\nend\n\nplot(xlabel=L\"$log_{10} T_\\mathrm{eff}$\",ylabel=L\"$F_\\mathrm{G}/F$\", yscale=:log, ylims=[1e-4,1], legend=false)\nplot!(log10_T_sample, flux_ratio_G_total.(10 .^ log10_T_sample)) # log10_T_sample is an array defined previously, and goes from log10(T)=3 to 6","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"As can be seen, if the temperature is pushed to very low or very high values we only capture a miniscule amount of the total light. This means that we have little information on the total luminosity and we can expect issues to appear when trying to convert from a G band magnitude to a total bolometric luminosity.","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"And now for the last step, how do we use this to convert from an absolute G magnitude to the bolometric luminosity? If we substract the absolute G magnitude of the Sun to that of another star we obtain","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"M_G - M_Godot = -25 log_10left(fracL_GL_Godotright)","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"(absG1)","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"where L_G stands for the luminosity of the star weighted by the G filter passband,","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"L_G=int_0^infty L_lambda varphi(lambda)dlambda","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"and L_lambda is the luminosity per unit wavelength. Equation {eq}abs_G_1 can be rewritten as","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"M_G - M_Godot = -25timesleftlog_10left(fracL_GLright)+log_10left(fracLL_odotright)+log_10left(fracL_odotL_Godotright)right","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"The ratio between the luminosity of a source and its G band is just the quantity R(T) we have computed before. Using the corresponding temperature for the Sun and solving for log_10(LL_odot) we get","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"log_10left(fracLL_odotright)=fracM_Godot-M_G25 - log_10(R(T)) + log_10(R(5772mathrmK))","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"and remember that the temperature can be inferred from the color. With this we can complete our Hertzsprung-Russell diagram. As a check, we also include the predicted properties for stars on the zero-age main-sequence, which is the beginning of the core-hydrogen burning phase in the evolution of a star. These values of L and T_mathrmeff come from the results of {cite}Schaller+1992 and {cite}Charbonnel+1999 and cover masses between 04 M_odot and 25 M_odot.","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"log10_L_div_Lsun = (G_sun .- abs_G)./(2.5) .-\n    log10.(flux_ratio_G_total.(10 .^ log10_T)) .+ log10.(flux_ratio_G_total.(5772));\n\nplot(xlabel=L\"$\\log_{10}T_\\mathrm{eff}$\", ylabel=L\"\\log_{10}L/L_\\odot\")\n\n#Predicted Zero-age main-sequence location for stars of masses (in Msun):\n#0.4, 0.8, 0.9, 1.0, 1.25, 1.5, 1.7, 2, 2.5\n#All models except that with M=0.4 Msun are from Schaller et al. (1992).\n#Model at 0.4 Msun is from Charbonnel et al. (1999).\n#These results were computed using the Geneva stellar evolution code\nlog10_T_geneva = [3.568, 3.687, 3.724, 3.751, 3.808, 3.852, 3.901, 3.958, 4.031]\nlog10_L_geneva = [-1.63, -0.612, -0.394, -0.163, 0.325, 0.676, 0.916, 1.209, 1.600]\n\nscatter!(log10_T, log10_L_div_Lsun, label=\"Gaia\")\nscatter!([log10_T_from_BP_minus_RP(BP_sun-RP_sun)],[0], label=\"Sun\")\nplot!(log10_T_geneva, log10_L_geneva, linewidth=5, linestyle= :dot, color=\"orange\", label=\"ZAMS\")\nxflip!(true)","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"Here we see that the predicted zero-age main-sequence matches well the observed stars except at low luminosities and effective temperatures. This is not entirely surprising, as for those low temperatures we have already seen that the Gaia filters only cover a small fraction of the total luminosity of the star.","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"Feel free to further play with this data. For instance, using L=4pi R^2sigma T_mathrmeff^4 you can determine the radii of these stars, and compare how much the radii in the main-sequence differ from those of the white dwarfs.","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"[CasagrandeVandenBerg2018]: Monthly Notices of the Royal Astronomical Society: Letters, Volume 479, Issue 1, p.L102-L107 https://ui.adsabs.harvard.edu/abs/2018MNRAS.479L.102C/abstract","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"","category":"page"},{"location":"1_introduction_computational/","page":"Constructing an HR diagram","title":"Constructing an HR diagram","text":"This page was generated using Literate.jl.","category":"page"}]
}
